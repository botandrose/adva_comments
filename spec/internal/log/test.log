  [1m[35m (2.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "title" varchar, "host" varchar, "comment_filter" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "title" varchar, "permalink" varchar, "type" varchar, "comment_age" integer DEFAULT 0, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar, "last_name" varchar, "email" varchar, "password_digest" varchar, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "articles"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "articles" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "author_id" integer NOT NULL, "title" varchar, "body" text, "body_html" text, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_e74ce85cbc"
FOREIGN KEY ("author_id")
  REFERENCES "users" ("id")
)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_articles_on_site_id" ON "articles" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_articles_on_section_id" ON "articles" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_articles_on_author_id" ON "articles" ("author_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_name" varchar, "author_email" varchar, "author_homepage" varchar, "body" text, "body_html" text, "approved" boolean DEFAULT 0, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_articles_on_site_id_and_published_at" ON "articles" ("site_id", "published_at")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-09-28 14:41:15.204925', '2025-09-28 14:41:15.204929') RETURNING "key"[0m
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "title" varchar, "host" varchar, "comment_filter" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "title" varchar, "permalink" varchar, "type" varchar, "comment_age" integer DEFAULT 0, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar, "last_name" varchar, "email" varchar, "password_digest" varchar, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "articles"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "articles" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "author_id" integer NOT NULL, "title" varchar, "body" text, "body_html" text, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_e74ce85cbc"
FOREIGN KEY ("author_id")
  REFERENCES "users" ("id")
)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_articles_on_site_id" ON "articles" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_articles_on_section_id" ON "articles" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_articles_on_author_id" ON "articles" ("author_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_name" varchar, "author_email" varchar, "author_homepage" varchar, "body" text, "body_html" text, "approved" boolean DEFAULT 0, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_articles_on_site_id_and_published_at" ON "articles" ("site_id", "published_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-09-28 14:41:53.630692', '2025-09-28 14:41:53.630695') RETURNING "key"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "title" varchar, "host" varchar, "comment_filter" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "title" varchar, "permalink" varchar, "type" varchar, "comment_age" integer DEFAULT 0, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar, "last_name" varchar, "email" varchar, "password_digest" varchar, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "articles"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "articles" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "author_id" integer NOT NULL, "title" varchar, "body" text, "body_html" text, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_e74ce85cbc"
FOREIGN KEY ("author_id")
  REFERENCES "users" ("id")
)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_articles_on_site_id" ON "articles" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_articles_on_section_id" ON "articles" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_articles_on_author_id" ON "articles" ("author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_name" varchar, "author_email" varchar, "author_homepage" varchar, "body" text, "body_html" text, "approved" boolean DEFAULT 0, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_articles_on_site_id_and_published_at" ON "articles" ("site_id", "published_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-09-28 23:12:02.897929', '2025-09-28 23:12:02.897931') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('schema_sha1', 'cc22bf852b9a92976507d560fbfc0a0bfa73e42d', '2025-09-28 23:12:02.898781', '2025-09-28 23:12:02.898783') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateActivitiesTable (20080401000000)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "actions" varchar, "object_id" integer, "object_type" varchar(15), "object_attributes" text, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_author" ON "activities" ("author_type", "author_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20080401000000') RETURNING "version"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
Migrating to CreateSitesTable (20080401000001)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "subtitle" varchar, "email" varchar, "timezone" varchar, "theme_names" varchar, "ping_urls" text, "akismet_key" varchar(100), "akismet_url" varchar, "approve_comments" boolean, "comment_age" integer, "comment_filter" varchar, "search_path" varchar, "tag_path" varchar, "tag_layout" varchar, "permalink_style" varchar, "permissions" text)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (4.5ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "title" varchar, "host" varchar, "comment_filter" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "title" varchar, "permalink" varchar, "type" varchar, "comment_age" integer DEFAULT 0, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar, "last_name" varchar, "email" varchar, "password_digest" varchar, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "articles"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "articles" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "author_id" integer NOT NULL, "title" varchar, "body" text, "body_html" text, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_e74ce85cbc"
FOREIGN KEY ("author_id")
  REFERENCES "users" ("id")
)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_articles_on_site_id" ON "articles" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_articles_on_section_id" ON "articles" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_articles_on_author_id" ON "articles" ("author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_name" varchar, "author_email" varchar, "author_homepage" varchar, "body" text, "body_html" text, "approved" boolean DEFAULT 0, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_articles_on_site_id_and_published_at" ON "articles" ("site_id", "published_at")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-09-28 23:12:53.906096', '2025-09-28 23:12:53.906098') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('schema_sha1', 'cc22bf852b9a92976507d560fbfc0a0bfa73e42d', '2025-09-28 23:12:53.906911', '2025-09-28 23:12:53.906912') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateActivitiesTable (20080401000000)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "actions" varchar, "object_id" integer, "object_type" varchar(15), "object_attributes" text, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_author" ON "activities" ("author_type", "author_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20080401000000') RETURNING "version"[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
Migrating to CreateSitesTable (20080401000001)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "subtitle" varchar, "email" varchar, "timezone" varchar, "theme_names" varchar, "ping_urls" text, "akismet_key" varchar(100), "akismet_url" varchar, "approve_comments" boolean, "comment_age" integer, "comment_filter" varchar, "search_path" varchar, "tag_path" varchar, "tag_layout" varchar, "permalink_style" varchar, "permissions" text)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (8.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "title" varchar, "host" varchar, "comment_filter" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "title" varchar, "permalink" varchar, "type" varchar, "comment_age" integer DEFAULT 0, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar, "last_name" varchar, "email" varchar, "password_digest" varchar, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "articles"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "articles" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "author_id" integer NOT NULL, "title" varchar, "body" text, "body_html" text, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_e74ce85cbc"
FOREIGN KEY ("author_id")
  REFERENCES "users" ("id")
)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_articles_on_site_id" ON "articles" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_articles_on_section_id" ON "articles" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_articles_on_author_id" ON "articles" ("author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_name" varchar, "author_email" varchar, "author_homepage" varchar, "body" text, "body_html" text, "approved" boolean DEFAULT 0, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_articles_on_site_id_and_published_at" ON "articles" ("site_id", "published_at")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.2ms)[0m  [1m[32mINSERT INTO "sites" ("name", "title", "host", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["title", "Test Site Title"], ["host", "test-site.com"], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:13:55.364300"], ["updated_at", "2025-09-28 23:13:55.364300"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (3.4ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "title" varchar, "host" varchar, "comment_filter" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "title" varchar, "permalink" varchar, "type" varchar, "comment_age" integer DEFAULT 0, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar, "last_name" varchar, "email" varchar, "password_digest" varchar, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "articles"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "articles" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "author_id" integer NOT NULL, "title" varchar, "body" text, "body_html" text, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_e74ce85cbc"
FOREIGN KEY ("author_id")
  REFERENCES "users" ("id")
)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_articles_on_site_id" ON "articles" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_articles_on_section_id" ON "articles" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_articles_on_author_id" ON "articles" ("author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_name" varchar, "author_email" varchar, "author_homepage" varchar, "body" text, "body_html" text, "approved" boolean DEFAULT 0, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_articles_on_site_id_and_published_at" ON "articles" ("site_id", "published_at")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-09-28 23:14:16.356596', '2025-09-28 23:14:16.356598') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('schema_sha1', 'cc22bf852b9a92976507d560fbfc0a0bfa73e42d', '2025-09-28 23:14:16.357533', '2025-09-28 23:14:16.357534') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateActivitiesTable (20080401000000)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "actions" varchar, "object_id" integer, "object_type" varchar(15), "object_attributes" text, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_author" ON "activities" ("author_type", "author_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20080401000000') RETURNING "version"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
Migrating to CreateSitesTable (20080401000001)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "subtitle" varchar, "email" varchar, "timezone" varchar, "theme_names" varchar, "ping_urls" text, "akismet_key" varchar(100), "akismet_url" varchar, "approve_comments" boolean, "comment_age" integer, "comment_filter" varchar, "search_path" varchar, "tag_path" varchar, "tag_layout" varchar, "permalink_style" varchar, "permissions" text)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (3.6ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "permalink" varchar, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-09-28 23:16:12.746943', '2025-09-28 23:16:12.746945') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('schema_sha1', '2bc8907a2fa9403021236d705d1beb76505e6e2d', '2025-09-28 23:16:12.747713', '2025-09-28 23:16:12.747714') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateActivitiesTable (20080401000000)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "actions" varchar, "object_id" integer, "object_type" varchar(15), "object_attributes" text, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_author" ON "activities" ("author_type", "author_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20080401000000') RETURNING "version"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
Migrating to CreateSitesTable (20080401000001)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "subtitle" varchar, "email" varchar, "timezone" varchar, "theme_names" varchar, "ping_urls" text, "akismet_key" varchar(100), "akismet_url" varchar, "approve_comments" boolean, "comment_age" integer, "comment_filter" varchar, "search_path" varchar, "tag_path" varchar, "tag_layout" varchar, "permalink_style" varchar, "permissions" text)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (6.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "permalink" varchar, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.1ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:16:26.288673"], ["updated_at", "2025-09-28 23:16:26.288673"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:16:26.299420"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:16:26.300170"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[35m (7.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "permalink" varchar, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.1ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:16:41.907102"], ["updated_at", "2025-09-28 23:16:41.907102"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:16:41.918257"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:16:41.919066"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (64.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "permalink" varchar, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.2ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:16:57.130252"], ["updated_at", "2025-09-28 23:16:57.130252"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (2.3ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.2ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:16:57.165263"]]
  [1m[36mSite Update (0.1ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:16:57.169049"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:16:57.181710"], ["created_at", "2025-09-28 23:16:57.188218"], ["updated_at", "2025-09-28 23:16:57.188218"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[35m (7.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.1ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:17:13.871108"], ["updated_at", "2025-09-28 23:17:13.871108"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:17:13.882625"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:17:13.883422"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:17:13.885838"], ["created_at", "2025-09-28 23:17:13.890181"], ["updated_at", "2025-09-28 23:17:13.890181"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (6.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.1ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:17:22.631418"], ["updated_at", "2025-09-28 23:17:22.631418"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:17:22.641747"]]
  [1m[36mSite Update (0.1ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:17:22.642615"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:17:22.645005"], ["created_at", "2025-09-28 23:17:22.649217"], ["updated_at", "2025-09-28 23:17:22.649217"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:17:22.673145"], ["updated_at", "2025-09-28 23:17:22.673145"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (5.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.1ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:17:41.429911"], ["updated_at", "2025-09-28 23:17:41.429911"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:17:41.440856"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:17:41.441710"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:17:41.444065"], ["created_at", "2025-09-28 23:17:41.448266"], ["updated_at", "2025-09-28 23:17:41.448266"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:17:41.471675"], ["updated_at", "2025-09-28 23:17:41.471675"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:17:41.473489"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:17:41.510282"], ["updated_at", "2025-09-28 23:17:41.510282"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (6.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "counters"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "counters" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "owner_type" varchar, "owner_id" integer, "name" varchar(25), "count" integer DEFAULT 0)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_counters_on_owner" ON "counters" ("owner_type", "owner_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.1ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:17:59.974402"], ["updated_at", "2025-09-28 23:17:59.974402"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:18:00.011594"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:18:00.013221"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:18:00.016384"], ["created_at", "2025-09-28 23:18:00.022426"], ["updated_at", "2025-09-28 23:18:00.022426"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:18:00.040102"], ["updated_at", "2025-09-28 23:18:00.040102"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:18:00.042628"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:18:00.079555"], ["updated_at", "2025-09-28 23:18:00.079555"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.0ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:18:00.088406"], ["id", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:18:00.088946"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (10.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "counters"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "counters" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "owner_type" varchar, "owner_id" integer, "name" varchar(25), "count" integer DEFAULT 0)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_counters_on_owner" ON "counters" ("owner_type", "owner_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.1ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:18:29.275417"], ["updated_at", "2025-09-28 23:18:29.275417"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:18:29.289765"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:18:29.290650"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:18:29.293386"], ["created_at", "2025-09-28 23:18:29.298357"], ["updated_at", "2025-09-28 23:18:29.298357"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:18:29.316680"], ["updated_at", "2025-09-28 23:18:29.316680"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.1ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:18:29.319090"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (0.4ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:18:29.362605"], ["updated_at", "2025-09-28 23:18:29.362605"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:18:29.375233"], ["id", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:18:29.375892"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (59.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "counters"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "counters" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "owner_type" varchar, "owner_id" integer, "name" varchar(25), "count" integer DEFAULT 0)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_counters_on_owner" ON "counters" ("owner_type", "owner_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.1ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:18:43.713433"], ["updated_at", "2025-09-28 23:18:43.713433"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:18:43.726107"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:18:43.726909"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:18:43.729701"], ["created_at", "2025-09-28 23:18:43.734555"], ["updated_at", "2025-09-28 23:18:43.734555"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:18:43.752446"], ["updated_at", "2025-09-28 23:18:43.752446"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:18:43.754689"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:18:43.792968"], ["updated_at", "2025-09-28 23:18:43.792968"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.0ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:18:43.801577"], ["id", 1]]
  [1m[36mSite Update (0.1ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:18:43.802238"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (6.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "counters"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "counters" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "owner_type" varchar, "owner_id" integer, "name" varchar(25), "count" integer DEFAULT 0)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_counters_on_owner" ON "counters" ("owner_type", "owner_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.1ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:18:57.229304"], ["updated_at", "2025-09-28 23:18:57.229304"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:18:57.239652"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:18:57.240432"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:18:57.242728"], ["created_at", "2025-09-28 23:18:57.246805"], ["updated_at", "2025-09-28 23:18:57.246805"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:18:57.269456"], ["updated_at", "2025-09-28 23:18:57.269456"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:18:57.271196"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:18:57.305155"], ["updated_at", "2025-09-28 23:18:57.305155"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:18:57.314403"], ["id", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:18:57.314927"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (6.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "counters"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "counters" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "owner_type" varchar, "owner_id" integer, "name" varchar(25), "count" integer DEFAULT 0)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_counters_on_owner" ON "counters" ("owner_type", "owner_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.1ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:20:27.702344"], ["updated_at", "2025-09-28 23:20:27.702344"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:20:27.738478"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:20:27.739542"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:20:27.742283"], ["created_at", "2025-09-28 23:20:27.747085"], ["updated_at", "2025-09-28 23:20:27.747085"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:20:27.761359"], ["updated_at", "2025-09-28 23:20:27.761359"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:20:27.763044"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:20:27.795806"], ["updated_at", "2025-09-28 23:20:27.795806"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.0ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:20:27.804032"], ["id", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:20:27.804577"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (7.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "counters"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "counters" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "owner_type" varchar, "owner_id" integer, "name" varchar(25), "count" integer DEFAULT 0)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_counters_on_owner" ON "counters" ("owner_type", "owner_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.1ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:22:36.958804"], ["updated_at", "2025-09-28 23:22:36.958804"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:22:36.969450"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:22:36.970477"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:22:36.972907"], ["created_at", "2025-09-28 23:22:36.977441"], ["updated_at", "2025-09-28 23:22:36.977441"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:22:37.000060"], ["updated_at", "2025-09-28 23:22:37.000060"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:22:37.001918"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:22:37.035972"], ["updated_at", "2025-09-28 23:22:37.035972"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.0ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.0ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:22:37.044352"], ["id", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:22:37.044864"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (7.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "counters"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "counters" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "owner_type" varchar, "owner_id" integer, "name" varchar(25), "count" integer DEFAULT 0)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_counters_on_owner" ON "counters" ("owner_type", "owner_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.1ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:22:47.238813"], ["updated_at", "2025-09-28 23:22:47.238813"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:22:47.250377"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:22:47.251458"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:22:47.253946"], ["created_at", "2025-09-28 23:22:47.258508"], ["updated_at", "2025-09-28 23:22:47.258508"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:22:47.280859"], ["updated_at", "2025-09-28 23:22:47.280859"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:22:47.282686"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:22:47.317000"], ["updated_at", "2025-09-28 23:22:47.317000"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.0ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:22:47.325591"], ["id", 1]]
  [1m[36mSite Update (0.1ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:22:47.326711"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.2ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (6.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "counters"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "counters" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "owner_type" varchar, "owner_id" integer, "name" varchar(25), "count" integer DEFAULT 0)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_counters_on_owner" ON "counters" ("owner_type", "owner_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.1ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:24:05.150015"], ["updated_at", "2025-09-28 23:24:05.150015"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:24:05.163449"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:24:05.164651"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:24:05.167606"], ["created_at", "2025-09-28 23:24:05.172936"], ["updated_at", "2025-09-28 23:24:05.172936"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.3ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:24:05.202307"], ["updated_at", "2025-09-28 23:24:05.202307"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:24:05.205216"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (0.5ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:24:05.258480"], ["updated_at", "2025-09-28 23:24:05.258480"]]
  [1m[36mCounter Load (0.2ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.2ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.3ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:24:05.286942"], ["id", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:24:05.287573"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.2ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started GET "/comments/1" for 127.0.0.1 at 2025-09-28 19:24:05 -0400
Processing by CommentsController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  Rendering layout /home/micah/work/adva/app/views/layouts/default.html.erb
  Rendering /home/micah/work/adva_comments/app/views/comments/show.html.erb within layouts/default
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  Rendered /home/micah/work/adva_comments/app/views/comments/show.html.erb within layouts/default (Duration: 5.2ms | GC: 0.0ms)
  Rendered layout /home/micah/work/adva/app/views/layouts/default.html.erb (Duration: 5.4ms | GC: 0.0ms)
Completed 500 Internal Server Error in 17ms (ActiveRecord: 0.7ms (8 queries, 0 cached) | GC: 0.0ms)
  
ActionView::Template::Error (undefined method `article_path' for an instance of #<Class:0x000070c23727d980>)
Caused by: NoMethodError (undefined method `article_path' for an instance of #<Class:0x000070c23727d980>)

Information for: ActionView::Template::Error (undefined method `article_path' for an instance of #<Class:0x000070c23727d980>):
    1: <div id="comments">
    2:   <h2><%= t(:'adva.comments.titles.comment_number', :number => @comment.id) %></h2>
    3:   <p>
    4: 		<%= t(:'adva.comments.labels.on') %>: <%= link_to_content @comment.commentable %>
    5: 	</p>
    6:   <ol>
    7:     <%= render :partial => 'comments/comment', :object => @comment %>
  
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:96:in `method_missing'
/home/micah/work/adva/app/helpers/resource_helper.rb:13:in `resource_url'
/home/micah/work/adva/app/helpers/resource_helper.rb:29:in `resource_link'
/home/micah/work/adva/app/helpers/resource_helper.rb:48:in `block (2 levels) in <module:ResourceHelper>'
/home/micah/work/adva/app/helpers/content_helper.rb:53:in `link_to_content'
/home/micah/work/adva_comments/app/views/comments/show.html.erb:4
actionview (8.0.3) lib/action_view/base.rb:278:in `public_send'
actionview (8.0.3) lib/action_view/base.rb:278:in `_run'
actionview (8.0.3) lib/action_view/template.rb:284:in `block in render'
activesupport (8.0.3) lib/active_support/notifications.rb:212:in `instrument'
actionview (8.0.3) lib/action_view/template.rb:583:in `instrument_render_template'
actionview (8.0.3) lib/action_view/template.rb:272:in `render'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:66:in `block (2 levels) in render_template'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:60:in `block in render_template'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:76:in `block in render_with_layout'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:75:in `render_with_layout'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:59:in `render_template'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:11:in `render'
actionview (8.0.3) lib/action_view/renderer/renderer.rb:58:in `render_template_to_object'
actionview (8.0.3) lib/action_view/renderer/renderer.rb:31:in `render_to_object'
actionview (8.0.3) lib/action_view/rendering.rb:136:in `block in _render_template'
actionview (8.0.3) lib/action_view/base.rb:305:in `in_rendering_context'
actionview (8.0.3) lib/action_view/rendering.rb:135:in `_render_template'
actionpack (8.0.3) lib/action_controller/metal/streaming.rb:179:in `_render_template'
actionview (8.0.3) lib/action_view/rendering.rb:122:in `render_to_body'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:186:in `render_to_body'
actionpack (8.0.3) lib/action_controller/metal/renderers.rb:140:in `render_to_body'
actionpack (8.0.3) lib/abstract_controller/rendering.rb:28:in `render'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:167:in `render'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:31:in `block (2 levels) in render'
activesupport (8.0.3) lib/active_support/benchmark.rb:17:in `realtime'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:31:in `block in render'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:100:in `cleanup_view_runtime'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:46:in `cleanup_view_runtime'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:30:in `render'
/home/micah/work/adva/lib/rails_ext/action_controller/render_with_error_proc.rb:24:in `block in render'
/home/micah/work/adva/lib/rails_ext/action_controller/render_with_error_proc.rb:43:in `with_error_proc'
/home/micah/work/adva/lib/rails_ext/action_controller/render_with_error_proc.rb:23:in `render'
actionpack (8.0.3) lib/action_controller/metal/implicit_render.rb:39:in `default_render'
actionpack (8.0.3) lib/action_controller/metal/basic_implicit_render.rb:9:in `send_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:215:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:193:in `process_action'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:261:in `block in process_action'
activesupport (8.0.3) lib/active_support/callbacks.rb:120:in `block in run_callbacks'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/controller.rb:8:in `write_flash_to_cookie'
activesupport (8.0.3) lib/active_support/callbacks.rb:129:in `block in run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:140:in `run_callbacks'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:76:in `block in process_action'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:75:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:152:in `process'
actionview (8.0.3) lib/action_view/rendering.rb:40:in `process'
actionpack (8.0.3) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (8.0.3) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:908:in `call'
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:60:in `call'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/middleware.rb:8:in `call'
rack (3.2.1) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.2.1) lib/rack/etag.rb:29:in `call'
rack (3.2.1) lib/rack/conditional_get.rb:31:in `call'
rack (3.2.1) lib/rack/head.rb:15:in `call'
actionpack (8.0.3) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (8.0.3) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/cookies.rb:706:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (8.0.3) lib/active_support/callbacks.rb:100:in `run_callbacks'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (8.0.3) lib/rails/rack/logger.rb:41:in `call_app'
railties (8.0.3) lib/rails/rack/logger.rb:29:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/request_id.rb:34:in `call'
rack (3.2.1) lib/rack/method_override.rb:28:in `call'
rack (3.2.1) lib/rack/runtime.rb:24:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.2.1) lib/rack/sendfile.rb:114:in `call'
railties (8.0.3) lib/rails/engine.rb:535:in `call'
rack-test (2.2.0) lib/rack/test.rb:360:in `process_request'
rack-test (2.2.0) lib/rack/test.rb:153:in `request'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:297:in `process'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:19:in `get'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:388:in `get'
/home/micah/work/adva_comments/spec/requests/comments_spec.rb:12:in `block (3 levels) in <top (required)>'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `block in run'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-rails (7.1.1) lib/rspec/rails/adapters.rb:75:in `block (2 levels) in <module:MinitestLifecycleAdapter>'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:390:in `execute_with'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `run'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:259:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:653:in `block in run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:614:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `map'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/configuration.rb:2097:in `with_suite_hooks'
rspec-core (3.13.5) lib/rspec/core/runner.rb:116:in `block in run_specs'
rspec-core (3.13.5) lib/rspec/core/reporter.rb:74:in `report'
rspec-core (3.13.5) lib/rspec/core/runner.rb:115:in `run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:89:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:71:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:45:in `invoke'
rspec-core (3.13.5) exe/rspec:4:in `<top (required)>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `load'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `<main>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `eval'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `<main>'

Information for cause: NoMethodError (undefined method `article_path' for an instance of #<Class:0x000070c23727d980>):
  
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:96:in `method_missing'
/home/micah/work/adva/app/helpers/resource_helper.rb:13:in `resource_url'
/home/micah/work/adva/app/helpers/resource_helper.rb:29:in `resource_link'
/home/micah/work/adva/app/helpers/resource_helper.rb:48:in `block (2 levels) in <module:ResourceHelper>'
/home/micah/work/adva/app/helpers/content_helper.rb:53:in `link_to_content'
/home/micah/work/adva_comments/app/views/comments/show.html.erb:4
actionview (8.0.3) lib/action_view/base.rb:278:in `public_send'
actionview (8.0.3) lib/action_view/base.rb:278:in `_run'
actionview (8.0.3) lib/action_view/template.rb:284:in `block in render'
activesupport (8.0.3) lib/active_support/notifications.rb:212:in `instrument'
actionview (8.0.3) lib/action_view/template.rb:583:in `instrument_render_template'
actionview (8.0.3) lib/action_view/template.rb:272:in `render'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:66:in `block (2 levels) in render_template'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:60:in `block in render_template'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:76:in `block in render_with_layout'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:75:in `render_with_layout'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:59:in `render_template'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:11:in `render'
actionview (8.0.3) lib/action_view/renderer/renderer.rb:58:in `render_template_to_object'
actionview (8.0.3) lib/action_view/renderer/renderer.rb:31:in `render_to_object'
actionview (8.0.3) lib/action_view/rendering.rb:136:in `block in _render_template'
actionview (8.0.3) lib/action_view/base.rb:305:in `in_rendering_context'
actionview (8.0.3) lib/action_view/rendering.rb:135:in `_render_template'
actionpack (8.0.3) lib/action_controller/metal/streaming.rb:179:in `_render_template'
actionview (8.0.3) lib/action_view/rendering.rb:122:in `render_to_body'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:186:in `render_to_body'
actionpack (8.0.3) lib/action_controller/metal/renderers.rb:140:in `render_to_body'
actionpack (8.0.3) lib/abstract_controller/rendering.rb:28:in `render'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:167:in `render'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:31:in `block (2 levels) in render'
activesupport (8.0.3) lib/active_support/benchmark.rb:17:in `realtime'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:31:in `block in render'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:100:in `cleanup_view_runtime'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:46:in `cleanup_view_runtime'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:30:in `render'
/home/micah/work/adva/lib/rails_ext/action_controller/render_with_error_proc.rb:24:in `block in render'
/home/micah/work/adva/lib/rails_ext/action_controller/render_with_error_proc.rb:43:in `with_error_proc'
/home/micah/work/adva/lib/rails_ext/action_controller/render_with_error_proc.rb:23:in `render'
actionpack (8.0.3) lib/action_controller/metal/implicit_render.rb:39:in `default_render'
actionpack (8.0.3) lib/action_controller/metal/basic_implicit_render.rb:9:in `send_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:215:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:193:in `process_action'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:261:in `block in process_action'
activesupport (8.0.3) lib/active_support/callbacks.rb:120:in `block in run_callbacks'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/controller.rb:8:in `write_flash_to_cookie'
activesupport (8.0.3) lib/active_support/callbacks.rb:129:in `block in run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:140:in `run_callbacks'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:76:in `block in process_action'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:75:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:152:in `process'
actionview (8.0.3) lib/action_view/rendering.rb:40:in `process'
actionpack (8.0.3) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (8.0.3) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:908:in `call'
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:60:in `call'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/middleware.rb:8:in `call'
rack (3.2.1) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.2.1) lib/rack/etag.rb:29:in `call'
rack (3.2.1) lib/rack/conditional_get.rb:31:in `call'
rack (3.2.1) lib/rack/head.rb:15:in `call'
actionpack (8.0.3) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (8.0.3) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/cookies.rb:706:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (8.0.3) lib/active_support/callbacks.rb:100:in `run_callbacks'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (8.0.3) lib/rails/rack/logger.rb:41:in `call_app'
railties (8.0.3) lib/rails/rack/logger.rb:29:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/request_id.rb:34:in `call'
rack (3.2.1) lib/rack/method_override.rb:28:in `call'
rack (3.2.1) lib/rack/runtime.rb:24:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.2.1) lib/rack/sendfile.rb:114:in `call'
railties (8.0.3) lib/rails/engine.rb:535:in `call'
rack-test (2.2.0) lib/rack/test.rb:360:in `process_request'
rack-test (2.2.0) lib/rack/test.rb:153:in `request'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:297:in `process'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:19:in `get'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:388:in `get'
/home/micah/work/adva_comments/spec/requests/comments_spec.rb:12:in `block (3 levels) in <top (required)>'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `block in run'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-rails (7.1.1) lib/rspec/rails/adapters.rb:75:in `block (2 levels) in <module:MinitestLifecycleAdapter>'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:390:in `execute_with'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `run'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:259:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:653:in `block in run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:614:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `map'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/configuration.rb:2097:in `with_suite_hooks'
rspec-core (3.13.5) lib/rspec/core/runner.rb:116:in `block in run_specs'
rspec-core (3.13.5) lib/rspec/core/reporter.rb:74:in `report'
rspec-core (3.13.5) lib/rspec/core/runner.rb:115:in `run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:89:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:71:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:45:in `invoke'
rspec-core (3.13.5) exe/rspec:4:in `<top (required)>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `load'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `<main>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `eval'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `<main>'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments/preview" for 127.0.0.1 at 2025-09-28 19:24:05 -0400
Processing by CommentsController#preview as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"Previewer", "author_email"=>"preview@example.com", "body"=>"Hello preview"}}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
Completed 500 Internal Server Error in 6ms (ActiveRecord: 0.5ms (6 queries, 0 cached) | GC: 0.4ms)
  
NoMethodError (undefined method `process_filters' for an instance of Comment):
  
activemodel (8.0.3) lib/active_model/attribute_methods.rb:512:in `method_missing'
activerecord (8.0.3) lib/active_record/attribute_methods.rb:495:in `method_missing'
/home/micah/work/adva_comments/app/controllers/comments_controller.rb:29:in `preview'
actionpack (8.0.3) lib/action_controller/metal/basic_implicit_render.rb:8:in `send_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:215:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:193:in `process_action'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:261:in `block in process_action'
activesupport (8.0.3) lib/active_support/callbacks.rb:120:in `block in run_callbacks'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/controller.rb:8:in `write_flash_to_cookie'
activesupport (8.0.3) lib/active_support/callbacks.rb:129:in `block in run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:140:in `run_callbacks'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:76:in `block in process_action'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:75:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:152:in `process'
actionview (8.0.3) lib/action_view/rendering.rb:40:in `process'
actionpack (8.0.3) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (8.0.3) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:908:in `call'
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:60:in `call'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/middleware.rb:8:in `call'
rack (3.2.1) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.2.1) lib/rack/etag.rb:29:in `call'
rack (3.2.1) lib/rack/conditional_get.rb:44:in `call'
rack (3.2.1) lib/rack/head.rb:15:in `call'
actionpack (8.0.3) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (8.0.3) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/cookies.rb:706:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (8.0.3) lib/active_support/callbacks.rb:100:in `run_callbacks'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (8.0.3) lib/rails/rack/logger.rb:41:in `call_app'
railties (8.0.3) lib/rails/rack/logger.rb:29:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/request_id.rb:34:in `call'
rack (3.2.1) lib/rack/method_override.rb:28:in `call'
rack (3.2.1) lib/rack/runtime.rb:24:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.2.1) lib/rack/sendfile.rb:114:in `call'
railties (8.0.3) lib/rails/engine.rb:535:in `call'
rack-test (2.2.0) lib/rack/test.rb:360:in `process_request'
rack-test (2.2.0) lib/rack/test.rb:153:in `request'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:297:in `process'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:25:in `post'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:388:in `post'
/home/micah/work/adva_comments/spec/requests/comments_spec.rb:19:in `block (3 levels) in <top (required)>'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `block in run'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-rails (7.1.1) lib/rspec/rails/adapters.rb:75:in `block (2 levels) in <module:MinitestLifecycleAdapter>'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:390:in `execute_with'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `run'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:259:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:653:in `block in run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:614:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `map'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/configuration.rb:2097:in `with_suite_hooks'
rspec-core (3.13.5) lib/rspec/core/runner.rb:116:in `block in run_specs'
rspec-core (3.13.5) lib/rspec/core/reporter.rb:74:in `report'
rspec-core (3.13.5) lib/rspec/core/runner.rb:115:in `run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:89:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:71:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:45:in `invoke'
rspec-core (3.13.5) exe/rspec:4:in `<top (required)>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `load'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `<main>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `eval'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `<main>'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments" for 127.0.0.1 at 2025-09-28 19:24:05 -0400
Processing by CommentsController#create as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"New Author", "author_email"=>"new@example.com", "body"=>"New comment body"}}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
[Invisible Captcha] Potential spam detected for IP 127.0.0.1. Timestamp not found in session.
Redirected to http://test-site.com/ref
Filter chain halted as #<Proc:0x000070c2372bd4b8 /home/micah/.rvm/gems/ruby-3.3.4/gems/invisible_captcha-2.3.0/lib/invisible_captcha/controller_ext.rb:12> rendered or redirected
Completed 302 Found in 6ms (ActiveRecord: 0.5ms (6 queries, 0 cached) | GC: 0.2ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (7.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "counters"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "counters" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "owner_type" varchar, "owner_id" integer, "name" varchar(25), "count" integer DEFAULT 0)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_counters_on_owner" ON "counters" ("owner_type", "owner_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.1ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:24:40.140633"], ["updated_at", "2025-09-28 23:24:40.140633"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:24:40.152356"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:24:40.153441"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:24:40.155869"], ["created_at", "2025-09-28 23:24:40.160466"], ["updated_at", "2025-09-28 23:24:40.160466"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:24:40.181868"], ["updated_at", "2025-09-28 23:24:40.181868"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:24:40.183726"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:24:40.232924"], ["updated_at", "2025-09-28 23:24:40.232924"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.0ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:24:40.257563"], ["id", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:24:40.258161"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started GET "/comments/1" for 127.0.0.1 at 2025-09-28 19:24:40 -0400
Processing by CommentsController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  Rendering layout /home/micah/work/adva/app/views/layouts/default.html.erb
  Rendering /home/micah/work/adva_comments/app/views/comments/show.html.erb within layouts/default
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  Rendered /home/micah/work/adva_comments/app/views/comments/show.html.erb within layouts/default (Duration: 3.2ms | GC: 0.0ms)
  Rendered layout /home/micah/work/adva/app/views/layouts/default.html.erb (Duration: 3.3ms | GC: 0.0ms)
Completed 500 Internal Server Error in 11ms (ActiveRecord: 0.8ms (8 queries, 0 cached) | GC: 0.0ms)
  
ActionView::Template::Error (undefined method `article_path' for an instance of #<Class:0x00007964d15830e0>)
Caused by: NoMethodError (undefined method `article_path' for an instance of #<Class:0x00007964d15830e0>)

Information for: ActionView::Template::Error (undefined method `article_path' for an instance of #<Class:0x00007964d15830e0>):
    1: <div id="comments">
    2:   <h2><%= t(:'adva.comments.titles.comment_number', :number => @comment.id) %></h2>
    3:   <p>
    4: 		<%= t(:'adva.comments.labels.on') %>: <%= link_to_content @comment.commentable %>
    5: 	</p>
    6:   <ol>
    7:     <%= render :partial => 'comments/comment', :object => @comment %>
  
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:96:in `method_missing'
/home/micah/work/adva/app/helpers/resource_helper.rb:13:in `resource_url'
/home/micah/work/adva/app/helpers/resource_helper.rb:29:in `resource_link'
/home/micah/work/adva/app/helpers/resource_helper.rb:48:in `block (2 levels) in <module:ResourceHelper>'
/home/micah/work/adva/app/helpers/content_helper.rb:53:in `link_to_content'
/home/micah/work/adva_comments/app/views/comments/show.html.erb:4
actionview (8.0.3) lib/action_view/base.rb:278:in `public_send'
actionview (8.0.3) lib/action_view/base.rb:278:in `_run'
actionview (8.0.3) lib/action_view/template.rb:284:in `block in render'
activesupport (8.0.3) lib/active_support/notifications.rb:212:in `instrument'
actionview (8.0.3) lib/action_view/template.rb:583:in `instrument_render_template'
actionview (8.0.3) lib/action_view/template.rb:272:in `render'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:66:in `block (2 levels) in render_template'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:60:in `block in render_template'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:76:in `block in render_with_layout'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:75:in `render_with_layout'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:59:in `render_template'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:11:in `render'
actionview (8.0.3) lib/action_view/renderer/renderer.rb:58:in `render_template_to_object'
actionview (8.0.3) lib/action_view/renderer/renderer.rb:31:in `render_to_object'
actionview (8.0.3) lib/action_view/rendering.rb:136:in `block in _render_template'
actionview (8.0.3) lib/action_view/base.rb:305:in `in_rendering_context'
actionview (8.0.3) lib/action_view/rendering.rb:135:in `_render_template'
actionpack (8.0.3) lib/action_controller/metal/streaming.rb:179:in `_render_template'
actionview (8.0.3) lib/action_view/rendering.rb:122:in `render_to_body'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:186:in `render_to_body'
actionpack (8.0.3) lib/action_controller/metal/renderers.rb:140:in `render_to_body'
actionpack (8.0.3) lib/abstract_controller/rendering.rb:28:in `render'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:167:in `render'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:31:in `block (2 levels) in render'
activesupport (8.0.3) lib/active_support/benchmark.rb:17:in `realtime'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:31:in `block in render'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:100:in `cleanup_view_runtime'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:46:in `cleanup_view_runtime'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:30:in `render'
/home/micah/work/adva/lib/rails_ext/action_controller/render_with_error_proc.rb:24:in `block in render'
/home/micah/work/adva/lib/rails_ext/action_controller/render_with_error_proc.rb:43:in `with_error_proc'
/home/micah/work/adva/lib/rails_ext/action_controller/render_with_error_proc.rb:23:in `render'
actionpack (8.0.3) lib/action_controller/metal/implicit_render.rb:39:in `default_render'
actionpack (8.0.3) lib/action_controller/metal/basic_implicit_render.rb:9:in `send_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:215:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:193:in `process_action'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:261:in `block in process_action'
activesupport (8.0.3) lib/active_support/callbacks.rb:120:in `block in run_callbacks'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/controller.rb:8:in `write_flash_to_cookie'
activesupport (8.0.3) lib/active_support/callbacks.rb:129:in `block in run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:140:in `run_callbacks'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:76:in `block in process_action'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:75:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:152:in `process'
actionview (8.0.3) lib/action_view/rendering.rb:40:in `process'
actionpack (8.0.3) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (8.0.3) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:908:in `call'
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:60:in `call'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/middleware.rb:8:in `call'
rack (3.2.1) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.2.1) lib/rack/etag.rb:29:in `call'
rack (3.2.1) lib/rack/conditional_get.rb:31:in `call'
rack (3.2.1) lib/rack/head.rb:15:in `call'
actionpack (8.0.3) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (8.0.3) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/cookies.rb:706:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (8.0.3) lib/active_support/callbacks.rb:100:in `run_callbacks'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (8.0.3) lib/rails/rack/logger.rb:41:in `call_app'
railties (8.0.3) lib/rails/rack/logger.rb:29:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/request_id.rb:34:in `call'
rack (3.2.1) lib/rack/method_override.rb:28:in `call'
rack (3.2.1) lib/rack/runtime.rb:24:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.2.1) lib/rack/sendfile.rb:114:in `call'
railties (8.0.3) lib/rails/engine.rb:535:in `call'
rack-test (2.2.0) lib/rack/test.rb:360:in `process_request'
rack-test (2.2.0) lib/rack/test.rb:153:in `request'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:297:in `process'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:19:in `get'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:388:in `get'
/home/micah/work/adva_comments/spec/requests/comments_spec.rb:12:in `block (3 levels) in <top (required)>'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `block in run'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-rails (7.1.1) lib/rspec/rails/adapters.rb:75:in `block (2 levels) in <module:MinitestLifecycleAdapter>'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:390:in `execute_with'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `run'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:259:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:653:in `block in run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:614:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `map'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/configuration.rb:2097:in `with_suite_hooks'
rspec-core (3.13.5) lib/rspec/core/runner.rb:116:in `block in run_specs'
rspec-core (3.13.5) lib/rspec/core/reporter.rb:74:in `report'
rspec-core (3.13.5) lib/rspec/core/runner.rb:115:in `run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:89:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:71:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:45:in `invoke'
rspec-core (3.13.5) exe/rspec:4:in `<top (required)>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `load'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `<main>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `eval'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `<main>'

Information for cause: NoMethodError (undefined method `article_path' for an instance of #<Class:0x00007964d15830e0>):
  
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:96:in `method_missing'
/home/micah/work/adva/app/helpers/resource_helper.rb:13:in `resource_url'
/home/micah/work/adva/app/helpers/resource_helper.rb:29:in `resource_link'
/home/micah/work/adva/app/helpers/resource_helper.rb:48:in `block (2 levels) in <module:ResourceHelper>'
/home/micah/work/adva/app/helpers/content_helper.rb:53:in `link_to_content'
/home/micah/work/adva_comments/app/views/comments/show.html.erb:4
actionview (8.0.3) lib/action_view/base.rb:278:in `public_send'
actionview (8.0.3) lib/action_view/base.rb:278:in `_run'
actionview (8.0.3) lib/action_view/template.rb:284:in `block in render'
activesupport (8.0.3) lib/active_support/notifications.rb:212:in `instrument'
actionview (8.0.3) lib/action_view/template.rb:583:in `instrument_render_template'
actionview (8.0.3) lib/action_view/template.rb:272:in `render'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:66:in `block (2 levels) in render_template'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:60:in `block in render_template'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:76:in `block in render_with_layout'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:75:in `render_with_layout'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:59:in `render_template'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:11:in `render'
actionview (8.0.3) lib/action_view/renderer/renderer.rb:58:in `render_template_to_object'
actionview (8.0.3) lib/action_view/renderer/renderer.rb:31:in `render_to_object'
actionview (8.0.3) lib/action_view/rendering.rb:136:in `block in _render_template'
actionview (8.0.3) lib/action_view/base.rb:305:in `in_rendering_context'
actionview (8.0.3) lib/action_view/rendering.rb:135:in `_render_template'
actionpack (8.0.3) lib/action_controller/metal/streaming.rb:179:in `_render_template'
actionview (8.0.3) lib/action_view/rendering.rb:122:in `render_to_body'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:186:in `render_to_body'
actionpack (8.0.3) lib/action_controller/metal/renderers.rb:140:in `render_to_body'
actionpack (8.0.3) lib/abstract_controller/rendering.rb:28:in `render'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:167:in `render'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:31:in `block (2 levels) in render'
activesupport (8.0.3) lib/active_support/benchmark.rb:17:in `realtime'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:31:in `block in render'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:100:in `cleanup_view_runtime'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:46:in `cleanup_view_runtime'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:30:in `render'
/home/micah/work/adva/lib/rails_ext/action_controller/render_with_error_proc.rb:24:in `block in render'
/home/micah/work/adva/lib/rails_ext/action_controller/render_with_error_proc.rb:43:in `with_error_proc'
/home/micah/work/adva/lib/rails_ext/action_controller/render_with_error_proc.rb:23:in `render'
actionpack (8.0.3) lib/action_controller/metal/implicit_render.rb:39:in `default_render'
actionpack (8.0.3) lib/action_controller/metal/basic_implicit_render.rb:9:in `send_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:215:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:193:in `process_action'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:261:in `block in process_action'
activesupport (8.0.3) lib/active_support/callbacks.rb:120:in `block in run_callbacks'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/controller.rb:8:in `write_flash_to_cookie'
activesupport (8.0.3) lib/active_support/callbacks.rb:129:in `block in run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:140:in `run_callbacks'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:76:in `block in process_action'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:75:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:152:in `process'
actionview (8.0.3) lib/action_view/rendering.rb:40:in `process'
actionpack (8.0.3) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (8.0.3) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:908:in `call'
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:60:in `call'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/middleware.rb:8:in `call'
rack (3.2.1) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.2.1) lib/rack/etag.rb:29:in `call'
rack (3.2.1) lib/rack/conditional_get.rb:31:in `call'
rack (3.2.1) lib/rack/head.rb:15:in `call'
actionpack (8.0.3) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (8.0.3) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/cookies.rb:706:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (8.0.3) lib/active_support/callbacks.rb:100:in `run_callbacks'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (8.0.3) lib/rails/rack/logger.rb:41:in `call_app'
railties (8.0.3) lib/rails/rack/logger.rb:29:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/request_id.rb:34:in `call'
rack (3.2.1) lib/rack/method_override.rb:28:in `call'
rack (3.2.1) lib/rack/runtime.rb:24:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.2.1) lib/rack/sendfile.rb:114:in `call'
railties (8.0.3) lib/rails/engine.rb:535:in `call'
rack-test (2.2.0) lib/rack/test.rb:360:in `process_request'
rack-test (2.2.0) lib/rack/test.rb:153:in `request'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:297:in `process'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:19:in `get'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:388:in `get'
/home/micah/work/adva_comments/spec/requests/comments_spec.rb:12:in `block (3 levels) in <top (required)>'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `block in run'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-rails (7.1.1) lib/rspec/rails/adapters.rb:75:in `block (2 levels) in <module:MinitestLifecycleAdapter>'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:390:in `execute_with'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `run'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:259:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:653:in `block in run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:614:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `map'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/configuration.rb:2097:in `with_suite_hooks'
rspec-core (3.13.5) lib/rspec/core/runner.rb:116:in `block in run_specs'
rspec-core (3.13.5) lib/rspec/core/reporter.rb:74:in `report'
rspec-core (3.13.5) lib/rspec/core/runner.rb:115:in `run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:89:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:71:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:45:in `invoke'
rspec-core (3.13.5) exe/rspec:4:in `<top (required)>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `load'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `<main>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `eval'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `<main>'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments/preview" for 127.0.0.1 at 2025-09-28 19:24:40 -0400
Processing by CommentsController#preview as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"Previewer", "author_email"=>"preview@example.com", "body"=>"Hello preview"}}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
Completed 500 Internal Server Error in 8ms (ActiveRecord: 0.8ms (6 queries, 0 cached) | GC: 0.0ms)
  
NoMethodError (undefined method `process_filters' for an instance of Comment):
  
activemodel (8.0.3) lib/active_model/attribute_methods.rb:512:in `method_missing'
activerecord (8.0.3) lib/active_record/attribute_methods.rb:495:in `method_missing'
/home/micah/work/adva_comments/app/controllers/comments_controller.rb:29:in `preview'
actionpack (8.0.3) lib/action_controller/metal/basic_implicit_render.rb:8:in `send_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:215:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:193:in `process_action'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:261:in `block in process_action'
activesupport (8.0.3) lib/active_support/callbacks.rb:120:in `block in run_callbacks'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/controller.rb:8:in `write_flash_to_cookie'
activesupport (8.0.3) lib/active_support/callbacks.rb:129:in `block in run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:140:in `run_callbacks'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:76:in `block in process_action'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:75:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:152:in `process'
actionview (8.0.3) lib/action_view/rendering.rb:40:in `process'
actionpack (8.0.3) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (8.0.3) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:908:in `call'
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:60:in `call'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/middleware.rb:8:in `call'
rack (3.2.1) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.2.1) lib/rack/etag.rb:29:in `call'
rack (3.2.1) lib/rack/conditional_get.rb:44:in `call'
rack (3.2.1) lib/rack/head.rb:15:in `call'
actionpack (8.0.3) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (8.0.3) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/cookies.rb:706:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (8.0.3) lib/active_support/callbacks.rb:100:in `run_callbacks'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (8.0.3) lib/rails/rack/logger.rb:41:in `call_app'
railties (8.0.3) lib/rails/rack/logger.rb:29:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/request_id.rb:34:in `call'
rack (3.2.1) lib/rack/method_override.rb:28:in `call'
rack (3.2.1) lib/rack/runtime.rb:24:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.2.1) lib/rack/sendfile.rb:114:in `call'
railties (8.0.3) lib/rails/engine.rb:535:in `call'
rack-test (2.2.0) lib/rack/test.rb:360:in `process_request'
rack-test (2.2.0) lib/rack/test.rb:153:in `request'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:297:in `process'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:25:in `post'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:388:in `post'
/home/micah/work/adva_comments/spec/requests/comments_spec.rb:19:in `block (3 levels) in <top (required)>'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `block in run'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-rails (7.1.1) lib/rspec/rails/adapters.rb:75:in `block (2 levels) in <module:MinitestLifecycleAdapter>'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:390:in `execute_with'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `run'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:259:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:653:in `block in run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:614:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `map'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/configuration.rb:2097:in `with_suite_hooks'
rspec-core (3.13.5) lib/rspec/core/runner.rb:116:in `block in run_specs'
rspec-core (3.13.5) lib/rspec/core/reporter.rb:74:in `report'
rspec-core (3.13.5) lib/rspec/core/runner.rb:115:in `run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:89:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:71:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:45:in `invoke'
rspec-core (3.13.5) exe/rspec:4:in `<top (required)>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `load'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `<main>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `eval'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `<main>'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments" for 127.0.0.1 at 2025-09-28 19:24:40 -0400
Processing by CommentsController#create as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"New Author", "author_email"=>"new@example.com", "body"=>"New comment body"}}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
[Invisible Captcha] Potential spam detected for IP 127.0.0.1. Timestamp not found in session.
Redirected to http://test-site.com/ref
Filter chain halted as #<Proc:0x00007964cbda17f0 /home/micah/.rvm/gems/ruby-3.3.4/gems/invisible_captcha-2.3.0/lib/invisible_captcha/controller_ext.rb:12> rendered or redirected
Completed 302 Found in 5ms (ActiveRecord: 0.3ms (6 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (63.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "counters"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "counters" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "owner_type" varchar, "owner_id" integer, "name" varchar(25), "count" integer DEFAULT 0)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_counters_on_owner" ON "counters" ("owner_type", "owner_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.1ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:25:10.932644"], ["updated_at", "2025-09-28 23:25:10.932644"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:25:10.942833"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:25:10.943727"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:25:10.946302"], ["created_at", "2025-09-28 23:25:10.950575"], ["updated_at", "2025-09-28 23:25:10.950575"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:25:10.977194"], ["updated_at", "2025-09-28 23:25:10.977194"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:25:10.979051"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:25:11.007729"], ["updated_at", "2025-09-28 23:25:11.007729"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:25:11.016263"], ["id", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:25:11.016795"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started GET "/comments/1" for 127.0.0.1 at 2025-09-28 19:25:11 -0400
Processing by CommentsController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.2ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  Rendering layout /home/micah/work/adva/app/views/layouts/default.html.erb
  Rendering /home/micah/work/adva_comments/app/views/comments/show.html.erb within layouts/default
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  Rendered /home/micah/work/adva_comments/app/views/comments/show.html.erb within layouts/default (Duration: 2.7ms | GC: 0.0ms)
  Rendered layout /home/micah/work/adva/app/views/layouts/default.html.erb (Duration: 2.8ms | GC: 0.0ms)
Completed 500 Internal Server Error in 9ms (ActiveRecord: 0.6ms (8 queries, 0 cached) | GC: 0.0ms)
  
ActionView::Template::Error (undefined method `article_path' for an instance of #<Class:0x00007112eed83980>)
Caused by: NoMethodError (undefined method `article_path' for an instance of #<Class:0x00007112eed83980>)

Information for: ActionView::Template::Error (undefined method `article_path' for an instance of #<Class:0x00007112eed83980>):
    1: <div id="comments">
    2:   <h2><%= t(:'adva.comments.titles.comment_number', :number => @comment.id) %></h2>
    3:   <p>
    4: 		<%= t(:'adva.comments.labels.on') %>: <%= link_to_content @comment.commentable %>
    5: 	</p>
    6:   <ol>
    7:     <%= render :partial => 'comments/comment', :object => @comment %>
  
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:96:in `method_missing'
/home/micah/work/adva/app/helpers/resource_helper.rb:13:in `resource_url'
/home/micah/work/adva/app/helpers/resource_helper.rb:29:in `resource_link'
/home/micah/work/adva/app/helpers/resource_helper.rb:48:in `block (2 levels) in <module:ResourceHelper>'
/home/micah/work/adva/app/helpers/content_helper.rb:53:in `link_to_content'
/home/micah/work/adva_comments/app/views/comments/show.html.erb:4
actionview (8.0.3) lib/action_view/base.rb:278:in `public_send'
actionview (8.0.3) lib/action_view/base.rb:278:in `_run'
actionview (8.0.3) lib/action_view/template.rb:284:in `block in render'
activesupport (8.0.3) lib/active_support/notifications.rb:212:in `instrument'
actionview (8.0.3) lib/action_view/template.rb:583:in `instrument_render_template'
actionview (8.0.3) lib/action_view/template.rb:272:in `render'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:66:in `block (2 levels) in render_template'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:60:in `block in render_template'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:76:in `block in render_with_layout'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:75:in `render_with_layout'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:59:in `render_template'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:11:in `render'
actionview (8.0.3) lib/action_view/renderer/renderer.rb:58:in `render_template_to_object'
actionview (8.0.3) lib/action_view/renderer/renderer.rb:31:in `render_to_object'
actionview (8.0.3) lib/action_view/rendering.rb:136:in `block in _render_template'
actionview (8.0.3) lib/action_view/base.rb:305:in `in_rendering_context'
actionview (8.0.3) lib/action_view/rendering.rb:135:in `_render_template'
actionpack (8.0.3) lib/action_controller/metal/streaming.rb:179:in `_render_template'
actionview (8.0.3) lib/action_view/rendering.rb:122:in `render_to_body'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:186:in `render_to_body'
actionpack (8.0.3) lib/action_controller/metal/renderers.rb:140:in `render_to_body'
actionpack (8.0.3) lib/abstract_controller/rendering.rb:28:in `render'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:167:in `render'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:31:in `block (2 levels) in render'
activesupport (8.0.3) lib/active_support/benchmark.rb:17:in `realtime'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:31:in `block in render'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:100:in `cleanup_view_runtime'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:46:in `cleanup_view_runtime'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:30:in `render'
/home/micah/work/adva/lib/rails_ext/action_controller/render_with_error_proc.rb:24:in `block in render'
/home/micah/work/adva/lib/rails_ext/action_controller/render_with_error_proc.rb:43:in `with_error_proc'
/home/micah/work/adva/lib/rails_ext/action_controller/render_with_error_proc.rb:23:in `render'
actionpack (8.0.3) lib/action_controller/metal/implicit_render.rb:39:in `default_render'
actionpack (8.0.3) lib/action_controller/metal/basic_implicit_render.rb:9:in `send_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:215:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:193:in `process_action'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:261:in `block in process_action'
activesupport (8.0.3) lib/active_support/callbacks.rb:120:in `block in run_callbacks'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/controller.rb:8:in `write_flash_to_cookie'
activesupport (8.0.3) lib/active_support/callbacks.rb:129:in `block in run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:140:in `run_callbacks'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:76:in `block in process_action'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:75:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:152:in `process'
actionview (8.0.3) lib/action_view/rendering.rb:40:in `process'
actionpack (8.0.3) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (8.0.3) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:908:in `call'
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:60:in `call'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/middleware.rb:8:in `call'
rack (3.2.1) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.2.1) lib/rack/etag.rb:29:in `call'
rack (3.2.1) lib/rack/conditional_get.rb:31:in `call'
rack (3.2.1) lib/rack/head.rb:15:in `call'
actionpack (8.0.3) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (8.0.3) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/cookies.rb:706:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (8.0.3) lib/active_support/callbacks.rb:100:in `run_callbacks'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (8.0.3) lib/rails/rack/logger.rb:41:in `call_app'
railties (8.0.3) lib/rails/rack/logger.rb:29:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/request_id.rb:34:in `call'
rack (3.2.1) lib/rack/method_override.rb:28:in `call'
rack (3.2.1) lib/rack/runtime.rb:24:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.2.1) lib/rack/sendfile.rb:114:in `call'
railties (8.0.3) lib/rails/engine.rb:535:in `call'
rack-test (2.2.0) lib/rack/test.rb:360:in `process_request'
rack-test (2.2.0) lib/rack/test.rb:153:in `request'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:297:in `process'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:19:in `get'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:388:in `get'
/home/micah/work/adva_comments/spec/requests/comments_spec.rb:15:in `block (3 levels) in <top (required)>'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `block in run'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-rails (7.1.1) lib/rspec/rails/adapters.rb:75:in `block (2 levels) in <module:MinitestLifecycleAdapter>'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:390:in `execute_with'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `run'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:259:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:653:in `block in run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:614:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `map'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/configuration.rb:2097:in `with_suite_hooks'
rspec-core (3.13.5) lib/rspec/core/runner.rb:116:in `block in run_specs'
rspec-core (3.13.5) lib/rspec/core/reporter.rb:74:in `report'
rspec-core (3.13.5) lib/rspec/core/runner.rb:115:in `run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:89:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:71:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:45:in `invoke'
rspec-core (3.13.5) exe/rspec:4:in `<top (required)>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `load'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `<main>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `eval'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `<main>'

Information for cause: NoMethodError (undefined method `article_path' for an instance of #<Class:0x00007112eed83980>):
  
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:96:in `method_missing'
/home/micah/work/adva/app/helpers/resource_helper.rb:13:in `resource_url'
/home/micah/work/adva/app/helpers/resource_helper.rb:29:in `resource_link'
/home/micah/work/adva/app/helpers/resource_helper.rb:48:in `block (2 levels) in <module:ResourceHelper>'
/home/micah/work/adva/app/helpers/content_helper.rb:53:in `link_to_content'
/home/micah/work/adva_comments/app/views/comments/show.html.erb:4
actionview (8.0.3) lib/action_view/base.rb:278:in `public_send'
actionview (8.0.3) lib/action_view/base.rb:278:in `_run'
actionview (8.0.3) lib/action_view/template.rb:284:in `block in render'
activesupport (8.0.3) lib/active_support/notifications.rb:212:in `instrument'
actionview (8.0.3) lib/action_view/template.rb:583:in `instrument_render_template'
actionview (8.0.3) lib/action_view/template.rb:272:in `render'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:66:in `block (2 levels) in render_template'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:60:in `block in render_template'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:76:in `block in render_with_layout'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:75:in `render_with_layout'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:59:in `render_template'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:11:in `render'
actionview (8.0.3) lib/action_view/renderer/renderer.rb:58:in `render_template_to_object'
actionview (8.0.3) lib/action_view/renderer/renderer.rb:31:in `render_to_object'
actionview (8.0.3) lib/action_view/rendering.rb:136:in `block in _render_template'
actionview (8.0.3) lib/action_view/base.rb:305:in `in_rendering_context'
actionview (8.0.3) lib/action_view/rendering.rb:135:in `_render_template'
actionpack (8.0.3) lib/action_controller/metal/streaming.rb:179:in `_render_template'
actionview (8.0.3) lib/action_view/rendering.rb:122:in `render_to_body'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:186:in `render_to_body'
actionpack (8.0.3) lib/action_controller/metal/renderers.rb:140:in `render_to_body'
actionpack (8.0.3) lib/abstract_controller/rendering.rb:28:in `render'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:167:in `render'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:31:in `block (2 levels) in render'
activesupport (8.0.3) lib/active_support/benchmark.rb:17:in `realtime'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:31:in `block in render'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:100:in `cleanup_view_runtime'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:46:in `cleanup_view_runtime'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:30:in `render'
/home/micah/work/adva/lib/rails_ext/action_controller/render_with_error_proc.rb:24:in `block in render'
/home/micah/work/adva/lib/rails_ext/action_controller/render_with_error_proc.rb:43:in `with_error_proc'
/home/micah/work/adva/lib/rails_ext/action_controller/render_with_error_proc.rb:23:in `render'
actionpack (8.0.3) lib/action_controller/metal/implicit_render.rb:39:in `default_render'
actionpack (8.0.3) lib/action_controller/metal/basic_implicit_render.rb:9:in `send_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:215:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:193:in `process_action'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:261:in `block in process_action'
activesupport (8.0.3) lib/active_support/callbacks.rb:120:in `block in run_callbacks'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/controller.rb:8:in `write_flash_to_cookie'
activesupport (8.0.3) lib/active_support/callbacks.rb:129:in `block in run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:140:in `run_callbacks'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:76:in `block in process_action'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:75:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:152:in `process'
actionview (8.0.3) lib/action_view/rendering.rb:40:in `process'
actionpack (8.0.3) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (8.0.3) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:908:in `call'
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:60:in `call'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/middleware.rb:8:in `call'
rack (3.2.1) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.2.1) lib/rack/etag.rb:29:in `call'
rack (3.2.1) lib/rack/conditional_get.rb:31:in `call'
rack (3.2.1) lib/rack/head.rb:15:in `call'
actionpack (8.0.3) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (8.0.3) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/cookies.rb:706:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (8.0.3) lib/active_support/callbacks.rb:100:in `run_callbacks'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (8.0.3) lib/rails/rack/logger.rb:41:in `call_app'
railties (8.0.3) lib/rails/rack/logger.rb:29:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/request_id.rb:34:in `call'
rack (3.2.1) lib/rack/method_override.rb:28:in `call'
rack (3.2.1) lib/rack/runtime.rb:24:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.2.1) lib/rack/sendfile.rb:114:in `call'
railties (8.0.3) lib/rails/engine.rb:535:in `call'
rack-test (2.2.0) lib/rack/test.rb:360:in `process_request'
rack-test (2.2.0) lib/rack/test.rb:153:in `request'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:297:in `process'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:19:in `get'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:388:in `get'
/home/micah/work/adva_comments/spec/requests/comments_spec.rb:15:in `block (3 levels) in <top (required)>'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `block in run'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-rails (7.1.1) lib/rspec/rails/adapters.rb:75:in `block (2 levels) in <module:MinitestLifecycleAdapter>'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:390:in `execute_with'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `run'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:259:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:653:in `block in run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:614:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `map'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/configuration.rb:2097:in `with_suite_hooks'
rspec-core (3.13.5) lib/rspec/core/runner.rb:116:in `block in run_specs'
rspec-core (3.13.5) lib/rspec/core/reporter.rb:74:in `report'
rspec-core (3.13.5) lib/rspec/core/runner.rb:115:in `run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:89:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:71:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:45:in `invoke'
rspec-core (3.13.5) exe/rspec:4:in `<top (required)>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `load'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `<main>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `eval'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `<main>'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments/preview" for 127.0.0.1 at 2025-09-28 19:25:11 -0400
Processing by CommentsController#preview as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"Previewer", "author_email"=>"preview@example.com", "body"=>"Hello preview"}}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
  Rendering /home/micah/work/adva_comments/app/views/comments/preview.html.erb
  Rendered /home/micah/work/adva_comments/app/views/comments/preview.html.erb (Duration: 0.2ms | GC: 0.0ms)
Completed 200 OK in 7ms (Views: 0.7ms | ActiveRecord: 0.4ms (6 queries, 0 cached) | GC: 0.3ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments" for 127.0.0.1 at 2025-09-28 19:25:11 -0400
Processing by CommentsController#create as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"New Author", "author_email"=>"new@example.com", "body"=>"New comment body"}}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
[Invisible Captcha] Potential spam detected for IP 127.0.0.1. Timestamp not found in session.
Redirected to http://test-site.com/ref
Filter chain halted as #<Proc:0x00007112eeaeebc0 /home/micah/.rvm/gems/ruby-3.3.4/gems/invisible_captcha-2.3.0/lib/invisible_captcha/controller_ext.rb:12> rendered or redirected
Completed 302 Found in 4ms (ActiveRecord: 0.5ms (6 queries, 0 cached) | GC: 0.1ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (6.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "counters"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "counters" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "owner_type" varchar, "owner_id" integer, "name" varchar(25), "count" integer DEFAULT 0)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_counters_on_owner" ON "counters" ("owner_type", "owner_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.9ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:25:34.239798"], ["updated_at", "2025-09-28 23:25:34.239798"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:25:34.276845"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:25:34.278305"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:25:34.281482"], ["created_at", "2025-09-28 23:25:34.286692"], ["updated_at", "2025-09-28 23:25:34.286692"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:25:34.303016"], ["updated_at", "2025-09-28 23:25:34.303016"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:25:34.304938"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:25:34.340708"], ["updated_at", "2025-09-28 23:25:34.340708"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.0ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:25:34.349724"], ["id", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:25:34.350289"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments/preview" for 127.0.0.1 at 2025-09-28 19:25:34 -0400
Processing by CommentsController#preview as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"Previewer", "author_email"=>"preview@example.com", "body"=>"Hello preview"}}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
  Rendering /home/micah/work/adva_comments/app/views/comments/preview.html.erb
  Rendered /home/micah/work/adva_comments/app/views/comments/preview.html.erb (Duration: 0.3ms | GC: 0.0ms)
Completed 200 OK in 11ms (Views: 3.5ms | ActiveRecord: 0.6ms (6 queries, 0 cached) | GC: 0.1ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments" for 127.0.0.1 at 2025-09-28 19:25:34 -0400
Processing by CommentsController#create as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"New Author", "author_email"=>"new@example.com", "body"=>"New comment body"}}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
[Invisible Captcha] Potential spam detected for IP 127.0.0.1. Timestamp not found in session.
Redirected to http://test-site.com/ref
Filter chain halted as #<Proc:0x00007d800356ec98 /home/micah/.rvm/gems/ruby-3.3.4/gems/invisible_captcha-2.3.0/lib/invisible_captcha/controller_ext.rb:12> rendered or redirected
Completed 302 Found in 4ms (ActiveRecord: 0.4ms (6 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (58.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "counters"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "counters" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "owner_type" varchar, "owner_id" integer, "name" varchar(25), "count" integer DEFAULT 0)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_counters_on_owner" ON "counters" ("owner_type", "owner_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.1ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:28:20.518919"], ["updated_at", "2025-09-28 23:28:20.518919"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:28:20.560561"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:28:20.561679"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:28:20.564692"], ["created_at", "2025-09-28 23:28:20.570187"], ["updated_at", "2025-09-28 23:28:20.570187"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:28:20.585695"], ["updated_at", "2025-09-28 23:28:20.585695"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:28:20.587648"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:28:20.623323"], ["updated_at", "2025-09-28 23:28:20.623323"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.0ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:28:20.631850"], ["id", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:28:20.632417"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments/preview" for 127.0.0.1 at 2025-09-28 19:28:20 -0400
Processing by CommentsController#preview as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"Previewer", "author_email"=>"preview@example.com", "body"=>"Hello preview"}}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
  Rendering /home/micah/work/adva_comments/app/views/comments/preview.html.erb
  Rendered /home/micah/work/adva_comments/app/views/comments/preview.html.erb (Duration: 0.3ms | GC: 0.0ms)
Completed 200 OK in 10ms (Views: 3.4ms | ActiveRecord: 0.5ms (6 queries, 0 cached) | GC: 0.1ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments" for 127.0.0.1 at 2025-09-28 19:28:20 -0400
Processing by CommentsController#create as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"New Author", "author_email"=>"new@example.com", "body"=>"New comment body"}}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
[Invisible Captcha] Potential spam detected for IP 127.0.0.1. Timestamp not found in session.
Redirected to http://test-site.com/ref
Filter chain halted as #<Proc:0x0000716c9b52e878 /home/micah/.rvm/gems/ruby-3.3.4/gems/invisible_captcha-2.3.0/lib/invisible_captcha/controller_ext.rb:12> rendered or redirected
Completed 302 Found in 4ms (ActiveRecord: 0.3ms (6 queries, 0 cached) | GC: 0.1ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (5.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "counters"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "counters" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "owner_type" varchar, "owner_id" integer, "name" varchar(25), "count" integer DEFAULT 0)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_counters_on_owner" ON "counters" ("owner_type", "owner_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.1ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:29:31.091159"], ["updated_at", "2025-09-28 23:29:31.091159"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:29:31.101900"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:29:31.102899"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:29:31.105539"], ["created_at", "2025-09-28 23:29:31.109834"], ["updated_at", "2025-09-28 23:29:31.109834"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:29:31.133040"], ["updated_at", "2025-09-28 23:29:31.133040"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:29:31.134929"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:29:31.163534"], ["updated_at", "2025-09-28 23:29:31.163534"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:29:31.178349"], ["id", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:29:31.178868"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.2ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments/preview" for 127.0.0.1 at 2025-09-28 19:29:31 -0400
Processing by CommentsController#preview as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"Previewer", "author_email"=>"preview@example.com", "body"=>"Hello preview"}}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
  Rendering /home/micah/work/adva_comments/app/views/comments/preview.html.erb
  Rendered /home/micah/work/adva_comments/app/views/comments/preview.html.erb (Duration: 0.2ms | GC: 0.0ms)
Completed 200 OK in 8ms (Views: 2.5ms | ActiveRecord: 0.5ms (6 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments" for 127.0.0.1 at 2025-09-28 19:29:31 -0400
Processing by CommentsController#create as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"New Author", "author_email"=>"new@example.com", "body"=>"New comment body"}}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
[Invisible Captcha] Potential spam detected for IP 127.0.0.1. Timestamp not found in session.
Redirected to http://test-site.com/ref
Filter chain halted as #<Proc:0x0000733aaff4a6e8 /home/micah/.rvm/gems/ruby-3.3.4/gems/invisible_captcha-2.3.0/lib/invisible_captcha/controller_ext.rb:12> rendered or redirected
Completed 302 Found in 4ms (ActiveRecord: 0.4ms (6 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (7.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "counters"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "counters" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "owner_type" varchar, "owner_id" integer, "name" varchar(25), "count" integer DEFAULT 0)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_counters_on_owner" ON "counters" ("owner_type", "owner_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.1ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:31:14.908661"], ["updated_at", "2025-09-28 23:31:14.908661"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:31:14.918942"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:31:14.919917"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:31:14.922694"], ["created_at", "2025-09-28 23:31:14.927586"], ["updated_at", "2025-09-28 23:31:14.927586"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:31:14.949279"], ["updated_at", "2025-09-28 23:31:14.949279"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:31:14.951036"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:31:14.985408"], ["updated_at", "2025-09-28 23:31:14.985408"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.0ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:31:14.994198"], ["id", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:31:14.994735"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started GET "/admin/comments" for 127.0.0.1 at 2025-09-28 19:31:15 -0400
Processing by Admin::CommentsController#index as HTML
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  Rendering layout /home/micah/work/adva/app/views/layouts/admin.html.erb
  Rendering /home/micah/work/adva_comments/app/views/admin/comments/index.html.erb within layouts/admin
  [1m[36mComment Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."site_id" = ? AND (commentable_type NOT IN (?))[0m  [["site_id", 1], [nil, "Topic"]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."site_id" = ? AND (commentable_type NOT IN (?)) ORDER BY comments.created_at DESC LIMIT ? OFFSET ?[0m  [["site_id", 1], [nil, "Topic"], ["LIMIT", 25], ["OFFSET", 0]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  Rendered /home/micah/work/adva_comments/app/views/admin/comments/index.html.erb within layouts/admin (Duration: 6.5ms | GC: 0.0ms)
  Rendered layout /home/micah/work/adva/app/views/layouts/admin.html.erb (Duration: 6.6ms | GC: 0.0ms)
Completed 500 Internal Server Error in 11ms (ActiveRecord: 0.4ms (6 queries, 0 cached) | GC: 0.0ms)
  
ActionView::Template::Error (undefined method `section_article_path' for an instance of #<Class:0x000072fcb6a35dd8>)
Caused by: NoMethodError (undefined method `section_article_path' for an instance of #<Class:0x000072fcb6a35dd8>)

Information for: ActionView::Template::Error (undefined method `section_article_path' for an instance of #<Class:0x000072fcb6a35dd8>):
    4:   <% if @comments.present? %>
    5:     <% @comments.each do |comment, i| %>
    6:       <li class="<%= cycle 'alt', '' %>" id="<%= dom_id(comment) %>">
    7:         <h4><%= link_to comment.commentable.title, [comment.commentable.section, comment.commentable] if comment.commentable %></h4>
    8:         <div class="actions">
    9:           <%= comment.approved? ?
   10:             link_to(t(:'adva.comments.links.unapprove'), admin_comment_path(comment, "comment[approved]" => 0, :return_to => request.fullpath), :class => 'text', :method => :put) :
  
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:96:in `method_missing'
actionpack (8.0.3) lib/action_dispatch/routing/polymorphic_routes.rb:242:in `public_send'
actionpack (8.0.3) lib/action_dispatch/routing/polymorphic_routes.rb:242:in `polymorphic_method'
actionpack (8.0.3) lib/action_dispatch/routing/polymorphic_routes.rb:148:in `polymorphic_path'
actionview (8.0.3) lib/action_view/routing_url_for.rb:105:in `url_for'
actionview (8.0.3) lib/action_view/helpers/url_helper.rb:702:in `url_target'
actionview (8.0.3) lib/action_view/helpers/url_helper.rb:204:in `link_to'
/home/micah/work/adva_comments/app/views/admin/comments/index.html.erb:7
activerecord (8.0.3) lib/active_record/relation/delegation.rb:101:in `each'
activerecord (8.0.3) lib/active_record/relation/delegation.rb:101:in `each'
/home/micah/work/adva_comments/app/views/admin/comments/index.html.erb:5
actionview (8.0.3) lib/action_view/base.rb:278:in `public_send'
actionview (8.0.3) lib/action_view/base.rb:278:in `_run'
actionview (8.0.3) lib/action_view/template.rb:284:in `block in render'
activesupport (8.0.3) lib/active_support/notifications.rb:212:in `instrument'
actionview (8.0.3) lib/action_view/template.rb:583:in `instrument_render_template'
actionview (8.0.3) lib/action_view/template.rb:272:in `render'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:66:in `block (2 levels) in render_template'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:60:in `block in render_template'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:76:in `block in render_with_layout'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:75:in `render_with_layout'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:59:in `render_template'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:11:in `render'
actionview (8.0.3) lib/action_view/renderer/renderer.rb:58:in `render_template_to_object'
actionview (8.0.3) lib/action_view/renderer/renderer.rb:31:in `render_to_object'
actionview (8.0.3) lib/action_view/rendering.rb:136:in `block in _render_template'
actionview (8.0.3) lib/action_view/base.rb:305:in `in_rendering_context'
actionview (8.0.3) lib/action_view/rendering.rb:135:in `_render_template'
actionpack (8.0.3) lib/action_controller/metal/streaming.rb:179:in `_render_template'
actionview (8.0.3) lib/action_view/rendering.rb:122:in `render_to_body'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:186:in `render_to_body'
actionpack (8.0.3) lib/action_controller/metal/renderers.rb:140:in `render_to_body'
actionpack (8.0.3) lib/abstract_controller/rendering.rb:28:in `render'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:167:in `render'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:31:in `block (2 levels) in render'
activesupport (8.0.3) lib/active_support/benchmark.rb:17:in `realtime'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:31:in `block in render'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:100:in `cleanup_view_runtime'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:46:in `cleanup_view_runtime'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:30:in `render'
/home/micah/work/adva/lib/rails_ext/action_controller/render_with_error_proc.rb:24:in `block in render'
/home/micah/work/adva/lib/rails_ext/action_controller/render_with_error_proc.rb:39:in `with_error_proc'
/home/micah/work/adva/lib/rails_ext/action_controller/render_with_error_proc.rb:23:in `render'
actionpack (8.0.3) lib/action_controller/metal/implicit_render.rb:39:in `default_render'
actionpack (8.0.3) lib/action_controller/metal/basic_implicit_render.rb:9:in `send_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:215:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:193:in `process_action'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:261:in `block in process_action'
activesupport (8.0.3) lib/active_support/callbacks.rb:120:in `block in run_callbacks'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/controller.rb:8:in `write_flash_to_cookie'
activesupport (8.0.3) lib/active_support/callbacks.rb:129:in `block in run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:140:in `run_callbacks'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:76:in `block in process_action'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:75:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:152:in `process'
actionview (8.0.3) lib/action_view/rendering.rb:40:in `process'
actionpack (8.0.3) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (8.0.3) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:908:in `call'
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:60:in `call'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/middleware.rb:8:in `call'
rack (3.2.1) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.2.1) lib/rack/etag.rb:29:in `call'
rack (3.2.1) lib/rack/conditional_get.rb:31:in `call'
rack (3.2.1) lib/rack/head.rb:15:in `call'
actionpack (8.0.3) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (8.0.3) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/cookies.rb:706:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (8.0.3) lib/active_support/callbacks.rb:100:in `run_callbacks'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (8.0.3) lib/rails/rack/logger.rb:41:in `call_app'
railties (8.0.3) lib/rails/rack/logger.rb:29:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/request_id.rb:34:in `call'
rack (3.2.1) lib/rack/method_override.rb:28:in `call'
rack (3.2.1) lib/rack/runtime.rb:24:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.2.1) lib/rack/sendfile.rb:114:in `call'
railties (8.0.3) lib/rails/engine.rb:535:in `call'
rack-test (2.2.0) lib/rack/test.rb:360:in `process_request'
rack-test (2.2.0) lib/rack/test.rb:153:in `request'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:297:in `process'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:19:in `get'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:388:in `get'
/home/micah/work/adva_comments/spec/requests/admin/comments_spec.rb:24:in `block (3 levels) in <top (required)>'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `block in run'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-rails (7.1.1) lib/rspec/rails/adapters.rb:75:in `block (2 levels) in <module:MinitestLifecycleAdapter>'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:390:in `execute_with'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `run'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:259:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:653:in `block in run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:614:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `map'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/configuration.rb:2097:in `with_suite_hooks'
rspec-core (3.13.5) lib/rspec/core/runner.rb:116:in `block in run_specs'
rspec-core (3.13.5) lib/rspec/core/reporter.rb:74:in `report'
rspec-core (3.13.5) lib/rspec/core/runner.rb:115:in `run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:89:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:71:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:45:in `invoke'
rspec-core (3.13.5) exe/rspec:4:in `<top (required)>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `load'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `<main>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `eval'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `<main>'

Information for cause: NoMethodError (undefined method `section_article_path' for an instance of #<Class:0x000072fcb6a35dd8>):
  
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:96:in `method_missing'
actionpack (8.0.3) lib/action_dispatch/routing/polymorphic_routes.rb:242:in `public_send'
actionpack (8.0.3) lib/action_dispatch/routing/polymorphic_routes.rb:242:in `polymorphic_method'
actionpack (8.0.3) lib/action_dispatch/routing/polymorphic_routes.rb:148:in `polymorphic_path'
actionview (8.0.3) lib/action_view/routing_url_for.rb:105:in `url_for'
actionview (8.0.3) lib/action_view/helpers/url_helper.rb:702:in `url_target'
actionview (8.0.3) lib/action_view/helpers/url_helper.rb:204:in `link_to'
/home/micah/work/adva_comments/app/views/admin/comments/index.html.erb:7
activerecord (8.0.3) lib/active_record/relation/delegation.rb:101:in `each'
activerecord (8.0.3) lib/active_record/relation/delegation.rb:101:in `each'
/home/micah/work/adva_comments/app/views/admin/comments/index.html.erb:5
actionview (8.0.3) lib/action_view/base.rb:278:in `public_send'
actionview (8.0.3) lib/action_view/base.rb:278:in `_run'
actionview (8.0.3) lib/action_view/template.rb:284:in `block in render'
activesupport (8.0.3) lib/active_support/notifications.rb:212:in `instrument'
actionview (8.0.3) lib/action_view/template.rb:583:in `instrument_render_template'
actionview (8.0.3) lib/action_view/template.rb:272:in `render'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:66:in `block (2 levels) in render_template'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:60:in `block in render_template'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:76:in `block in render_with_layout'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:75:in `render_with_layout'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:59:in `render_template'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:11:in `render'
actionview (8.0.3) lib/action_view/renderer/renderer.rb:58:in `render_template_to_object'
actionview (8.0.3) lib/action_view/renderer/renderer.rb:31:in `render_to_object'
actionview (8.0.3) lib/action_view/rendering.rb:136:in `block in _render_template'
actionview (8.0.3) lib/action_view/base.rb:305:in `in_rendering_context'
actionview (8.0.3) lib/action_view/rendering.rb:135:in `_render_template'
actionpack (8.0.3) lib/action_controller/metal/streaming.rb:179:in `_render_template'
actionview (8.0.3) lib/action_view/rendering.rb:122:in `render_to_body'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:186:in `render_to_body'
actionpack (8.0.3) lib/action_controller/metal/renderers.rb:140:in `render_to_body'
actionpack (8.0.3) lib/abstract_controller/rendering.rb:28:in `render'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:167:in `render'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:31:in `block (2 levels) in render'
activesupport (8.0.3) lib/active_support/benchmark.rb:17:in `realtime'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:31:in `block in render'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:100:in `cleanup_view_runtime'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:46:in `cleanup_view_runtime'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:30:in `render'
/home/micah/work/adva/lib/rails_ext/action_controller/render_with_error_proc.rb:24:in `block in render'
/home/micah/work/adva/lib/rails_ext/action_controller/render_with_error_proc.rb:39:in `with_error_proc'
/home/micah/work/adva/lib/rails_ext/action_controller/render_with_error_proc.rb:23:in `render'
actionpack (8.0.3) lib/action_controller/metal/implicit_render.rb:39:in `default_render'
actionpack (8.0.3) lib/action_controller/metal/basic_implicit_render.rb:9:in `send_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:215:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:193:in `process_action'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:261:in `block in process_action'
activesupport (8.0.3) lib/active_support/callbacks.rb:120:in `block in run_callbacks'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/controller.rb:8:in `write_flash_to_cookie'
activesupport (8.0.3) lib/active_support/callbacks.rb:129:in `block in run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:140:in `run_callbacks'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:76:in `block in process_action'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:75:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:152:in `process'
actionview (8.0.3) lib/action_view/rendering.rb:40:in `process'
actionpack (8.0.3) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (8.0.3) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:908:in `call'
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:60:in `call'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/middleware.rb:8:in `call'
rack (3.2.1) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.2.1) lib/rack/etag.rb:29:in `call'
rack (3.2.1) lib/rack/conditional_get.rb:31:in `call'
rack (3.2.1) lib/rack/head.rb:15:in `call'
actionpack (8.0.3) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (8.0.3) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/cookies.rb:706:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (8.0.3) lib/active_support/callbacks.rb:100:in `run_callbacks'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (8.0.3) lib/rails/rack/logger.rb:41:in `call_app'
railties (8.0.3) lib/rails/rack/logger.rb:29:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/request_id.rb:34:in `call'
rack (3.2.1) lib/rack/method_override.rb:28:in `call'
rack (3.2.1) lib/rack/runtime.rb:24:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.2.1) lib/rack/sendfile.rb:114:in `call'
railties (8.0.3) lib/rails/engine.rb:535:in `call'
rack-test (2.2.0) lib/rack/test.rb:360:in `process_request'
rack-test (2.2.0) lib/rack/test.rb:153:in `request'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:297:in `process'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:19:in `get'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:388:in `get'
/home/micah/work/adva_comments/spec/requests/admin/comments_spec.rb:24:in `block (3 levels) in <top (required)>'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `block in run'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-rails (7.1.1) lib/rspec/rails/adapters.rb:75:in `block (2 levels) in <module:MinitestLifecycleAdapter>'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:390:in `execute_with'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `run'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:259:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:653:in `block in run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:614:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `map'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/configuration.rb:2097:in `with_suite_hooks'
rspec-core (3.13.5) lib/rspec/core/runner.rb:116:in `block in run_specs'
rspec-core (3.13.5) lib/rspec/core/reporter.rb:74:in `report'
rspec-core (3.13.5) lib/rspec/core/runner.rb:115:in `run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:89:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:71:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:45:in `invoke'
rspec-core (3.13.5) exe/rspec:4:in `<top (required)>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `load'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `<main>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `eval'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `<main>'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started GET "/admin/comments/1/edit" for 127.0.0.1 at 2025-09-28 19:31:15 -0400
Processing by Admin::CommentsController#edit as HTML
  Parameters: {"id"=>"1"}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  Rendering layout /home/micah/work/adva/app/views/layouts/admin.html.erb
  Rendering /home/micah/work/adva_comments/app/views/admin/comments/edit.html.erb within layouts/admin
  Rendered /home/micah/work/adva_comments/app/views/admin/comments/_form.html.erb (Duration: 0.3ms | GC: 0.0ms)
  Rendered /home/micah/work/adva_comments/app/views/admin/comments/edit.html.erb within layouts/admin (Duration: 1.0ms | GC: 0.0ms)
  Rendered layout /home/micah/work/adva/app/views/layouts/admin.html.erb (Duration: 1.1ms | GC: 0.0ms)
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.1ms (3 queries, 0 cached) | GC: 0.1ms)
  
ActionView::Template::Error (undefined method `request_uri' for an instance of ActionDispatch::Request)
Caused by: NoMethodError (undefined method `request_uri' for an instance of ActionDispatch::Request)

Information for: ActionView::Template::Error (undefined method `request_uri' for an instance of ActionDispatch::Request):
    1: <%= hidden_field_tag "return_to", params[:return_to] || request.request_uri %>
    2: 
    3: <% f.field_set do %>
    4:   <%= f.text_area :body, :rows => 8, :label => :'adva.titles.comment'  %>
  
/home/micah/work/adva_comments/app/views/admin/comments/_form.html.erb:1
actionview (8.0.3) lib/action_view/base.rb:278:in `public_send'
actionview (8.0.3) lib/action_view/base.rb:278:in `_run'
actionview (8.0.3) lib/action_view/template.rb:284:in `block in render'
activesupport (8.0.3) lib/active_support/notifications.rb:212:in `instrument'
actionview (8.0.3) lib/action_view/template.rb:583:in `instrument_render_template'
actionview (8.0.3) lib/action_view/template.rb:272:in `render'
actionview (8.0.3) lib/action_view/renderer/partial_renderer.rb:252:in `block in render_partial_template'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionview (8.0.3) lib/action_view/renderer/partial_renderer.rb:246:in `render_partial_template'
actionview (8.0.3) lib/action_view/renderer/partial_renderer.rb:237:in `render'
actionview (8.0.3) lib/action_view/renderer/renderer.rb:78:in `render_partial_to_object'
actionview (8.0.3) lib/action_view/renderer/renderer.rb:49:in `render_partial'
actionview (8.0.3) lib/action_view/helpers/rendering_helper.rb:143:in `block in render'
actionview (8.0.3) lib/action_view/base.rb:305:in `in_rendering_context'
actionview (8.0.3) lib/action_view/helpers/rendering_helper.rb:141:in `render'
/home/micah/work/adva_comments/app/views/admin/comments/edit.html.erb:3
actionview (8.0.3) lib/action_view/helpers/capture_helper.rb:50:in `block in capture'
actionview (8.0.3) lib/action_view/buffers.rb:75:in `capture'
actionview (8.0.3) lib/action_view/helpers/capture_helper.rb:50:in `capture'
actionview (8.0.3) lib/action_view/helpers/form_helper.rb:777:in `form_with'
actionview (8.0.3) lib/action_view/helpers/form_helper.rb:464:in `form_for'
/home/micah/work/adva_comments/app/views/admin/comments/edit.html.erb:3
actionview (8.0.3) lib/action_view/base.rb:278:in `public_send'
actionview (8.0.3) lib/action_view/base.rb:278:in `_run'
actionview (8.0.3) lib/action_view/template.rb:284:in `block in render'
activesupport (8.0.3) lib/active_support/notifications.rb:212:in `instrument'
actionview (8.0.3) lib/action_view/template.rb:583:in `instrument_render_template'
actionview (8.0.3) lib/action_view/template.rb:272:in `render'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:66:in `block (2 levels) in render_template'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:60:in `block in render_template'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:76:in `block in render_with_layout'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:75:in `render_with_layout'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:59:in `render_template'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:11:in `render'
actionview (8.0.3) lib/action_view/renderer/renderer.rb:58:in `render_template_to_object'
actionview (8.0.3) lib/action_view/renderer/renderer.rb:31:in `render_to_object'
actionview (8.0.3) lib/action_view/rendering.rb:136:in `block in _render_template'
actionview (8.0.3) lib/action_view/base.rb:305:in `in_rendering_context'
actionview (8.0.3) lib/action_view/rendering.rb:135:in `_render_template'
actionpack (8.0.3) lib/action_controller/metal/streaming.rb:179:in `_render_template'
actionview (8.0.3) lib/action_view/rendering.rb:122:in `render_to_body'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:186:in `render_to_body'
actionpack (8.0.3) lib/action_controller/metal/renderers.rb:140:in `render_to_body'
actionpack (8.0.3) lib/abstract_controller/rendering.rb:28:in `render'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:167:in `render'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:31:in `block (2 levels) in render'
activesupport (8.0.3) lib/active_support/benchmark.rb:17:in `realtime'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:31:in `block in render'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:100:in `cleanup_view_runtime'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:46:in `cleanup_view_runtime'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:30:in `render'
/home/micah/work/adva/lib/rails_ext/action_controller/render_with_error_proc.rb:24:in `block in render'
/home/micah/work/adva/lib/rails_ext/action_controller/render_with_error_proc.rb:39:in `with_error_proc'
/home/micah/work/adva/lib/rails_ext/action_controller/render_with_error_proc.rb:23:in `render'
actionpack (8.0.3) lib/action_controller/metal/implicit_render.rb:39:in `default_render'
actionpack (8.0.3) lib/action_controller/metal/basic_implicit_render.rb:9:in `send_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:215:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:193:in `process_action'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:261:in `block in process_action'
activesupport (8.0.3) lib/active_support/callbacks.rb:120:in `block in run_callbacks'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/controller.rb:8:in `write_flash_to_cookie'
activesupport (8.0.3) lib/active_support/callbacks.rb:129:in `block in run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:140:in `run_callbacks'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:76:in `block in process_action'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:75:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:152:in `process'
actionview (8.0.3) lib/action_view/rendering.rb:40:in `process'
actionpack (8.0.3) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (8.0.3) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:908:in `call'
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:60:in `call'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/middleware.rb:8:in `call'
rack (3.2.1) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.2.1) lib/rack/etag.rb:29:in `call'
rack (3.2.1) lib/rack/conditional_get.rb:31:in `call'
rack (3.2.1) lib/rack/head.rb:15:in `call'
actionpack (8.0.3) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (8.0.3) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/cookies.rb:706:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (8.0.3) lib/active_support/callbacks.rb:100:in `run_callbacks'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (8.0.3) lib/rails/rack/logger.rb:41:in `call_app'
railties (8.0.3) lib/rails/rack/logger.rb:29:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/request_id.rb:34:in `call'
rack (3.2.1) lib/rack/method_override.rb:28:in `call'
rack (3.2.1) lib/rack/runtime.rb:24:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.2.1) lib/rack/sendfile.rb:114:in `call'
railties (8.0.3) lib/rails/engine.rb:535:in `call'
rack-test (2.2.0) lib/rack/test.rb:360:in `process_request'
rack-test (2.2.0) lib/rack/test.rb:153:in `request'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:297:in `process'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:19:in `get'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:388:in `get'
/home/micah/work/adva_comments/spec/requests/admin/comments_spec.rb:32:in `block (3 levels) in <top (required)>'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `block in run'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-rails (7.1.1) lib/rspec/rails/adapters.rb:75:in `block (2 levels) in <module:MinitestLifecycleAdapter>'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:390:in `execute_with'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `run'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:259:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:653:in `block in run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:614:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `map'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/configuration.rb:2097:in `with_suite_hooks'
rspec-core (3.13.5) lib/rspec/core/runner.rb:116:in `block in run_specs'
rspec-core (3.13.5) lib/rspec/core/reporter.rb:74:in `report'
rspec-core (3.13.5) lib/rspec/core/runner.rb:115:in `run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:89:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:71:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:45:in `invoke'
rspec-core (3.13.5) exe/rspec:4:in `<top (required)>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `load'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `<main>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `eval'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `<main>'

Information for cause: NoMethodError (undefined method `request_uri' for an instance of ActionDispatch::Request):
  
/home/micah/work/adva_comments/app/views/admin/comments/_form.html.erb:1
actionview (8.0.3) lib/action_view/base.rb:278:in `public_send'
actionview (8.0.3) lib/action_view/base.rb:278:in `_run'
actionview (8.0.3) lib/action_view/template.rb:284:in `block in render'
activesupport (8.0.3) lib/active_support/notifications.rb:212:in `instrument'
actionview (8.0.3) lib/action_view/template.rb:583:in `instrument_render_template'
actionview (8.0.3) lib/action_view/template.rb:272:in `render'
actionview (8.0.3) lib/action_view/renderer/partial_renderer.rb:252:in `block in render_partial_template'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionview (8.0.3) lib/action_view/renderer/partial_renderer.rb:246:in `render_partial_template'
actionview (8.0.3) lib/action_view/renderer/partial_renderer.rb:237:in `render'
actionview (8.0.3) lib/action_view/renderer/renderer.rb:78:in `render_partial_to_object'
actionview (8.0.3) lib/action_view/renderer/renderer.rb:49:in `render_partial'
actionview (8.0.3) lib/action_view/helpers/rendering_helper.rb:143:in `block in render'
actionview (8.0.3) lib/action_view/base.rb:305:in `in_rendering_context'
actionview (8.0.3) lib/action_view/helpers/rendering_helper.rb:141:in `render'
/home/micah/work/adva_comments/app/views/admin/comments/edit.html.erb:3
actionview (8.0.3) lib/action_view/helpers/capture_helper.rb:50:in `block in capture'
actionview (8.0.3) lib/action_view/buffers.rb:75:in `capture'
actionview (8.0.3) lib/action_view/helpers/capture_helper.rb:50:in `capture'
actionview (8.0.3) lib/action_view/helpers/form_helper.rb:777:in `form_with'
actionview (8.0.3) lib/action_view/helpers/form_helper.rb:464:in `form_for'
/home/micah/work/adva_comments/app/views/admin/comments/edit.html.erb:3
actionview (8.0.3) lib/action_view/base.rb:278:in `public_send'
actionview (8.0.3) lib/action_view/base.rb:278:in `_run'
actionview (8.0.3) lib/action_view/template.rb:284:in `block in render'
activesupport (8.0.3) lib/active_support/notifications.rb:212:in `instrument'
actionview (8.0.3) lib/action_view/template.rb:583:in `instrument_render_template'
actionview (8.0.3) lib/action_view/template.rb:272:in `render'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:66:in `block (2 levels) in render_template'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:60:in `block in render_template'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:76:in `block in render_with_layout'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:75:in `render_with_layout'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:59:in `render_template'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:11:in `render'
actionview (8.0.3) lib/action_view/renderer/renderer.rb:58:in `render_template_to_object'
actionview (8.0.3) lib/action_view/renderer/renderer.rb:31:in `render_to_object'
actionview (8.0.3) lib/action_view/rendering.rb:136:in `block in _render_template'
actionview (8.0.3) lib/action_view/base.rb:305:in `in_rendering_context'
actionview (8.0.3) lib/action_view/rendering.rb:135:in `_render_template'
actionpack (8.0.3) lib/action_controller/metal/streaming.rb:179:in `_render_template'
actionview (8.0.3) lib/action_view/rendering.rb:122:in `render_to_body'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:186:in `render_to_body'
actionpack (8.0.3) lib/action_controller/metal/renderers.rb:140:in `render_to_body'
actionpack (8.0.3) lib/abstract_controller/rendering.rb:28:in `render'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:167:in `render'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:31:in `block (2 levels) in render'
activesupport (8.0.3) lib/active_support/benchmark.rb:17:in `realtime'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:31:in `block in render'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:100:in `cleanup_view_runtime'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:46:in `cleanup_view_runtime'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:30:in `render'
/home/micah/work/adva/lib/rails_ext/action_controller/render_with_error_proc.rb:24:in `block in render'
/home/micah/work/adva/lib/rails_ext/action_controller/render_with_error_proc.rb:39:in `with_error_proc'
/home/micah/work/adva/lib/rails_ext/action_controller/render_with_error_proc.rb:23:in `render'
actionpack (8.0.3) lib/action_controller/metal/implicit_render.rb:39:in `default_render'
actionpack (8.0.3) lib/action_controller/metal/basic_implicit_render.rb:9:in `send_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:215:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:193:in `process_action'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:261:in `block in process_action'
activesupport (8.0.3) lib/active_support/callbacks.rb:120:in `block in run_callbacks'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/controller.rb:8:in `write_flash_to_cookie'
activesupport (8.0.3) lib/active_support/callbacks.rb:129:in `block in run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:140:in `run_callbacks'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:76:in `block in process_action'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:75:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:152:in `process'
actionview (8.0.3) lib/action_view/rendering.rb:40:in `process'
actionpack (8.0.3) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (8.0.3) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:908:in `call'
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:60:in `call'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/middleware.rb:8:in `call'
rack (3.2.1) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.2.1) lib/rack/etag.rb:29:in `call'
rack (3.2.1) lib/rack/conditional_get.rb:31:in `call'
rack (3.2.1) lib/rack/head.rb:15:in `call'
actionpack (8.0.3) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (8.0.3) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/cookies.rb:706:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (8.0.3) lib/active_support/callbacks.rb:100:in `run_callbacks'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (8.0.3) lib/rails/rack/logger.rb:41:in `call_app'
railties (8.0.3) lib/rails/rack/logger.rb:29:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/request_id.rb:34:in `call'
rack (3.2.1) lib/rack/method_override.rb:28:in `call'
rack (3.2.1) lib/rack/runtime.rb:24:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.2.1) lib/rack/sendfile.rb:114:in `call'
railties (8.0.3) lib/rails/engine.rb:535:in `call'
rack-test (2.2.0) lib/rack/test.rb:360:in `process_request'
rack-test (2.2.0) lib/rack/test.rb:153:in `request'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:297:in `process'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:19:in `get'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:388:in `get'
/home/micah/work/adva_comments/spec/requests/admin/comments_spec.rb:32:in `block (3 levels) in <top (required)>'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `block in run'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-rails (7.1.1) lib/rspec/rails/adapters.rb:75:in `block (2 levels) in <module:MinitestLifecycleAdapter>'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:390:in `execute_with'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `run'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:259:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:653:in `block in run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:614:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `map'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/configuration.rb:2097:in `with_suite_hooks'
rspec-core (3.13.5) lib/rspec/core/runner.rb:116:in `block in run_specs'
rspec-core (3.13.5) lib/rspec/core/reporter.rb:74:in `report'
rspec-core (3.13.5) lib/rspec/core/runner.rb:115:in `run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:89:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:71:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:45:in `invoke'
rspec-core (3.13.5) exe/rspec:4:in `<top (required)>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `load'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `<main>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `eval'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `<main>'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started PUT "/admin/comments/1" for 127.0.0.1 at 2025-09-28 19:31:15 -0400
Processing by Admin::CommentsController#update as HTML
  Parameters: {"comment"=>{"body"=>"updated comment body"}, "id"=>"1"}
Can't verify CSRF token authenticity.
Completed 422 Unprocessable Content in 0ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  
ActionController::InvalidAuthenticityToken (Can't verify CSRF token authenticity.):
  
actionpack (8.0.3) lib/action_controller/metal/request_forgery_protection.rb:314:in `handle_unverified_request'
actionpack (8.0.3) lib/action_controller/metal/request_forgery_protection.rb:408:in `handle_unverified_request'
actionpack (8.0.3) lib/action_controller/metal/request_forgery_protection.rb:397:in `verify_authenticity_token'
activesupport (8.0.3) lib/active_support/callbacks.rb:361:in `block in make_lambda'
activesupport (8.0.3) lib/active_support/callbacks.rb:178:in `block in call'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:34:in `block (2 levels) in <module:Callbacks>'
activesupport (8.0.3) lib/active_support/callbacks.rb:179:in `call'
activesupport (8.0.3) lib/active_support/callbacks.rb:559:in `block in invoke_before'
activesupport (8.0.3) lib/active_support/callbacks.rb:559:in `each'
activesupport (8.0.3) lib/active_support/callbacks.rb:559:in `invoke_before'
activesupport (8.0.3) lib/active_support/callbacks.rb:118:in `block in run_callbacks'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/controller.rb:8:in `write_flash_to_cookie'
activesupport (8.0.3) lib/active_support/callbacks.rb:129:in `block in run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:140:in `run_callbacks'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:76:in `block in process_action'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:75:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:152:in `process'
actionview (8.0.3) lib/action_view/rendering.rb:40:in `process'
actionpack (8.0.3) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (8.0.3) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:908:in `call'
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:60:in `call'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/middleware.rb:8:in `call'
rack (3.2.1) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.2.1) lib/rack/etag.rb:29:in `call'
rack (3.2.1) lib/rack/conditional_get.rb:44:in `call'
rack (3.2.1) lib/rack/head.rb:15:in `call'
actionpack (8.0.3) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (8.0.3) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/cookies.rb:706:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (8.0.3) lib/active_support/callbacks.rb:100:in `run_callbacks'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (8.0.3) lib/rails/rack/logger.rb:41:in `call_app'
railties (8.0.3) lib/rails/rack/logger.rb:29:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/request_id.rb:34:in `call'
rack (3.2.1) lib/rack/method_override.rb:28:in `call'
rack (3.2.1) lib/rack/runtime.rb:24:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.2.1) lib/rack/sendfile.rb:114:in `call'
railties (8.0.3) lib/rails/engine.rb:535:in `call'
rack-test (2.2.0) lib/rack/test.rb:360:in `process_request'
rack-test (2.2.0) lib/rack/test.rb:153:in `request'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:297:in `process'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:37:in `put'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:388:in `put'
/home/micah/work/adva_comments/spec/requests/admin/comments_spec.rb:39:in `block (3 levels) in <top (required)>'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `block in run'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-rails (7.1.1) lib/rspec/rails/adapters.rb:75:in `block (2 levels) in <module:MinitestLifecycleAdapter>'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:390:in `execute_with'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `run'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:259:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:653:in `block in run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:614:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `map'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/configuration.rb:2097:in `with_suite_hooks'
rspec-core (3.13.5) lib/rspec/core/runner.rb:116:in `block in run_specs'
rspec-core (3.13.5) lib/rspec/core/reporter.rb:74:in `report'
rspec-core (3.13.5) lib/rspec/core/runner.rb:115:in `run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:89:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:71:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:45:in `invoke'
rspec-core (3.13.5) exe/rspec:4:in `<top (required)>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `load'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `<main>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `eval'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `<main>'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.8ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started DELETE "/admin/comments/1" for 127.0.0.1 at 2025-09-28 19:31:15 -0400
Processing by Admin::CommentsController#destroy as HTML
  Parameters: {"id"=>"1"}
Can't verify CSRF token authenticity.
Completed 422 Unprocessable Content in 0ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  
ActionController::InvalidAuthenticityToken (Can't verify CSRF token authenticity.):
  
actionpack (8.0.3) lib/action_controller/metal/request_forgery_protection.rb:314:in `handle_unverified_request'
actionpack (8.0.3) lib/action_controller/metal/request_forgery_protection.rb:408:in `handle_unverified_request'
actionpack (8.0.3) lib/action_controller/metal/request_forgery_protection.rb:397:in `verify_authenticity_token'
activesupport (8.0.3) lib/active_support/callbacks.rb:361:in `block in make_lambda'
activesupport (8.0.3) lib/active_support/callbacks.rb:178:in `block in call'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:34:in `block (2 levels) in <module:Callbacks>'
activesupport (8.0.3) lib/active_support/callbacks.rb:179:in `call'
activesupport (8.0.3) lib/active_support/callbacks.rb:559:in `block in invoke_before'
activesupport (8.0.3) lib/active_support/callbacks.rb:559:in `each'
activesupport (8.0.3) lib/active_support/callbacks.rb:559:in `invoke_before'
activesupport (8.0.3) lib/active_support/callbacks.rb:118:in `block in run_callbacks'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/controller.rb:8:in `write_flash_to_cookie'
activesupport (8.0.3) lib/active_support/callbacks.rb:129:in `block in run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:140:in `run_callbacks'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:76:in `block in process_action'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:75:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:152:in `process'
actionview (8.0.3) lib/action_view/rendering.rb:40:in `process'
actionpack (8.0.3) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (8.0.3) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:908:in `call'
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:60:in `call'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/middleware.rb:8:in `call'
rack (3.2.1) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.2.1) lib/rack/etag.rb:29:in `call'
rack (3.2.1) lib/rack/conditional_get.rb:44:in `call'
rack (3.2.1) lib/rack/head.rb:15:in `call'
actionpack (8.0.3) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (8.0.3) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/cookies.rb:706:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (8.0.3) lib/active_support/callbacks.rb:100:in `run_callbacks'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (8.0.3) lib/rails/rack/logger.rb:41:in `call_app'
railties (8.0.3) lib/rails/rack/logger.rb:29:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/request_id.rb:34:in `call'
rack (3.2.1) lib/rack/method_override.rb:28:in `call'
rack (3.2.1) lib/rack/runtime.rb:24:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.2.1) lib/rack/sendfile.rb:114:in `call'
railties (8.0.3) lib/rails/engine.rb:535:in `call'
rack-test (2.2.0) lib/rack/test.rb:360:in `process_request'
rack-test (2.2.0) lib/rack/test.rb:153:in `request'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:297:in `process'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:43:in `delete'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:388:in `delete'
/home/micah/work/adva_comments/spec/requests/admin/comments_spec.rb:48:in `block (3 levels) in <top (required)>'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `block in run'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-rails (7.1.1) lib/rspec/rails/adapters.rb:75:in `block (2 levels) in <module:MinitestLifecycleAdapter>'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:390:in `execute_with'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `run'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:259:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:653:in `block in run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:614:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `map'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/configuration.rb:2097:in `with_suite_hooks'
rspec-core (3.13.5) lib/rspec/core/runner.rb:116:in `block in run_specs'
rspec-core (3.13.5) lib/rspec/core/reporter.rb:74:in `report'
rspec-core (3.13.5) lib/rspec/core/runner.rb:115:in `run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:89:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:71:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:45:in `invoke'
rspec-core (3.13.5) exe/rspec:4:in `<top (required)>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `load'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `<main>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `eval'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `<main>'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments/preview" for 127.0.0.1 at 2025-09-28 19:31:15 -0400
Processing by CommentsController#preview as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"Previewer", "author_email"=>"preview@example.com", "body"=>"Hello preview"}}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
  Rendering /home/micah/work/adva_comments/app/views/comments/preview.html.erb
  Rendered /home/micah/work/adva_comments/app/views/comments/preview.html.erb (Duration: 0.2ms | GC: 0.0ms)
Completed 200 OK in 8ms (Views: 1.1ms | ActiveRecord: 0.5ms (6 queries, 0 cached) | GC: 0.6ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments" for 127.0.0.1 at 2025-09-28 19:31:15 -0400
Processing by CommentsController#create as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"New Author", "author_email"=>"new@example.com", "body"=>"New comment body"}}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
[Invisible Captcha] Potential spam detected for IP 127.0.0.1. Timestamp not found in session.
Redirected to http://test-site.com/ref
Filter chain halted as #<Proc:0x000072fcb7161aa8 /home/micah/.rvm/gems/ruby-3.3.4/gems/invisible_captcha-2.3.0/lib/invisible_captcha/controller_ext.rb:12> rendered or redirected
Completed 302 Found in 3ms (ActiveRecord: 0.3ms (6 queries, 0 cached) | GC: 0.1ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started PUT "/comments/1" for 127.0.0.1 at 2025-09-28 19:31:15 -0400
Processing by CommentsController#update as HTML
  Parameters: {"comment"=>{"body"=>"updated body"}, "id"=>"1"}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Can't verify CSRF token authenticity.
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[Invisible Captcha] Potential spam detected for IP 127.0.0.1. Timestamp not found in session.
Redirected to http://test-site.com/ref
Filter chain halted as #<Proc:0x000072fcb7161aa8 /home/micah/.rvm/gems/ruby-3.3.4/gems/invisible_captcha-2.3.0/lib/invisible_captcha/controller_ext.rb:12> rendered or redirected
Completed 302 Found in 2ms (ActiveRecord: 0.3ms (5 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started DELETE "/comments/1" for 127.0.0.1 at 2025-09-28 19:31:15 -0400
Processing by CommentsController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Can't verify CSRF token authenticity.
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[36mContent Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 3]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 2]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.0ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 4]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/
Completed 302 Found in 9ms (ActiveRecord: 0.9ms (20 queries, 0 cached) | GC: 0.1ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (6.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "counters"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "counters" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "owner_type" varchar, "owner_id" integer, "name" varchar(25), "count" integer DEFAULT 0)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_counters_on_owner" ON "counters" ("owner_type", "owner_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.2ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:32:20.101203"], ["updated_at", "2025-09-28 23:32:20.101203"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:32:20.113386"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:32:20.114468"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:32:20.117215"], ["created_at", "2025-09-28 23:32:20.121658"], ["updated_at", "2025-09-28 23:32:20.121658"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:32:20.143905"], ["updated_at", "2025-09-28 23:32:20.143905"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:32:20.145718"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:32:20.194426"], ["updated_at", "2025-09-28 23:32:20.194426"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:32:20.222114"], ["id", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:32:20.222705"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started PUT "/admin/comments/1" for 127.0.0.1 at 2025-09-28 19:32:20 -0400
Processing by Admin::CommentsController#update as HTML
  Parameters: {"comment"=>{"body"=>"updated comment body"}, "id"=>"1"}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.2ms (3 queries, 0 cached) | GC: 0.0ms)
  
ActiveModel::ForbiddenAttributesError (ActiveModel::ForbiddenAttributesError):
  
activemodel (8.0.3) lib/active_model/forbidden_attributes_protection.rb:25:in `sanitize_for_mass_assignment'
activemodel (8.0.3) lib/active_model/attribute_assignment.rb:34:in `assign_attributes'
activerecord (8.0.3) lib/active_record/persistence.rb:567:in `block in update'
activerecord (8.0.3) lib/active_record/transactions.rb:417:in `block (2 levels) in with_transaction_returning_status'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/transaction.rb:626:in `block in within_new_transaction'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:23:in `handle_interrupt'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:23:in `block in synchronize'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:19:in `handle_interrupt'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:19:in `synchronize'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/transaction.rb:623:in `within_new_transaction'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/database_statements.rb:367:in `within_new_transaction'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/database_statements.rb:359:in `transaction'
activerecord (8.0.3) lib/active_record/transactions.rb:413:in `block in with_transaction_returning_status'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/connection_pool.rb:416:in `with_connection'
activerecord (8.0.3) lib/active_record/connection_handling.rb:310:in `with_connection'
activerecord (8.0.3) lib/active_record/transactions.rb:409:in `with_transaction_returning_status'
activerecord (8.0.3) lib/active_record/persistence.rb:566:in `update'
/home/micah/work/adva_comments/app/controllers/admin/comments_controller.rb:21:in `update'
actionpack (8.0.3) lib/action_controller/metal/basic_implicit_render.rb:8:in `send_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:215:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:193:in `process_action'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:261:in `block in process_action'
activesupport (8.0.3) lib/active_support/callbacks.rb:120:in `block in run_callbacks'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/controller.rb:8:in `write_flash_to_cookie'
activesupport (8.0.3) lib/active_support/callbacks.rb:129:in `block in run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:140:in `run_callbacks'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:76:in `block in process_action'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:75:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:152:in `process'
actionview (8.0.3) lib/action_view/rendering.rb:40:in `process'
actionpack (8.0.3) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (8.0.3) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:908:in `call'
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:60:in `call'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/middleware.rb:8:in `call'
rack (3.2.1) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.2.1) lib/rack/etag.rb:29:in `call'
rack (3.2.1) lib/rack/conditional_get.rb:44:in `call'
rack (3.2.1) lib/rack/head.rb:15:in `call'
actionpack (8.0.3) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (8.0.3) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/cookies.rb:706:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (8.0.3) lib/active_support/callbacks.rb:100:in `run_callbacks'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (8.0.3) lib/rails/rack/logger.rb:41:in `call_app'
railties (8.0.3) lib/rails/rack/logger.rb:29:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/request_id.rb:34:in `call'
rack (3.2.1) lib/rack/method_override.rb:28:in `call'
rack (3.2.1) lib/rack/runtime.rb:24:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.2.1) lib/rack/sendfile.rb:114:in `call'
railties (8.0.3) lib/rails/engine.rb:535:in `call'
rack-test (2.2.0) lib/rack/test.rb:360:in `process_request'
rack-test (2.2.0) lib/rack/test.rb:153:in `request'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:297:in `process'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:37:in `put'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:388:in `put'
/home/micah/work/adva_comments/spec/requests/admin/comments_spec.rb:26:in `block (3 levels) in <top (required)>'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `block in run'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-rails (7.1.1) lib/rspec/rails/adapters.rb:75:in `block (2 levels) in <module:MinitestLifecycleAdapter>'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:390:in `execute_with'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `run'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:259:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:653:in `block in run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:614:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `map'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/configuration.rb:2097:in `with_suite_hooks'
rspec-core (3.13.5) lib/rspec/core/runner.rb:116:in `block in run_specs'
rspec-core (3.13.5) lib/rspec/core/reporter.rb:74:in `report'
rspec-core (3.13.5) lib/rspec/core/runner.rb:115:in `run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:89:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:71:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:45:in `invoke'
rspec-core (3.13.5) exe/rspec:4:in `<top (required)>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `load'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `<main>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `eval'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `<main>'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started DELETE "/admin/comments/1" for 127.0.0.1 at 2025-09-28 19:32:20 -0400
Processing by Admin::CommentsController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.2ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.1ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 3]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 2]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.6ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.1ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 4]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/admin/comments
Completed 302 Found in 22ms (ActiveRecord: 1.7ms (18 queries, 0 cached) | GC: 8.9ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments/preview" for 127.0.0.1 at 2025-09-28 19:32:20 -0400
Processing by CommentsController#preview as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"Previewer", "author_email"=>"preview@example.com", "body"=>"Hello preview"}}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
  Rendering /home/micah/work/adva_comments/app/views/comments/preview.html.erb
  Rendered /home/micah/work/adva_comments/app/views/comments/preview.html.erb (Duration: 0.2ms | GC: 0.0ms)
Completed 200 OK in 8ms (Views: 1.4ms | ActiveRecord: 0.6ms (6 queries, 0 cached) | GC: 0.6ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.3ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments" for 127.0.0.1 at 2025-09-28 19:32:20 -0400
Processing by CommentsController#create as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"New Author", "author_email"=>"new@example.com", "body"=>"New comment body"}}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
[Invisible Captcha] Potential spam detected for IP 127.0.0.1. Timestamp not found in session.
Redirected to http://test-site.com/ref
Filter chain halted as #<Proc:0x00007c6264719b50 /home/micah/.rvm/gems/ruby-3.3.4/gems/invisible_captcha-2.3.0/lib/invisible_captcha/controller_ext.rb:12> rendered or redirected
Completed 302 Found in 4ms (ActiveRecord: 0.4ms (6 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started PUT "/comments/1" for 127.0.0.1 at 2025-09-28 19:32:20 -0400
Processing by CommentsController#update as HTML
  Parameters: {"comment"=>{"body"=>"updated body"}, "id"=>"1"}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[Invisible Captcha] Potential spam detected for IP 127.0.0.1. Timestamp not found in session.
Redirected to http://test-site.com/ref
Filter chain halted as #<Proc:0x00007c6264719b50 /home/micah/.rvm/gems/ruby-3.3.4/gems/invisible_captcha-2.3.0/lib/invisible_captcha/controller_ext.rb:12> rendered or redirected
Completed 302 Found in 3ms (ActiveRecord: 0.3ms (5 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started DELETE "/comments/1" for 127.0.0.1 at 2025-09-28 19:32:20 -0400
Processing by CommentsController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 3]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 2]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 4]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/
Completed 302 Found in 10ms (ActiveRecord: 1.1ms (20 queries, 0 cached) | GC: 0.1ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (7.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "counters"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "counters" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "owner_type" varchar, "owner_id" integer, "name" varchar(25), "count" integer DEFAULT 0)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_counters_on_owner" ON "counters" ("owner_type", "owner_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.1ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:33:15.141148"], ["updated_at", "2025-09-28 23:33:15.141148"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:33:15.152767"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:33:15.153796"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:33:15.156373"], ["created_at", "2025-09-28 23:33:15.160784"], ["updated_at", "2025-09-28 23:33:15.160784"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:33:15.182462"], ["updated_at", "2025-09-28 23:33:15.182462"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:33:15.184282"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:33:15.229939"], ["updated_at", "2025-09-28 23:33:15.229939"]]
  [1m[36mCounter Load (1.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.0ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:33:15.255715"], ["id", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:33:15.256325"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started PUT "/admin/comments/1" for 127.0.0.1 at 2025-09-28 19:33:15 -0400
Processing by Admin::CommentsController#update as HTML
  Parameters: {"comment"=>{"body"=>"updated comment body"}, "id"=>"1"}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mContent Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mComment Update (0.1ms)[0m  [1m[33mUPDATE "comments" SET "body" = ?, "updated_at" = ? WHERE "comments"."id" = ?[0m  [["body", "updated comment body"], ["updated_at", "2025-09-28 23:33:15.375569"], ["id", 1]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:33:15.376255"], ["id", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:33:15.377154"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/admin/comments
Completed 302 Found in 8ms (ActiveRecord: 0.6ms (10 queries, 0 cached) | GC: 0.0ms)
Started GET "/admin/comments" for 127.0.0.1 at 2025-09-28 19:33:15 -0400
Processing by Admin::CommentsController#index as HTML
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  Rendering layout /home/micah/work/adva/app/views/layouts/admin.html.erb
  Rendering /home/micah/work/adva_comments/app/views/admin/comments/index.html.erb within layouts/admin
  [1m[36mComment Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."site_id" = ? AND (commentable_type NOT IN (?))[0m  [["site_id", 1], [nil, "Topic"]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."site_id" = ? AND (commentable_type NOT IN (?)) ORDER BY comments.created_at DESC LIMIT ? OFFSET ?[0m  [["site_id", 1], [nil, "Topic"], ["LIMIT", 25], ["OFFSET", 0]]
  [1m[36mContent Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  Rendered /home/micah/work/adva_comments/app/views/admin/comments/index.html.erb within layouts/admin (Duration: 4.7ms | GC: 0.0ms)
  Rendered layout /home/micah/work/adva/app/views/layouts/admin.html.erb (Duration: 4.9ms | GC: 0.0ms)
Completed 500 Internal Server Error in 9ms (ActiveRecord: 0.3ms (6 queries, 0 cached) | GC: 0.0ms)
  
ActionView::Template::Error (undefined method `section_article_path' for an instance of #<Class:0x000073448e241a58>)
Caused by: NoMethodError (undefined method `section_article_path' for an instance of #<Class:0x000073448e241a58>)

Information for: ActionView::Template::Error (undefined method `section_article_path' for an instance of #<Class:0x000073448e241a58>):
    4:   <% if @comments.present? %>
    5:     <% @comments.each do |comment, i| %>
    6:       <li class="<%= cycle 'alt', '' %>" id="<%= dom_id(comment) %>">
    7:         <h4><%= link_to comment.commentable.title, [comment.commentable.section, comment.commentable] if comment.commentable %></h4>
    8:         <div class="actions">
    9:           <%= comment.approved? ?
   10:             link_to(t(:'adva.comments.links.unapprove'), admin_comment_path(comment, "comment[approved]" => 0, :return_to => request.fullpath), :class => 'text', :method => :put) :
  
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:96:in `method_missing'
actionpack (8.0.3) lib/action_dispatch/routing/polymorphic_routes.rb:242:in `public_send'
actionpack (8.0.3) lib/action_dispatch/routing/polymorphic_routes.rb:242:in `polymorphic_method'
actionpack (8.0.3) lib/action_dispatch/routing/polymorphic_routes.rb:148:in `polymorphic_path'
actionview (8.0.3) lib/action_view/routing_url_for.rb:105:in `url_for'
actionview (8.0.3) lib/action_view/helpers/url_helper.rb:702:in `url_target'
actionview (8.0.3) lib/action_view/helpers/url_helper.rb:204:in `link_to'
/home/micah/work/adva_comments/app/views/admin/comments/index.html.erb:7
activerecord (8.0.3) lib/active_record/relation/delegation.rb:101:in `each'
activerecord (8.0.3) lib/active_record/relation/delegation.rb:101:in `each'
/home/micah/work/adva_comments/app/views/admin/comments/index.html.erb:5
actionview (8.0.3) lib/action_view/base.rb:278:in `public_send'
actionview (8.0.3) lib/action_view/base.rb:278:in `_run'
actionview (8.0.3) lib/action_view/template.rb:284:in `block in render'
activesupport (8.0.3) lib/active_support/notifications.rb:212:in `instrument'
actionview (8.0.3) lib/action_view/template.rb:583:in `instrument_render_template'
actionview (8.0.3) lib/action_view/template.rb:272:in `render'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:66:in `block (2 levels) in render_template'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:60:in `block in render_template'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:76:in `block in render_with_layout'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:75:in `render_with_layout'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:59:in `render_template'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:11:in `render'
actionview (8.0.3) lib/action_view/renderer/renderer.rb:58:in `render_template_to_object'
actionview (8.0.3) lib/action_view/renderer/renderer.rb:31:in `render_to_object'
actionview (8.0.3) lib/action_view/rendering.rb:136:in `block in _render_template'
actionview (8.0.3) lib/action_view/base.rb:305:in `in_rendering_context'
actionview (8.0.3) lib/action_view/rendering.rb:135:in `_render_template'
actionpack (8.0.3) lib/action_controller/metal/streaming.rb:179:in `_render_template'
actionview (8.0.3) lib/action_view/rendering.rb:122:in `render_to_body'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:186:in `render_to_body'
actionpack (8.0.3) lib/action_controller/metal/renderers.rb:140:in `render_to_body'
actionpack (8.0.3) lib/abstract_controller/rendering.rb:28:in `render'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:167:in `render'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:31:in `block (2 levels) in render'
activesupport (8.0.3) lib/active_support/benchmark.rb:17:in `realtime'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:31:in `block in render'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:100:in `cleanup_view_runtime'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:46:in `cleanup_view_runtime'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:30:in `render'
/home/micah/work/adva/lib/rails_ext/action_controller/render_with_error_proc.rb:24:in `block in render'
/home/micah/work/adva/lib/rails_ext/action_controller/render_with_error_proc.rb:39:in `with_error_proc'
/home/micah/work/adva/lib/rails_ext/action_controller/render_with_error_proc.rb:23:in `render'
actionpack (8.0.3) lib/action_controller/metal/implicit_render.rb:39:in `default_render'
actionpack (8.0.3) lib/action_controller/metal/basic_implicit_render.rb:9:in `send_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:215:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:193:in `process_action'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:261:in `block in process_action'
activesupport (8.0.3) lib/active_support/callbacks.rb:120:in `block in run_callbacks'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/controller.rb:8:in `write_flash_to_cookie'
activesupport (8.0.3) lib/active_support/callbacks.rb:129:in `block in run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:140:in `run_callbacks'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:76:in `block in process_action'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:75:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:152:in `process'
actionview (8.0.3) lib/action_view/rendering.rb:40:in `process'
actionpack (8.0.3) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (8.0.3) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:908:in `call'
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:60:in `call'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/middleware.rb:8:in `call'
rack (3.2.1) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.2.1) lib/rack/etag.rb:29:in `call'
rack (3.2.1) lib/rack/conditional_get.rb:31:in `call'
rack (3.2.1) lib/rack/head.rb:15:in `call'
actionpack (8.0.3) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (8.0.3) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/cookies.rb:706:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (8.0.3) lib/active_support/callbacks.rb:100:in `run_callbacks'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (8.0.3) lib/rails/rack/logger.rb:41:in `call_app'
railties (8.0.3) lib/rails/rack/logger.rb:29:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/request_id.rb:34:in `call'
rack (3.2.1) lib/rack/method_override.rb:28:in `call'
rack (3.2.1) lib/rack/runtime.rb:24:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.2.1) lib/rack/sendfile.rb:114:in `call'
railties (8.0.3) lib/rails/engine.rb:535:in `call'
rack-test (2.2.0) lib/rack/test.rb:360:in `process_request'
rack-test (2.2.0) lib/rack/test.rb:153:in `request'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:297:in `process'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:19:in `get'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:79:in `public_send'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:79:in `follow_redirect!'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:388:in `follow_redirect!'
/home/micah/work/adva_comments/spec/requests/admin/comments_spec.rb:28:in `block (3 levels) in <top (required)>'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `block in run'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-rails (7.1.1) lib/rspec/rails/adapters.rb:75:in `block (2 levels) in <module:MinitestLifecycleAdapter>'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:390:in `execute_with'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `run'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:259:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:653:in `block in run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:614:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `map'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/configuration.rb:2097:in `with_suite_hooks'
rspec-core (3.13.5) lib/rspec/core/runner.rb:116:in `block in run_specs'
rspec-core (3.13.5) lib/rspec/core/reporter.rb:74:in `report'
rspec-core (3.13.5) lib/rspec/core/runner.rb:115:in `run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:89:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:71:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:45:in `invoke'
rspec-core (3.13.5) exe/rspec:4:in `<top (required)>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `load'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `<main>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `eval'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `<main>'

Information for cause: NoMethodError (undefined method `section_article_path' for an instance of #<Class:0x000073448e241a58>):
  
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:96:in `method_missing'
actionpack (8.0.3) lib/action_dispatch/routing/polymorphic_routes.rb:242:in `public_send'
actionpack (8.0.3) lib/action_dispatch/routing/polymorphic_routes.rb:242:in `polymorphic_method'
actionpack (8.0.3) lib/action_dispatch/routing/polymorphic_routes.rb:148:in `polymorphic_path'
actionview (8.0.3) lib/action_view/routing_url_for.rb:105:in `url_for'
actionview (8.0.3) lib/action_view/helpers/url_helper.rb:702:in `url_target'
actionview (8.0.3) lib/action_view/helpers/url_helper.rb:204:in `link_to'
/home/micah/work/adva_comments/app/views/admin/comments/index.html.erb:7
activerecord (8.0.3) lib/active_record/relation/delegation.rb:101:in `each'
activerecord (8.0.3) lib/active_record/relation/delegation.rb:101:in `each'
/home/micah/work/adva_comments/app/views/admin/comments/index.html.erb:5
actionview (8.0.3) lib/action_view/base.rb:278:in `public_send'
actionview (8.0.3) lib/action_view/base.rb:278:in `_run'
actionview (8.0.3) lib/action_view/template.rb:284:in `block in render'
activesupport (8.0.3) lib/active_support/notifications.rb:212:in `instrument'
actionview (8.0.3) lib/action_view/template.rb:583:in `instrument_render_template'
actionview (8.0.3) lib/action_view/template.rb:272:in `render'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:66:in `block (2 levels) in render_template'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:60:in `block in render_template'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:76:in `block in render_with_layout'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:75:in `render_with_layout'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:59:in `render_template'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:11:in `render'
actionview (8.0.3) lib/action_view/renderer/renderer.rb:58:in `render_template_to_object'
actionview (8.0.3) lib/action_view/renderer/renderer.rb:31:in `render_to_object'
actionview (8.0.3) lib/action_view/rendering.rb:136:in `block in _render_template'
actionview (8.0.3) lib/action_view/base.rb:305:in `in_rendering_context'
actionview (8.0.3) lib/action_view/rendering.rb:135:in `_render_template'
actionpack (8.0.3) lib/action_controller/metal/streaming.rb:179:in `_render_template'
actionview (8.0.3) lib/action_view/rendering.rb:122:in `render_to_body'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:186:in `render_to_body'
actionpack (8.0.3) lib/action_controller/metal/renderers.rb:140:in `render_to_body'
actionpack (8.0.3) lib/abstract_controller/rendering.rb:28:in `render'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:167:in `render'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:31:in `block (2 levels) in render'
activesupport (8.0.3) lib/active_support/benchmark.rb:17:in `realtime'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:31:in `block in render'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:100:in `cleanup_view_runtime'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:46:in `cleanup_view_runtime'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:30:in `render'
/home/micah/work/adva/lib/rails_ext/action_controller/render_with_error_proc.rb:24:in `block in render'
/home/micah/work/adva/lib/rails_ext/action_controller/render_with_error_proc.rb:39:in `with_error_proc'
/home/micah/work/adva/lib/rails_ext/action_controller/render_with_error_proc.rb:23:in `render'
actionpack (8.0.3) lib/action_controller/metal/implicit_render.rb:39:in `default_render'
actionpack (8.0.3) lib/action_controller/metal/basic_implicit_render.rb:9:in `send_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:215:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:193:in `process_action'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:261:in `block in process_action'
activesupport (8.0.3) lib/active_support/callbacks.rb:120:in `block in run_callbacks'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/controller.rb:8:in `write_flash_to_cookie'
activesupport (8.0.3) lib/active_support/callbacks.rb:129:in `block in run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:140:in `run_callbacks'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:76:in `block in process_action'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:75:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:152:in `process'
actionview (8.0.3) lib/action_view/rendering.rb:40:in `process'
actionpack (8.0.3) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (8.0.3) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:908:in `call'
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:60:in `call'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/middleware.rb:8:in `call'
rack (3.2.1) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.2.1) lib/rack/etag.rb:29:in `call'
rack (3.2.1) lib/rack/conditional_get.rb:31:in `call'
rack (3.2.1) lib/rack/head.rb:15:in `call'
actionpack (8.0.3) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (8.0.3) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/cookies.rb:706:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (8.0.3) lib/active_support/callbacks.rb:100:in `run_callbacks'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (8.0.3) lib/rails/rack/logger.rb:41:in `call_app'
railties (8.0.3) lib/rails/rack/logger.rb:29:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/request_id.rb:34:in `call'
rack (3.2.1) lib/rack/method_override.rb:28:in `call'
rack (3.2.1) lib/rack/runtime.rb:24:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.2.1) lib/rack/sendfile.rb:114:in `call'
railties (8.0.3) lib/rails/engine.rb:535:in `call'
rack-test (2.2.0) lib/rack/test.rb:360:in `process_request'
rack-test (2.2.0) lib/rack/test.rb:153:in `request'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:297:in `process'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:19:in `get'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:79:in `public_send'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:79:in `follow_redirect!'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:388:in `follow_redirect!'
/home/micah/work/adva_comments/spec/requests/admin/comments_spec.rb:28:in `block (3 levels) in <top (required)>'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `block in run'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-rails (7.1.1) lib/rspec/rails/adapters.rb:75:in `block (2 levels) in <module:MinitestLifecycleAdapter>'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:390:in `execute_with'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `run'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:259:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:653:in `block in run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:614:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `map'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/configuration.rb:2097:in `with_suite_hooks'
rspec-core (3.13.5) lib/rspec/core/runner.rb:116:in `block in run_specs'
rspec-core (3.13.5) lib/rspec/core/reporter.rb:74:in `report'
rspec-core (3.13.5) lib/rspec/core/runner.rb:115:in `run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:89:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:71:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:45:in `invoke'
rspec-core (3.13.5) exe/rspec:4:in `<top (required)>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `load'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `<main>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `eval'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `<main>'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started DELETE "/admin/comments/1" for 127.0.0.1 at 2025-09-28 19:33:15 -0400
Processing by Admin::CommentsController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 3]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 2]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 4]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/admin/comments
Completed 302 Found in 9ms (ActiveRecord: 0.9ms (18 queries, 0 cached) | GC: 0.2ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments/preview" for 127.0.0.1 at 2025-09-28 19:33:15 -0400
Processing by CommentsController#preview as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"Previewer", "author_email"=>"preview@example.com", "body"=>"Hello preview"}}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
  Rendering /home/micah/work/adva_comments/app/views/comments/preview.html.erb
  Rendered /home/micah/work/adva_comments/app/views/comments/preview.html.erb (Duration: 0.1ms | GC: 0.0ms)
Completed 200 OK in 5ms (Views: 0.8ms | ActiveRecord: 0.5ms (6 queries, 0 cached) | GC: 0.1ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments" for 127.0.0.1 at 2025-09-28 19:33:15 -0400
Processing by CommentsController#create as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"New Author", "author_email"=>"new@example.com", "body"=>"New comment body"}}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
[Invisible Captcha] Potential spam detected for IP 127.0.0.1. Timestamp not found in session.
Redirected to http://test-site.com/ref
Filter chain halted as #<Proc:0x000073448e3b48e0 /home/micah/.rvm/gems/ruby-3.3.4/gems/invisible_captcha-2.3.0/lib/invisible_captcha/controller_ext.rb:12> rendered or redirected
Completed 302 Found in 3ms (ActiveRecord: 0.3ms (6 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started PUT "/comments/1" for 127.0.0.1 at 2025-09-28 19:33:15 -0400
Processing by CommentsController#update as HTML
  Parameters: {"comment"=>{"body"=>"updated body"}, "id"=>"1"}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.3ms (5 queries, 0 cached) | GC: 0.0ms)
  
NoMethodError (undefined method `site_id' for nil):
  
/home/micah/work/adva_comments/app/controllers/comments_controller.rb:84:in `comment_params'
/home/micah/work/adva_comments/app/controllers/comments_controller.rb:58:in `update'
actionpack (8.0.3) lib/action_controller/metal/basic_implicit_render.rb:8:in `send_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:215:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:193:in `process_action'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:261:in `block in process_action'
activesupport (8.0.3) lib/active_support/callbacks.rb:120:in `block in run_callbacks'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/controller.rb:8:in `write_flash_to_cookie'
activesupport (8.0.3) lib/active_support/callbacks.rb:129:in `block in run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:140:in `run_callbacks'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:76:in `block in process_action'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:75:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:152:in `process'
actionview (8.0.3) lib/action_view/rendering.rb:40:in `process'
actionpack (8.0.3) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (8.0.3) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:908:in `call'
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:60:in `call'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/middleware.rb:8:in `call'
rack (3.2.1) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.2.1) lib/rack/etag.rb:29:in `call'
rack (3.2.1) lib/rack/conditional_get.rb:44:in `call'
rack (3.2.1) lib/rack/head.rb:15:in `call'
actionpack (8.0.3) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (8.0.3) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/cookies.rb:706:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (8.0.3) lib/active_support/callbacks.rb:100:in `run_callbacks'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (8.0.3) lib/rails/rack/logger.rb:41:in `call_app'
railties (8.0.3) lib/rails/rack/logger.rb:29:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/request_id.rb:34:in `call'
rack (3.2.1) lib/rack/method_override.rb:28:in `call'
rack (3.2.1) lib/rack/runtime.rb:24:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.2.1) lib/rack/sendfile.rb:114:in `call'
railties (8.0.3) lib/rails/engine.rb:535:in `call'
rack-test (2.2.0) lib/rack/test.rb:360:in `process_request'
rack-test (2.2.0) lib/rack/test.rb:153:in `request'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:297:in `process'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:37:in `put'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:388:in `put'
/home/micah/work/adva_comments/spec/requests/comments_spec.rb:55:in `block (3 levels) in <top (required)>'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `block in run'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-rails (7.1.1) lib/rspec/rails/adapters.rb:75:in `block (2 levels) in <module:MinitestLifecycleAdapter>'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:390:in `execute_with'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `run'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:259:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:653:in `block in run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:614:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `map'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/configuration.rb:2097:in `with_suite_hooks'
rspec-core (3.13.5) lib/rspec/core/runner.rb:116:in `block in run_specs'
rspec-core (3.13.5) lib/rspec/core/reporter.rb:74:in `report'
rspec-core (3.13.5) lib/rspec/core/runner.rb:115:in `run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:89:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:71:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:45:in `invoke'
rspec-core (3.13.5) exe/rspec:4:in `<top (required)>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `load'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `<main>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `eval'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `<main>'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started DELETE "/comments/1" for 127.0.0.1 at 2025-09-28 19:33:16 -0400
Processing by CommentsController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 3]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 2]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 4]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/
Completed 302 Found in 9ms (ActiveRecord: 1.1ms (20 queries, 0 cached) | GC: 0.1ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (7.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "counters"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "counters" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "owner_type" varchar, "owner_id" integer, "name" varchar(25), "count" integer DEFAULT 0)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_counters_on_owner" ON "counters" ("owner_type", "owner_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.1ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:33:39.686507"], ["updated_at", "2025-09-28 23:33:39.686507"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:33:39.697546"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:33:39.698550"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:33:39.700992"], ["created_at", "2025-09-28 23:33:39.705352"], ["updated_at", "2025-09-28 23:33:39.705352"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:33:39.726938"], ["updated_at", "2025-09-28 23:33:39.726938"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:33:39.728690"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:33:39.775427"], ["updated_at", "2025-09-28 23:33:39.775427"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.0ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:33:39.799769"], ["id", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:33:39.800312"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.2ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started PUT "/admin/comments/1" for 127.0.0.1 at 2025-09-28 19:33:39 -0400
Processing by Admin::CommentsController#update as HTML
  Parameters: {"comment"=>{"body"=>"updated comment body"}, "id"=>"1"}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mContent Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mComment Update (0.0ms)[0m  [1m[33mUPDATE "comments" SET "body" = ?, "updated_at" = ? WHERE "comments"."id" = ?[0m  [["body", "updated comment body"], ["updated_at", "2025-09-28 23:33:39.912241"], ["id", 1]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:33:39.913015"], ["id", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:33:39.913954"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/admin/comments
Completed 302 Found in 10ms (ActiveRecord: 0.7ms (10 queries, 0 cached) | GC: 0.0ms)
Started GET "/admin/comments" for 127.0.0.1 at 2025-09-28 19:33:39 -0400
Processing by Admin::CommentsController#index as HTML
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  Rendering layout /home/micah/work/adva/app/views/layouts/admin.html.erb
  Rendering /home/micah/work/adva_comments/app/views/admin/comments/index.html.erb within layouts/admin
  [1m[36mComment Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."site_id" = ? AND (commentable_type NOT IN (?))[0m  [["site_id", 1], [nil, "Topic"]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."site_id" = ? AND (commentable_type NOT IN (?)) ORDER BY comments.created_at DESC LIMIT ? OFFSET ?[0m  [["site_id", 1], [nil, "Topic"], ["LIMIT", 25], ["OFFSET", 0]]
  [1m[36mContent Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  Rendered /home/micah/work/adva_comments/app/views/admin/comments/index.html.erb within layouts/admin (Duration: 4.6ms | GC: 0.0ms)
  Rendered layout /home/micah/work/adva/app/views/layouts/admin.html.erb (Duration: 4.7ms | GC: 0.0ms)
Completed 500 Internal Server Error in 9ms (ActiveRecord: 0.4ms (6 queries, 0 cached) | GC: 0.0ms)
  
ActionView::Template::Error (undefined method `section_article_path' for an instance of #<Class:0x000070b0e4d90ca0>)
Caused by: NoMethodError (undefined method `section_article_path' for an instance of #<Class:0x000070b0e4d90ca0>)

Information for: ActionView::Template::Error (undefined method `section_article_path' for an instance of #<Class:0x000070b0e4d90ca0>):
    4:   <% if @comments.present? %>
    5:     <% @comments.each do |comment, i| %>
    6:       <li class="<%= cycle 'alt', '' %>" id="<%= dom_id(comment) %>">
    7:         <h4><%= link_to comment.commentable.title, [comment.commentable.section, comment.commentable] if comment.commentable %></h4>
    8:         <div class="actions">
    9:           <%= comment.approved? ?
   10:             link_to(t(:'adva.comments.links.unapprove'), admin_comment_path(comment, "comment[approved]" => 0, :return_to => request.fullpath), :class => 'text', :method => :put) :
  
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:96:in `method_missing'
actionpack (8.0.3) lib/action_dispatch/routing/polymorphic_routes.rb:242:in `public_send'
actionpack (8.0.3) lib/action_dispatch/routing/polymorphic_routes.rb:242:in `polymorphic_method'
actionpack (8.0.3) lib/action_dispatch/routing/polymorphic_routes.rb:148:in `polymorphic_path'
actionview (8.0.3) lib/action_view/routing_url_for.rb:105:in `url_for'
actionview (8.0.3) lib/action_view/helpers/url_helper.rb:702:in `url_target'
actionview (8.0.3) lib/action_view/helpers/url_helper.rb:204:in `link_to'
/home/micah/work/adva_comments/app/views/admin/comments/index.html.erb:7
activerecord (8.0.3) lib/active_record/relation/delegation.rb:101:in `each'
activerecord (8.0.3) lib/active_record/relation/delegation.rb:101:in `each'
/home/micah/work/adva_comments/app/views/admin/comments/index.html.erb:5
actionview (8.0.3) lib/action_view/base.rb:278:in `public_send'
actionview (8.0.3) lib/action_view/base.rb:278:in `_run'
actionview (8.0.3) lib/action_view/template.rb:284:in `block in render'
activesupport (8.0.3) lib/active_support/notifications.rb:212:in `instrument'
actionview (8.0.3) lib/action_view/template.rb:583:in `instrument_render_template'
actionview (8.0.3) lib/action_view/template.rb:272:in `render'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:66:in `block (2 levels) in render_template'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:60:in `block in render_template'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:76:in `block in render_with_layout'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:75:in `render_with_layout'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:59:in `render_template'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:11:in `render'
actionview (8.0.3) lib/action_view/renderer/renderer.rb:58:in `render_template_to_object'
actionview (8.0.3) lib/action_view/renderer/renderer.rb:31:in `render_to_object'
actionview (8.0.3) lib/action_view/rendering.rb:136:in `block in _render_template'
actionview (8.0.3) lib/action_view/base.rb:305:in `in_rendering_context'
actionview (8.0.3) lib/action_view/rendering.rb:135:in `_render_template'
actionpack (8.0.3) lib/action_controller/metal/streaming.rb:179:in `_render_template'
actionview (8.0.3) lib/action_view/rendering.rb:122:in `render_to_body'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:186:in `render_to_body'
actionpack (8.0.3) lib/action_controller/metal/renderers.rb:140:in `render_to_body'
actionpack (8.0.3) lib/abstract_controller/rendering.rb:28:in `render'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:167:in `render'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:31:in `block (2 levels) in render'
activesupport (8.0.3) lib/active_support/benchmark.rb:17:in `realtime'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:31:in `block in render'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:100:in `cleanup_view_runtime'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:46:in `cleanup_view_runtime'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:30:in `render'
/home/micah/work/adva/lib/rails_ext/action_controller/render_with_error_proc.rb:24:in `block in render'
/home/micah/work/adva/lib/rails_ext/action_controller/render_with_error_proc.rb:39:in `with_error_proc'
/home/micah/work/adva/lib/rails_ext/action_controller/render_with_error_proc.rb:23:in `render'
actionpack (8.0.3) lib/action_controller/metal/implicit_render.rb:39:in `default_render'
actionpack (8.0.3) lib/action_controller/metal/basic_implicit_render.rb:9:in `send_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:215:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:193:in `process_action'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:261:in `block in process_action'
activesupport (8.0.3) lib/active_support/callbacks.rb:120:in `block in run_callbacks'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/controller.rb:8:in `write_flash_to_cookie'
activesupport (8.0.3) lib/active_support/callbacks.rb:129:in `block in run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:140:in `run_callbacks'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:76:in `block in process_action'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:75:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:152:in `process'
actionview (8.0.3) lib/action_view/rendering.rb:40:in `process'
actionpack (8.0.3) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (8.0.3) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:908:in `call'
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:60:in `call'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/middleware.rb:8:in `call'
rack (3.2.1) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.2.1) lib/rack/etag.rb:29:in `call'
rack (3.2.1) lib/rack/conditional_get.rb:31:in `call'
rack (3.2.1) lib/rack/head.rb:15:in `call'
actionpack (8.0.3) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (8.0.3) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/cookies.rb:706:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (8.0.3) lib/active_support/callbacks.rb:100:in `run_callbacks'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (8.0.3) lib/rails/rack/logger.rb:41:in `call_app'
railties (8.0.3) lib/rails/rack/logger.rb:29:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/request_id.rb:34:in `call'
rack (3.2.1) lib/rack/method_override.rb:28:in `call'
rack (3.2.1) lib/rack/runtime.rb:24:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.2.1) lib/rack/sendfile.rb:114:in `call'
railties (8.0.3) lib/rails/engine.rb:535:in `call'
rack-test (2.2.0) lib/rack/test.rb:360:in `process_request'
rack-test (2.2.0) lib/rack/test.rb:153:in `request'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:297:in `process'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:19:in `get'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:79:in `public_send'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:79:in `follow_redirect!'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:388:in `follow_redirect!'
/home/micah/work/adva_comments/spec/requests/admin/comments_spec.rb:28:in `block (3 levels) in <top (required)>'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `block in run'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-rails (7.1.1) lib/rspec/rails/adapters.rb:75:in `block (2 levels) in <module:MinitestLifecycleAdapter>'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:390:in `execute_with'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `run'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:259:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:653:in `block in run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:614:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `map'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/configuration.rb:2097:in `with_suite_hooks'
rspec-core (3.13.5) lib/rspec/core/runner.rb:116:in `block in run_specs'
rspec-core (3.13.5) lib/rspec/core/reporter.rb:74:in `report'
rspec-core (3.13.5) lib/rspec/core/runner.rb:115:in `run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:89:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:71:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:45:in `invoke'
rspec-core (3.13.5) exe/rspec:4:in `<top (required)>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `load'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `<main>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `eval'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `<main>'

Information for cause: NoMethodError (undefined method `section_article_path' for an instance of #<Class:0x000070b0e4d90ca0>):
  
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:96:in `method_missing'
actionpack (8.0.3) lib/action_dispatch/routing/polymorphic_routes.rb:242:in `public_send'
actionpack (8.0.3) lib/action_dispatch/routing/polymorphic_routes.rb:242:in `polymorphic_method'
actionpack (8.0.3) lib/action_dispatch/routing/polymorphic_routes.rb:148:in `polymorphic_path'
actionview (8.0.3) lib/action_view/routing_url_for.rb:105:in `url_for'
actionview (8.0.3) lib/action_view/helpers/url_helper.rb:702:in `url_target'
actionview (8.0.3) lib/action_view/helpers/url_helper.rb:204:in `link_to'
/home/micah/work/adva_comments/app/views/admin/comments/index.html.erb:7
activerecord (8.0.3) lib/active_record/relation/delegation.rb:101:in `each'
activerecord (8.0.3) lib/active_record/relation/delegation.rb:101:in `each'
/home/micah/work/adva_comments/app/views/admin/comments/index.html.erb:5
actionview (8.0.3) lib/action_view/base.rb:278:in `public_send'
actionview (8.0.3) lib/action_view/base.rb:278:in `_run'
actionview (8.0.3) lib/action_view/template.rb:284:in `block in render'
activesupport (8.0.3) lib/active_support/notifications.rb:212:in `instrument'
actionview (8.0.3) lib/action_view/template.rb:583:in `instrument_render_template'
actionview (8.0.3) lib/action_view/template.rb:272:in `render'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:66:in `block (2 levels) in render_template'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:60:in `block in render_template'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:76:in `block in render_with_layout'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:75:in `render_with_layout'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:59:in `render_template'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:11:in `render'
actionview (8.0.3) lib/action_view/renderer/renderer.rb:58:in `render_template_to_object'
actionview (8.0.3) lib/action_view/renderer/renderer.rb:31:in `render_to_object'
actionview (8.0.3) lib/action_view/rendering.rb:136:in `block in _render_template'
actionview (8.0.3) lib/action_view/base.rb:305:in `in_rendering_context'
actionview (8.0.3) lib/action_view/rendering.rb:135:in `_render_template'
actionpack (8.0.3) lib/action_controller/metal/streaming.rb:179:in `_render_template'
actionview (8.0.3) lib/action_view/rendering.rb:122:in `render_to_body'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:186:in `render_to_body'
actionpack (8.0.3) lib/action_controller/metal/renderers.rb:140:in `render_to_body'
actionpack (8.0.3) lib/abstract_controller/rendering.rb:28:in `render'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:167:in `render'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:31:in `block (2 levels) in render'
activesupport (8.0.3) lib/active_support/benchmark.rb:17:in `realtime'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:31:in `block in render'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:100:in `cleanup_view_runtime'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:46:in `cleanup_view_runtime'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:30:in `render'
/home/micah/work/adva/lib/rails_ext/action_controller/render_with_error_proc.rb:24:in `block in render'
/home/micah/work/adva/lib/rails_ext/action_controller/render_with_error_proc.rb:39:in `with_error_proc'
/home/micah/work/adva/lib/rails_ext/action_controller/render_with_error_proc.rb:23:in `render'
actionpack (8.0.3) lib/action_controller/metal/implicit_render.rb:39:in `default_render'
actionpack (8.0.3) lib/action_controller/metal/basic_implicit_render.rb:9:in `send_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:215:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:193:in `process_action'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:261:in `block in process_action'
activesupport (8.0.3) lib/active_support/callbacks.rb:120:in `block in run_callbacks'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/controller.rb:8:in `write_flash_to_cookie'
activesupport (8.0.3) lib/active_support/callbacks.rb:129:in `block in run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:140:in `run_callbacks'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:76:in `block in process_action'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:75:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:152:in `process'
actionview (8.0.3) lib/action_view/rendering.rb:40:in `process'
actionpack (8.0.3) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (8.0.3) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:908:in `call'
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:60:in `call'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/middleware.rb:8:in `call'
rack (3.2.1) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.2.1) lib/rack/etag.rb:29:in `call'
rack (3.2.1) lib/rack/conditional_get.rb:31:in `call'
rack (3.2.1) lib/rack/head.rb:15:in `call'
actionpack (8.0.3) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (8.0.3) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/cookies.rb:706:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (8.0.3) lib/active_support/callbacks.rb:100:in `run_callbacks'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (8.0.3) lib/rails/rack/logger.rb:41:in `call_app'
railties (8.0.3) lib/rails/rack/logger.rb:29:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/request_id.rb:34:in `call'
rack (3.2.1) lib/rack/method_override.rb:28:in `call'
rack (3.2.1) lib/rack/runtime.rb:24:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.2.1) lib/rack/sendfile.rb:114:in `call'
railties (8.0.3) lib/rails/engine.rb:535:in `call'
rack-test (2.2.0) lib/rack/test.rb:360:in `process_request'
rack-test (2.2.0) lib/rack/test.rb:153:in `request'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:297:in `process'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:19:in `get'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:79:in `public_send'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:79:in `follow_redirect!'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:388:in `follow_redirect!'
/home/micah/work/adva_comments/spec/requests/admin/comments_spec.rb:28:in `block (3 levels) in <top (required)>'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `block in run'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-rails (7.1.1) lib/rspec/rails/adapters.rb:75:in `block (2 levels) in <module:MinitestLifecycleAdapter>'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:390:in `execute_with'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `run'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:259:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:653:in `block in run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:614:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `map'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/configuration.rb:2097:in `with_suite_hooks'
rspec-core (3.13.5) lib/rspec/core/runner.rb:116:in `block in run_specs'
rspec-core (3.13.5) lib/rspec/core/reporter.rb:74:in `report'
rspec-core (3.13.5) lib/rspec/core/runner.rb:115:in `run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:89:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:71:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:45:in `invoke'
rspec-core (3.13.5) exe/rspec:4:in `<top (required)>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `load'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `<main>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `eval'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `<main>'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started DELETE "/admin/comments/1" for 127.0.0.1 at 2025-09-28 19:33:40 -0400
Processing by Admin::CommentsController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.3ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 3]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 2]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 4]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/admin/comments
Completed 302 Found in 10ms (ActiveRecord: 1.4ms (18 queries, 0 cached) | GC: 0.3ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments/preview" for 127.0.0.1 at 2025-09-28 19:33:40 -0400
Processing by CommentsController#preview as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"Previewer", "author_email"=>"preview@example.com", "body"=>"Hello preview"}}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
  Rendering /home/micah/work/adva_comments/app/views/comments/preview.html.erb
  Rendered /home/micah/work/adva_comments/app/views/comments/preview.html.erb (Duration: 0.1ms | GC: 0.0ms)
Completed 200 OK in 5ms (Views: 0.7ms | ActiveRecord: 0.5ms (6 queries, 0 cached) | GC: 0.1ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments" for 127.0.0.1 at 2025-09-28 19:33:40 -0400
Processing by CommentsController#create as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"New Author", "author_email"=>"new@example.com", "body"=>"New comment body"}}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
[Invisible Captcha] Potential spam detected for IP 127.0.0.1. Timestamp not found in session.
Redirected to http://test-site.com/ref
Filter chain halted as #<Proc:0x000070b0e4f0dbc8 /home/micah/.rvm/gems/ruby-3.3.4/gems/invisible_captcha-2.3.0/lib/invisible_captcha/controller_ext.rb:12> rendered or redirected
Completed 302 Found in 4ms (ActiveRecord: 0.5ms (6 queries, 0 cached) | GC: 0.1ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started PUT "/comments/1" for 127.0.0.1 at 2025-09-28 19:33:40 -0400
Processing by CommentsController#update as HTML
  Parameters: {"comment"=>{"body"=>"updated body"}, "id"=>"1"}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.3ms (5 queries, 0 cached) | GC: 0.1ms)
  
NoMethodError (undefined method `site_id' for nil):
  
/home/micah/work/adva_comments/app/controllers/comments_controller.rb:84:in `comment_params'
/home/micah/work/adva_comments/app/controllers/comments_controller.rb:58:in `update'
actionpack (8.0.3) lib/action_controller/metal/basic_implicit_render.rb:8:in `send_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:215:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:193:in `process_action'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:261:in `block in process_action'
activesupport (8.0.3) lib/active_support/callbacks.rb:120:in `block in run_callbacks'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/controller.rb:8:in `write_flash_to_cookie'
activesupport (8.0.3) lib/active_support/callbacks.rb:129:in `block in run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:140:in `run_callbacks'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:76:in `block in process_action'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:75:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:152:in `process'
actionview (8.0.3) lib/action_view/rendering.rb:40:in `process'
actionpack (8.0.3) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (8.0.3) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:908:in `call'
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:60:in `call'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/middleware.rb:8:in `call'
rack (3.2.1) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.2.1) lib/rack/etag.rb:29:in `call'
rack (3.2.1) lib/rack/conditional_get.rb:44:in `call'
rack (3.2.1) lib/rack/head.rb:15:in `call'
actionpack (8.0.3) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (8.0.3) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/cookies.rb:706:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (8.0.3) lib/active_support/callbacks.rb:100:in `run_callbacks'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (8.0.3) lib/rails/rack/logger.rb:41:in `call_app'
railties (8.0.3) lib/rails/rack/logger.rb:29:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/request_id.rb:34:in `call'
rack (3.2.1) lib/rack/method_override.rb:28:in `call'
rack (3.2.1) lib/rack/runtime.rb:24:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.2.1) lib/rack/sendfile.rb:114:in `call'
railties (8.0.3) lib/rails/engine.rb:535:in `call'
rack-test (2.2.0) lib/rack/test.rb:360:in `process_request'
rack-test (2.2.0) lib/rack/test.rb:153:in `request'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:297:in `process'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:37:in `put'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:388:in `put'
/home/micah/work/adva_comments/spec/requests/comments_spec.rb:55:in `block (3 levels) in <top (required)>'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `block in run'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-rails (7.1.1) lib/rspec/rails/adapters.rb:75:in `block (2 levels) in <module:MinitestLifecycleAdapter>'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:390:in `execute_with'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `run'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:259:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:653:in `block in run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:614:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `map'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/configuration.rb:2097:in `with_suite_hooks'
rspec-core (3.13.5) lib/rspec/core/runner.rb:116:in `block in run_specs'
rspec-core (3.13.5) lib/rspec/core/reporter.rb:74:in `report'
rspec-core (3.13.5) lib/rspec/core/runner.rb:115:in `run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:89:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:71:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:45:in `invoke'
rspec-core (3.13.5) exe/rspec:4:in `<top (required)>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `load'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `<main>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `eval'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `<main>'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started DELETE "/comments/1" for 127.0.0.1 at 2025-09-28 19:33:40 -0400
Processing by CommentsController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 3]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 2]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 4]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/
Completed 302 Found in 9ms (ActiveRecord: 1.1ms (20 queries, 0 cached) | GC: 0.1ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (59.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "counters"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "counters" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "owner_type" varchar, "owner_id" integer, "name" varchar(25), "count" integer DEFAULT 0)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_counters_on_owner" ON "counters" ("owner_type", "owner_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.1ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:34:00.805172"], ["updated_at", "2025-09-28 23:34:00.805172"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:34:00.815787"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:34:00.816777"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:34:00.819276"], ["created_at", "2025-09-28 23:34:00.823631"], ["updated_at", "2025-09-28 23:34:00.823631"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:34:00.845572"], ["updated_at", "2025-09-28 23:34:00.845572"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:34:00.847500"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:34:00.885263"], ["updated_at", "2025-09-28 23:34:00.885263"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.0ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:34:00.893693"], ["id", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:34:00.894216"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started PUT "/admin/comments/1" for 127.0.0.1 at 2025-09-28 19:34:00 -0400
Processing by Admin::CommentsController#update as HTML
  Parameters: {"comment"=>{"body"=>"updated comment body"}, "id"=>"1"}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mContent Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mComment Update (0.0ms)[0m  [1m[33mUPDATE "comments" SET "body" = ?, "updated_at" = ? WHERE "comments"."id" = ?[0m  [["body", "updated comment body"], ["updated_at", "2025-09-28 23:34:01.010801"], ["id", 1]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:34:01.011465"], ["id", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:34:01.012394"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/admin/comments
Completed 302 Found in 8ms (ActiveRecord: 0.6ms (10 queries, 0 cached) | GC: 0.0ms)
Started GET "/admin/comments" for 127.0.0.1 at 2025-09-28 19:34:01 -0400
Processing by Admin::CommentsController#index as HTML
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  Rendering layout /home/micah/work/adva/app/views/layouts/admin.html.erb
  Rendering /home/micah/work/adva_comments/app/views/admin/comments/index.html.erb within layouts/admin
  [1m[36mComment Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."site_id" = ? AND (commentable_type NOT IN (?))[0m  [["site_id", 1], [nil, "Topic"]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."site_id" = ? AND (commentable_type NOT IN (?)) ORDER BY comments.created_at DESC LIMIT ? OFFSET ?[0m  [["site_id", 1], [nil, "Topic"], ["LIMIT", 25], ["OFFSET", 0]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  Rendered /home/micah/work/adva_comments/app/views/admin/comments/index.html.erb within layouts/admin (Duration: 5.5ms | GC: 0.3ms)
  Rendered layout /home/micah/work/adva/app/views/layouts/admin.html.erb (Duration: 5.6ms | GC: 0.3ms)
Completed 500 Internal Server Error in 18ms (ActiveRecord: 0.4ms (6 queries, 0 cached) | GC: 7.5ms)
  
ActionView::Template::Error (undefined method `section_article_path' for an instance of #<Class:0x00007f8dbf2bece8>)
Caused by: NoMethodError (undefined method `section_article_path' for an instance of #<Class:0x00007f8dbf2bece8>)

Information for: ActionView::Template::Error (undefined method `section_article_path' for an instance of #<Class:0x00007f8dbf2bece8>):
    4:   <% if @comments.present? %>
    5:     <% @comments.each do |comment, i| %>
    6:       <li class="<%= cycle 'alt', '' %>" id="<%= dom_id(comment) %>">
    7:         <h4><%= link_to comment.commentable.title, [comment.commentable.section, comment.commentable] if comment.commentable %></h4>
    8:         <div class="actions">
    9:           <%= comment.approved? ?
   10:             link_to(t(:'adva.comments.links.unapprove'), admin_comment_path(comment, "comment[approved]" => 0, :return_to => request.fullpath), :class => 'text', :method => :put) :
  
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:96:in `method_missing'
actionpack (8.0.3) lib/action_dispatch/routing/polymorphic_routes.rb:242:in `public_send'
actionpack (8.0.3) lib/action_dispatch/routing/polymorphic_routes.rb:242:in `polymorphic_method'
actionpack (8.0.3) lib/action_dispatch/routing/polymorphic_routes.rb:148:in `polymorphic_path'
actionview (8.0.3) lib/action_view/routing_url_for.rb:105:in `url_for'
actionview (8.0.3) lib/action_view/helpers/url_helper.rb:702:in `url_target'
actionview (8.0.3) lib/action_view/helpers/url_helper.rb:204:in `link_to'
/home/micah/work/adva_comments/app/views/admin/comments/index.html.erb:7
activerecord (8.0.3) lib/active_record/relation/delegation.rb:101:in `each'
activerecord (8.0.3) lib/active_record/relation/delegation.rb:101:in `each'
/home/micah/work/adva_comments/app/views/admin/comments/index.html.erb:5
actionview (8.0.3) lib/action_view/base.rb:278:in `public_send'
actionview (8.0.3) lib/action_view/base.rb:278:in `_run'
actionview (8.0.3) lib/action_view/template.rb:284:in `block in render'
activesupport (8.0.3) lib/active_support/notifications.rb:212:in `instrument'
actionview (8.0.3) lib/action_view/template.rb:583:in `instrument_render_template'
actionview (8.0.3) lib/action_view/template.rb:272:in `render'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:66:in `block (2 levels) in render_template'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:60:in `block in render_template'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:76:in `block in render_with_layout'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:75:in `render_with_layout'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:59:in `render_template'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:11:in `render'
actionview (8.0.3) lib/action_view/renderer/renderer.rb:58:in `render_template_to_object'
actionview (8.0.3) lib/action_view/renderer/renderer.rb:31:in `render_to_object'
actionview (8.0.3) lib/action_view/rendering.rb:136:in `block in _render_template'
actionview (8.0.3) lib/action_view/base.rb:305:in `in_rendering_context'
actionview (8.0.3) lib/action_view/rendering.rb:135:in `_render_template'
actionpack (8.0.3) lib/action_controller/metal/streaming.rb:179:in `_render_template'
actionview (8.0.3) lib/action_view/rendering.rb:122:in `render_to_body'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:186:in `render_to_body'
actionpack (8.0.3) lib/action_controller/metal/renderers.rb:140:in `render_to_body'
actionpack (8.0.3) lib/abstract_controller/rendering.rb:28:in `render'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:167:in `render'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:31:in `block (2 levels) in render'
activesupport (8.0.3) lib/active_support/benchmark.rb:17:in `realtime'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:31:in `block in render'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:100:in `cleanup_view_runtime'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:46:in `cleanup_view_runtime'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:30:in `render'
/home/micah/work/adva/lib/rails_ext/action_controller/render_with_error_proc.rb:24:in `block in render'
/home/micah/work/adva/lib/rails_ext/action_controller/render_with_error_proc.rb:39:in `with_error_proc'
/home/micah/work/adva/lib/rails_ext/action_controller/render_with_error_proc.rb:23:in `render'
actionpack (8.0.3) lib/action_controller/metal/implicit_render.rb:39:in `default_render'
actionpack (8.0.3) lib/action_controller/metal/basic_implicit_render.rb:9:in `send_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:215:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:193:in `process_action'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:261:in `block in process_action'
activesupport (8.0.3) lib/active_support/callbacks.rb:120:in `block in run_callbacks'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/controller.rb:8:in `write_flash_to_cookie'
activesupport (8.0.3) lib/active_support/callbacks.rb:129:in `block in run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:140:in `run_callbacks'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:76:in `block in process_action'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:75:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:152:in `process'
actionview (8.0.3) lib/action_view/rendering.rb:40:in `process'
actionpack (8.0.3) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (8.0.3) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:908:in `call'
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:60:in `call'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/middleware.rb:8:in `call'
rack (3.2.1) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.2.1) lib/rack/etag.rb:29:in `call'
rack (3.2.1) lib/rack/conditional_get.rb:31:in `call'
rack (3.2.1) lib/rack/head.rb:15:in `call'
actionpack (8.0.3) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (8.0.3) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/cookies.rb:706:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (8.0.3) lib/active_support/callbacks.rb:100:in `run_callbacks'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (8.0.3) lib/rails/rack/logger.rb:41:in `call_app'
railties (8.0.3) lib/rails/rack/logger.rb:29:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/request_id.rb:34:in `call'
rack (3.2.1) lib/rack/method_override.rb:28:in `call'
rack (3.2.1) lib/rack/runtime.rb:24:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.2.1) lib/rack/sendfile.rb:114:in `call'
railties (8.0.3) lib/rails/engine.rb:535:in `call'
rack-test (2.2.0) lib/rack/test.rb:360:in `process_request'
rack-test (2.2.0) lib/rack/test.rb:153:in `request'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:297:in `process'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:19:in `get'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:79:in `public_send'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:79:in `follow_redirect!'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:388:in `follow_redirect!'
/home/micah/work/adva_comments/spec/requests/admin/comments_spec.rb:28:in `block (3 levels) in <top (required)>'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `block in run'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-rails (7.1.1) lib/rspec/rails/adapters.rb:75:in `block (2 levels) in <module:MinitestLifecycleAdapter>'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:390:in `execute_with'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `run'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:259:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:653:in `block in run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:614:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `map'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/configuration.rb:2097:in `with_suite_hooks'
rspec-core (3.13.5) lib/rspec/core/runner.rb:116:in `block in run_specs'
rspec-core (3.13.5) lib/rspec/core/reporter.rb:74:in `report'
rspec-core (3.13.5) lib/rspec/core/runner.rb:115:in `run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:89:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:71:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:45:in `invoke'
rspec-core (3.13.5) exe/rspec:4:in `<top (required)>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `load'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `<main>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `eval'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `<main>'

Information for cause: NoMethodError (undefined method `section_article_path' for an instance of #<Class:0x00007f8dbf2bece8>):
  
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:96:in `method_missing'
actionpack (8.0.3) lib/action_dispatch/routing/polymorphic_routes.rb:242:in `public_send'
actionpack (8.0.3) lib/action_dispatch/routing/polymorphic_routes.rb:242:in `polymorphic_method'
actionpack (8.0.3) lib/action_dispatch/routing/polymorphic_routes.rb:148:in `polymorphic_path'
actionview (8.0.3) lib/action_view/routing_url_for.rb:105:in `url_for'
actionview (8.0.3) lib/action_view/helpers/url_helper.rb:702:in `url_target'
actionview (8.0.3) lib/action_view/helpers/url_helper.rb:204:in `link_to'
/home/micah/work/adva_comments/app/views/admin/comments/index.html.erb:7
activerecord (8.0.3) lib/active_record/relation/delegation.rb:101:in `each'
activerecord (8.0.3) lib/active_record/relation/delegation.rb:101:in `each'
/home/micah/work/adva_comments/app/views/admin/comments/index.html.erb:5
actionview (8.0.3) lib/action_view/base.rb:278:in `public_send'
actionview (8.0.3) lib/action_view/base.rb:278:in `_run'
actionview (8.0.3) lib/action_view/template.rb:284:in `block in render'
activesupport (8.0.3) lib/active_support/notifications.rb:212:in `instrument'
actionview (8.0.3) lib/action_view/template.rb:583:in `instrument_render_template'
actionview (8.0.3) lib/action_view/template.rb:272:in `render'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:66:in `block (2 levels) in render_template'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:60:in `block in render_template'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:76:in `block in render_with_layout'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:75:in `render_with_layout'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:59:in `render_template'
actionview (8.0.3) lib/action_view/renderer/template_renderer.rb:11:in `render'
actionview (8.0.3) lib/action_view/renderer/renderer.rb:58:in `render_template_to_object'
actionview (8.0.3) lib/action_view/renderer/renderer.rb:31:in `render_to_object'
actionview (8.0.3) lib/action_view/rendering.rb:136:in `block in _render_template'
actionview (8.0.3) lib/action_view/base.rb:305:in `in_rendering_context'
actionview (8.0.3) lib/action_view/rendering.rb:135:in `_render_template'
actionpack (8.0.3) lib/action_controller/metal/streaming.rb:179:in `_render_template'
actionview (8.0.3) lib/action_view/rendering.rb:122:in `render_to_body'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:186:in `render_to_body'
actionpack (8.0.3) lib/action_controller/metal/renderers.rb:140:in `render_to_body'
actionpack (8.0.3) lib/abstract_controller/rendering.rb:28:in `render'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:167:in `render'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:31:in `block (2 levels) in render'
activesupport (8.0.3) lib/active_support/benchmark.rb:17:in `realtime'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:31:in `block in render'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:100:in `cleanup_view_runtime'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:46:in `cleanup_view_runtime'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:30:in `render'
/home/micah/work/adva/lib/rails_ext/action_controller/render_with_error_proc.rb:24:in `block in render'
/home/micah/work/adva/lib/rails_ext/action_controller/render_with_error_proc.rb:39:in `with_error_proc'
/home/micah/work/adva/lib/rails_ext/action_controller/render_with_error_proc.rb:23:in `render'
actionpack (8.0.3) lib/action_controller/metal/implicit_render.rb:39:in `default_render'
actionpack (8.0.3) lib/action_controller/metal/basic_implicit_render.rb:9:in `send_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:215:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:193:in `process_action'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:261:in `block in process_action'
activesupport (8.0.3) lib/active_support/callbacks.rb:120:in `block in run_callbacks'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/controller.rb:8:in `write_flash_to_cookie'
activesupport (8.0.3) lib/active_support/callbacks.rb:129:in `block in run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:140:in `run_callbacks'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:76:in `block in process_action'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:75:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:152:in `process'
actionview (8.0.3) lib/action_view/rendering.rb:40:in `process'
actionpack (8.0.3) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (8.0.3) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:908:in `call'
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:60:in `call'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/middleware.rb:8:in `call'
rack (3.2.1) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.2.1) lib/rack/etag.rb:29:in `call'
rack (3.2.1) lib/rack/conditional_get.rb:31:in `call'
rack (3.2.1) lib/rack/head.rb:15:in `call'
actionpack (8.0.3) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (8.0.3) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/cookies.rb:706:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (8.0.3) lib/active_support/callbacks.rb:100:in `run_callbacks'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (8.0.3) lib/rails/rack/logger.rb:41:in `call_app'
railties (8.0.3) lib/rails/rack/logger.rb:29:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/request_id.rb:34:in `call'
rack (3.2.1) lib/rack/method_override.rb:28:in `call'
rack (3.2.1) lib/rack/runtime.rb:24:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.2.1) lib/rack/sendfile.rb:114:in `call'
railties (8.0.3) lib/rails/engine.rb:535:in `call'
rack-test (2.2.0) lib/rack/test.rb:360:in `process_request'
rack-test (2.2.0) lib/rack/test.rb:153:in `request'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:297:in `process'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:19:in `get'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:79:in `public_send'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:79:in `follow_redirect!'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:388:in `follow_redirect!'
/home/micah/work/adva_comments/spec/requests/admin/comments_spec.rb:28:in `block (3 levels) in <top (required)>'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `block in run'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-rails (7.1.1) lib/rspec/rails/adapters.rb:75:in `block (2 levels) in <module:MinitestLifecycleAdapter>'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:390:in `execute_with'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `run'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:259:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:653:in `block in run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:614:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `map'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/configuration.rb:2097:in `with_suite_hooks'
rspec-core (3.13.5) lib/rspec/core/runner.rb:116:in `block in run_specs'
rspec-core (3.13.5) lib/rspec/core/reporter.rb:74:in `report'
rspec-core (3.13.5) lib/rspec/core/runner.rb:115:in `run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:89:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:71:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:45:in `invoke'
rspec-core (3.13.5) exe/rspec:4:in `<top (required)>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `load'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `<main>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `eval'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `<main>'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started DELETE "/admin/comments/1" for 127.0.0.1 at 2025-09-28 19:34:01 -0400
Processing by Admin::CommentsController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 3]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 2]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 4]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/admin/comments
Completed 302 Found in 8ms (ActiveRecord: 0.8ms (18 queries, 0 cached) | GC: 0.2ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments/preview" for 127.0.0.1 at 2025-09-28 19:34:01 -0400
Processing by CommentsController#preview as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"Previewer", "author_email"=>"preview@example.com", "body"=>"Hello preview"}}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
  Rendering /home/micah/work/adva_comments/app/views/comments/preview.html.erb
  Rendered /home/micah/work/adva_comments/app/views/comments/preview.html.erb (Duration: 0.1ms | GC: 0.0ms)
Completed 200 OK in 6ms (Views: 0.8ms | ActiveRecord: 0.5ms (6 queries, 0 cached) | GC: 0.5ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments" for 127.0.0.1 at 2025-09-28 19:34:01 -0400
Processing by CommentsController#create as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"New Author", "author_email"=>"new@example.com", "body"=>"New comment body"}}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
[Invisible Captcha] Potential spam detected for IP 127.0.0.1. Timestamp not found in session.
Redirected to http://test-site.com/ref
Filter chain halted as #<Proc:0x00007f8dbeea0d50 /home/micah/.rvm/gems/ruby-3.3.4/gems/invisible_captcha-2.3.0/lib/invisible_captcha/controller_ext.rb:12> rendered or redirected
Completed 302 Found in 3ms (ActiveRecord: 0.3ms (6 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started PUT "/comments/1" for 127.0.0.1 at 2025-09-28 19:34:01 -0400
Processing by CommentsController#update as HTML
  Parameters: {"comment"=>{"body"=>"updated body"}, "id"=>"1"}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.3ms (5 queries, 0 cached) | GC: 0.0ms)
  
NoMethodError (undefined method `site_id' for nil):
  
/home/micah/work/adva_comments/app/controllers/comments_controller.rb:84:in `comment_params'
/home/micah/work/adva_comments/app/controllers/comments_controller.rb:58:in `update'
actionpack (8.0.3) lib/action_controller/metal/basic_implicit_render.rb:8:in `send_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:215:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:193:in `process_action'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:261:in `block in process_action'
activesupport (8.0.3) lib/active_support/callbacks.rb:120:in `block in run_callbacks'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/controller.rb:8:in `write_flash_to_cookie'
activesupport (8.0.3) lib/active_support/callbacks.rb:129:in `block in run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:140:in `run_callbacks'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:76:in `block in process_action'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:75:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:152:in `process'
actionview (8.0.3) lib/action_view/rendering.rb:40:in `process'
actionpack (8.0.3) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (8.0.3) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:908:in `call'
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:60:in `call'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/middleware.rb:8:in `call'
rack (3.2.1) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.2.1) lib/rack/etag.rb:29:in `call'
rack (3.2.1) lib/rack/conditional_get.rb:44:in `call'
rack (3.2.1) lib/rack/head.rb:15:in `call'
actionpack (8.0.3) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (8.0.3) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/cookies.rb:706:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (8.0.3) lib/active_support/callbacks.rb:100:in `run_callbacks'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (8.0.3) lib/rails/rack/logger.rb:41:in `call_app'
railties (8.0.3) lib/rails/rack/logger.rb:29:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/request_id.rb:34:in `call'
rack (3.2.1) lib/rack/method_override.rb:28:in `call'
rack (3.2.1) lib/rack/runtime.rb:24:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.2.1) lib/rack/sendfile.rb:114:in `call'
railties (8.0.3) lib/rails/engine.rb:535:in `call'
rack-test (2.2.0) lib/rack/test.rb:360:in `process_request'
rack-test (2.2.0) lib/rack/test.rb:153:in `request'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:297:in `process'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:37:in `put'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:388:in `put'
/home/micah/work/adva_comments/spec/requests/comments_spec.rb:55:in `block (3 levels) in <top (required)>'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `block in run'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-rails (7.1.1) lib/rspec/rails/adapters.rb:75:in `block (2 levels) in <module:MinitestLifecycleAdapter>'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:390:in `execute_with'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `run'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:259:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:653:in `block in run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:614:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `map'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/configuration.rb:2097:in `with_suite_hooks'
rspec-core (3.13.5) lib/rspec/core/runner.rb:116:in `block in run_specs'
rspec-core (3.13.5) lib/rspec/core/reporter.rb:74:in `report'
rspec-core (3.13.5) lib/rspec/core/runner.rb:115:in `run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:89:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:71:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:45:in `invoke'
rspec-core (3.13.5) exe/rspec:4:in `<top (required)>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `load'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `<main>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `eval'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `<main>'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started DELETE "/comments/1" for 127.0.0.1 at 2025-09-28 19:34:01 -0400
Processing by CommentsController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.4ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 3]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 2]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.0ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 4]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/
Completed 302 Found in 9ms (ActiveRecord: 1.3ms (20 queries, 0 cached) | GC: 0.4ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (7.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "counters"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "counters" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "owner_type" varchar, "owner_id" integer, "name" varchar(25), "count" integer DEFAULT 0)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_counters_on_owner" ON "counters" ("owner_type", "owner_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.1ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:34:30.946628"], ["updated_at", "2025-09-28 23:34:30.946628"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:34:30.958584"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:34:30.959608"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:34:30.962136"], ["created_at", "2025-09-28 23:34:30.967223"], ["updated_at", "2025-09-28 23:34:30.967223"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:34:30.990973"], ["updated_at", "2025-09-28 23:34:30.990973"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:34:30.992734"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (0.7ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:34:31.038517"], ["updated_at", "2025-09-28 23:34:31.038517"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.0ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:34:31.065076"], ["id", 1]]
  [1m[36mSite Update (0.1ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:34:31.065639"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started PUT "/admin/comments/1" for 127.0.0.1 at 2025-09-28 19:34:31 -0400
Processing by Admin::CommentsController#update as HTML
  Parameters: {"comment"=>{"body"=>"updated comment body"}, "id"=>"1"}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mContent Load (0.3ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mComment Update (0.1ms)[0m  [1m[33mUPDATE "comments" SET "body" = ?, "updated_at" = ? WHERE "comments"."id" = ?[0m  [["body", "updated comment body"], ["updated_at", "2025-09-28 23:34:31.185529"], ["id", 1]]
  [1m[36mArticle Update (0.1ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:34:31.186667"], ["id", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Update (0.1ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:34:31.188342"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/admin/comments
Completed 302 Found in 14ms (ActiveRecord: 1.2ms (10 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started DELETE "/admin/comments/1" for 127.0.0.1 at 2025-09-28 19:34:31 -0400
Processing by Admin::CommentsController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.1ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.1ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 3]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 2]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 4]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/admin/comments
Completed 302 Found in 10ms (ActiveRecord: 1.0ms (18 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments/preview" for 127.0.0.1 at 2025-09-28 19:34:31 -0400
Processing by CommentsController#preview as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"Previewer", "author_email"=>"preview@example.com", "body"=>"Hello preview"}}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
  Rendering /home/micah/work/adva_comments/app/views/comments/preview.html.erb
  Rendered /home/micah/work/adva_comments/app/views/comments/preview.html.erb (Duration: 0.2ms | GC: 0.0ms)
Completed 200 OK in 8ms (Views: 2.8ms | ActiveRecord: 0.4ms (6 queries, 0 cached) | GC: 0.6ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments" for 127.0.0.1 at 2025-09-28 19:34:31 -0400
Processing by CommentsController#create as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"New Author", "author_email"=>"new@example.com", "body"=>"New comment body"}}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
[Invisible Captcha] Potential spam detected for IP 127.0.0.1. Timestamp not found in session.
Redirected to http://test-site.com/ref
Filter chain halted as #<Proc:0x000074ae931c4dd0 /home/micah/.rvm/gems/ruby-3.3.4/gems/invisible_captcha-2.3.0/lib/invisible_captcha/controller_ext.rb:12> rendered or redirected
Completed 302 Found in 3ms (ActiveRecord: 0.4ms (6 queries, 0 cached) | GC: 0.1ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started PUT "/comments/1" for 127.0.0.1 at 2025-09-28 19:34:31 -0400
Processing by CommentsController#update as HTML
  Parameters: {"comment"=>{"body"=>"updated body"}, "id"=>"1"}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.3ms (5 queries, 0 cached) | GC: 0.0ms)
  
NoMethodError (undefined method `site_id' for nil):
  
/home/micah/work/adva_comments/app/controllers/comments_controller.rb:84:in `comment_params'
/home/micah/work/adva_comments/app/controllers/comments_controller.rb:58:in `update'
actionpack (8.0.3) lib/action_controller/metal/basic_implicit_render.rb:8:in `send_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:215:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:193:in `process_action'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:261:in `block in process_action'
activesupport (8.0.3) lib/active_support/callbacks.rb:120:in `block in run_callbacks'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/controller.rb:8:in `write_flash_to_cookie'
activesupport (8.0.3) lib/active_support/callbacks.rb:129:in `block in run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:140:in `run_callbacks'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:76:in `block in process_action'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:75:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:152:in `process'
actionview (8.0.3) lib/action_view/rendering.rb:40:in `process'
actionpack (8.0.3) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (8.0.3) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:908:in `call'
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:60:in `call'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/middleware.rb:8:in `call'
rack (3.2.1) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.2.1) lib/rack/etag.rb:29:in `call'
rack (3.2.1) lib/rack/conditional_get.rb:44:in `call'
rack (3.2.1) lib/rack/head.rb:15:in `call'
actionpack (8.0.3) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (8.0.3) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/cookies.rb:706:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (8.0.3) lib/active_support/callbacks.rb:100:in `run_callbacks'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (8.0.3) lib/rails/rack/logger.rb:41:in `call_app'
railties (8.0.3) lib/rails/rack/logger.rb:29:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/request_id.rb:34:in `call'
rack (3.2.1) lib/rack/method_override.rb:28:in `call'
rack (3.2.1) lib/rack/runtime.rb:24:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.2.1) lib/rack/sendfile.rb:114:in `call'
railties (8.0.3) lib/rails/engine.rb:535:in `call'
rack-test (2.2.0) lib/rack/test.rb:360:in `process_request'
rack-test (2.2.0) lib/rack/test.rb:153:in `request'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:297:in `process'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:37:in `put'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:388:in `put'
/home/micah/work/adva_comments/spec/requests/comments_spec.rb:55:in `block (3 levels) in <top (required)>'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `block in run'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-rails (7.1.1) lib/rspec/rails/adapters.rb:75:in `block (2 levels) in <module:MinitestLifecycleAdapter>'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:390:in `execute_with'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `run'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:259:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:653:in `block in run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:614:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `map'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/configuration.rb:2097:in `with_suite_hooks'
rspec-core (3.13.5) lib/rspec/core/runner.rb:116:in `block in run_specs'
rspec-core (3.13.5) lib/rspec/core/reporter.rb:74:in `report'
rspec-core (3.13.5) lib/rspec/core/runner.rb:115:in `run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:89:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:71:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:45:in `invoke'
rspec-core (3.13.5) exe/rspec:4:in `<top (required)>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `load'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `<main>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `eval'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `<main>'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started DELETE "/comments/1" for 127.0.0.1 at 2025-09-28 19:34:31 -0400
Processing by CommentsController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.3ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 3]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 2]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 4]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/
Completed 302 Found in 16ms (ActiveRecord: 1.5ms (20 queries, 0 cached) | GC: 6.5ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (8.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "counters"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "counters" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "owner_type" varchar, "owner_id" integer, "name" varchar(25), "count" integer DEFAULT 0)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_counters_on_owner" ON "counters" ("owner_type", "owner_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.1ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:35:04.135676"], ["updated_at", "2025-09-28 23:35:04.135676"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:35:04.151888"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:35:04.153383"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:35:04.156893"], ["created_at", "2025-09-28 23:35:04.163212"], ["updated_at", "2025-09-28 23:35:04.163212"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:35:04.183317"], ["updated_at", "2025-09-28 23:35:04.183317"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.1ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:35:04.185772"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:35:04.232142"], ["updated_at", "2025-09-28 23:35:04.232142"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:35:04.243248"], ["id", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:35:04.243974"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started PUT "/admin/comments/1" for 127.0.0.1 at 2025-09-28 19:35:04 -0400
Processing by Admin::CommentsController#update as HTML
  Parameters: {"comment"=>{"body"=>"updated comment body"}, "id"=>"1"}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mContent Load (0.3ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mComment Update (0.1ms)[0m  [1m[33mUPDATE "comments" SET "body" = ?, "updated_at" = ? WHERE "comments"."id" = ?[0m  [["body", "updated comment body"], ["updated_at", "2025-09-28 23:35:04.326502"], ["id", 1]]
  [1m[36mArticle Update (0.1ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:35:04.327765"], ["id", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Update (0.1ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:35:04.329308"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/admin/comments
Completed 302 Found in 14ms (ActiveRecord: 1.3ms (10 queries, 0 cached) | GC: 0.3ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started DELETE "/admin/comments/1" for 127.0.0.1 at 2025-09-28 19:35:04 -0400
Processing by Admin::CommentsController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 3]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 2]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 4]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/admin/comments
Completed 302 Found in 12ms (ActiveRecord: 1.1ms (18 queries, 0 cached) | GC: 0.1ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments" for 127.0.0.1 at 2025-09-28 19:35:04 -0400
Processing by CommentsController#create as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"New Author", "author_email"=>"new@example.com", "body"=>"New comment body"}}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
[Invisible Captcha] Potential spam detected for IP 127.0.0.1. Timestamp not found in session.
Redirected to http://test-site.com/ref
Filter chain halted as #<Proc:0x00007fecc44982f8 /home/micah/.rvm/gems/ruby-3.3.4/gems/invisible_captcha-2.3.0/lib/invisible_captcha/controller_ext.rb:12> rendered or redirected
Completed 302 Found in 5ms (ActiveRecord: 0.5ms (6 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (7.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "counters"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "counters" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "owner_type" varchar, "owner_id" integer, "name" varchar(25), "count" integer DEFAULT 0)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_counters_on_owner" ON "counters" ("owner_type", "owner_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.1ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:35:18.167212"], ["updated_at", "2025-09-28 23:35:18.167212"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:35:18.180591"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:35:18.181732"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:35:18.184487"], ["created_at", "2025-09-28 23:35:18.189235"], ["updated_at", "2025-09-28 23:35:18.189235"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:35:18.205209"], ["updated_at", "2025-09-28 23:35:18.205209"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:35:18.207083"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:35:18.235891"], ["updated_at", "2025-09-28 23:35:18.235891"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:35:18.250781"], ["id", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:35:18.251355"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.3ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.3ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started PUT "/admin/comments/1" for 127.0.0.1 at 2025-09-28 19:35:18 -0400
Processing by Admin::CommentsController#update as HTML
  Parameters: {"comment"=>{"body"=>"updated comment body"}, "id"=>"1"}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mContent Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mComment Update (0.0ms)[0m  [1m[33mUPDATE "comments" SET "body" = ?, "updated_at" = ? WHERE "comments"."id" = ?[0m  [["body", "updated comment body"], ["updated_at", "2025-09-28 23:35:18.372959"], ["id", 1]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:35:18.373628"], ["id", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:35:18.374491"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/admin/comments
Completed 302 Found in 9ms (ActiveRecord: 0.7ms (10 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started DELETE "/admin/comments/1" for 127.0.0.1 at 2025-09-28 19:35:18 -0400
Processing by Admin::CommentsController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.1ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 3]]
  [1m[36mSite Load (0.2ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 2]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 4]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/admin/comments
Completed 302 Found in 9ms (ActiveRecord: 0.9ms (18 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments/preview" for 127.0.0.1 at 2025-09-28 19:35:18 -0400
Processing by CommentsController#preview as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"Previewer", "author_email"=>"preview@example.com", "body"=>"Hello preview"}}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
  Rendering /home/micah/work/adva_comments/app/views/comments/preview.html.erb
  Rendered /home/micah/work/adva_comments/app/views/comments/preview.html.erb (Duration: 0.2ms | GC: 0.0ms)
Completed 200 OK in 7ms (Views: 2.7ms | ActiveRecord: 0.5ms (6 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments" for 127.0.0.1 at 2025-09-28 19:35:18 -0400
Processing by CommentsController#create as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"New Author", "author_email"=>"new@example.com", "body"=>"New comment body"}}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
[Invisible Captcha] Potential spam detected for IP 127.0.0.1. Timestamp not found in session.
Redirected to http://test-site.com/ref
Filter chain halted as #<Proc:0x00007b87b4552dc0 /home/micah/.rvm/gems/ruby-3.3.4/gems/invisible_captcha-2.3.0/lib/invisible_captcha/controller_ext.rb:12> rendered or redirected
Completed 302 Found in 3ms (ActiveRecord: 0.4ms (6 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (6.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "counters"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "counters" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "owner_type" varchar, "owner_id" integer, "name" varchar(25), "count" integer DEFAULT 0)[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE INDEX "index_counters_on_owner" ON "counters" ("owner_type", "owner_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.3ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:35:35.266110"], ["updated_at", "2025-09-28 23:35:35.266110"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:35:35.277507"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:35:35.278487"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:35:35.280846"], ["created_at", "2025-09-28 23:35:35.285487"], ["updated_at", "2025-09-28 23:35:35.285487"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:35:35.308611"], ["updated_at", "2025-09-28 23:35:35.308611"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:35:35.310475"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:35:35.351943"], ["updated_at", "2025-09-28 23:35:35.351943"]]
  [1m[36mCounter Load (0.8ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.6ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:35:35.382193"], ["id", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:35:35.382738"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started PUT "/admin/comments/1" for 127.0.0.1 at 2025-09-28 19:35:35 -0400
Processing by Admin::CommentsController#update as HTML
  Parameters: {"comment"=>{"body"=>"updated comment body"}, "id"=>"1"}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mContent Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mComment Update (0.1ms)[0m  [1m[33mUPDATE "comments" SET "body" = ?, "updated_at" = ? WHERE "comments"."id" = ?[0m  [["body", "updated comment body"], ["updated_at", "2025-09-28 23:35:35.501473"], ["id", 1]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:35:35.502174"], ["id", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:35:35.503157"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/admin/comments
Completed 302 Found in 9ms (ActiveRecord: 0.7ms (10 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started DELETE "/admin/comments/1" for 127.0.0.1 at 2025-09-28 19:35:35 -0400
Processing by Admin::CommentsController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 3]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 2]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 4]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/admin/comments
Completed 302 Found in 9ms (ActiveRecord: 0.9ms (18 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments/preview" for 127.0.0.1 at 2025-09-28 19:35:35 -0400
Processing by CommentsController#preview as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"Previewer", "author_email"=>"preview@example.com", "body"=>"Hello preview"}}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.2ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
  Rendering /home/micah/work/adva_comments/app/views/comments/preview.html.erb
  Rendered /home/micah/work/adva_comments/app/views/comments/preview.html.erb (Duration: 0.2ms | GC: 0.0ms)
Completed 200 OK in 11ms (Views: 2.9ms | ActiveRecord: 0.7ms (6 queries, 0 cached) | GC: 1.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments" for 127.0.0.1 at 2025-09-28 19:35:35 -0400
Processing by CommentsController#create as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"New Author", "author_email"=>"new@example.com", "body"=>"New comment body"}}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
[Invisible Captcha] Potential spam detected for IP 127.0.0.1. Timestamp not found in session.
Redirected to http://test-site.com/ref
Filter chain halted as #<Proc:0x000073c44d51a718 /home/micah/.rvm/gems/ruby-3.3.4/gems/invisible_captcha-2.3.0/lib/invisible_captcha/controller_ext.rb:12> rendered or redirected
Completed 302 Found in 3ms (ActiveRecord: 0.3ms (6 queries, 0 cached) | GC: 0.1ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (7.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "counters"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "counters" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "owner_type" varchar, "owner_id" integer, "name" varchar(25), "count" integer DEFAULT 0)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_counters_on_owner" ON "counters" ("owner_type", "owner_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.1ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:35:56.971096"], ["updated_at", "2025-09-28 23:35:56.971096"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:35:57.015170"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:35:57.016365"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:35:57.019554"], ["created_at", "2025-09-28 23:35:57.025440"], ["updated_at", "2025-09-28 23:35:57.025440"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:35:57.042377"], ["updated_at", "2025-09-28 23:35:57.042377"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:35:57.044493"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:35:57.083071"], ["updated_at", "2025-09-28 23:35:57.083071"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:35:57.092662"], ["id", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:35:57.093331"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.2ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started PUT "/admin/comments/1" for 127.0.0.1 at 2025-09-28 19:35:57 -0400
Processing by Admin::CommentsController#update as HTML
  Parameters: {"comment"=>{"body"=>"updated comment body"}, "id"=>"1"}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mContent Load (0.3ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mComment Update (0.1ms)[0m  [1m[33mUPDATE "comments" SET "body" = ?, "updated_at" = ? WHERE "comments"."id" = ?[0m  [["body", "updated comment body"], ["updated_at", "2025-09-28 23:35:57.241488"], ["id", 1]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:35:57.242350"], ["id", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:35:57.243378"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/admin/comments
Completed 302 Found in 11ms (ActiveRecord: 0.8ms (10 queries, 0 cached) | GC: 0.1ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started DELETE "/admin/comments/1" for 127.0.0.1 at 2025-09-28 19:35:57 -0400
Processing by Admin::CommentsController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.1ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 3]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.1ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 2]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 4]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/admin/comments
Completed 302 Found in 16ms (ActiveRecord: 1.3ms (18 queries, 0 cached) | GC: 4.2ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments/preview" for 127.0.0.1 at 2025-09-28 19:35:57 -0400
Processing by CommentsController#preview as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"Previewer", "author_email"=>"preview@example.com", "body"=>"Hello preview"}}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.9ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (1.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
  Rendering /home/micah/work/adva_comments/app/views/comments/preview.html.erb
  Rendered /home/micah/work/adva_comments/app/views/comments/preview.html.erb (Duration: 0.3ms | GC: 0.0ms)
Completed 200 OK in 23ms (Views: 8.2ms | ActiveRecord: 2.3ms (6 queries, 0 cached) | GC: 11.9ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments" for 127.0.0.1 at 2025-09-28 19:35:57 -0400
Processing by CommentsController#create as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"New Author", "author_email"=>"new@example.com", "body"=>"New comment body"}}
  [1m[36mSite Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.2ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.3ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
[Invisible Captcha] Potential spam detected for IP 127.0.0.1. Timestamp not found in session.
Redirected to http://test-site.com/ref
Filter chain halted as #<Proc:0x000076f78e3b3588 /home/micah/.rvm/gems/ruby-3.3.4/gems/invisible_captcha-2.3.0/lib/invisible_captcha/controller_ext.rb:12> rendered or redirected
Completed 302 Found in 8ms (ActiveRecord: 1.2ms (6 queries, 0 cached) | GC: 1.8ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (6.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "counters"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "counters" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "owner_type" varchar, "owner_id" integer, "name" varchar(25), "count" integer DEFAULT 0)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_counters_on_owner" ON "counters" ("owner_type", "owner_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.1ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:37:40.849444"], ["updated_at", "2025-09-28 23:37:40.849444"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:37:40.859801"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:37:40.860764"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:37:40.863236"], ["created_at", "2025-09-28 23:37:40.867559"], ["updated_at", "2025-09-28 23:37:40.867559"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:37:40.888502"], ["updated_at", "2025-09-28 23:37:40.888502"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:37:40.890608"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:37:40.924273"], ["updated_at", "2025-09-28 23:37:40.924273"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.0ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.0ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.4ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:37:40.934298"], ["id", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:37:40.936283"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.2ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started PUT "/admin/comments/1" for 127.0.0.1 at 2025-09-28 19:37:41 -0400
Processing by Admin::CommentsController#update as HTML
  Parameters: {"comment"=>{"body"=>"updated comment body"}, "id"=>"1"}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mContent Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mComment Update (0.0ms)[0m  [1m[33mUPDATE "comments" SET "body" = ?, "updated_at" = ? WHERE "comments"."id" = ?[0m  [["body", "updated comment body"], ["updated_at", "2025-09-28 23:37:41.073716"], ["id", 1]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:37:41.074341"], ["id", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:37:41.075240"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/admin/comments
Completed 302 Found in 8ms (ActiveRecord: 0.6ms (10 queries, 0 cached) | GC: 0.1ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started DELETE "/admin/comments/1" for 127.0.0.1 at 2025-09-28 19:37:41 -0400
Processing by Admin::CommentsController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 3]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 2]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 4]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/admin/comments
Completed 302 Found in 9ms (ActiveRecord: 1.0ms (18 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments/preview" for 127.0.0.1 at 2025-09-28 19:37:41 -0400
Processing by CommentsController#preview as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"Previewer", "author_email"=>"preview@example.com", "body"=>"Hello preview"}}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
  Rendering /home/micah/work/adva_comments/app/views/comments/preview.html.erb
  Rendered /home/micah/work/adva_comments/app/views/comments/preview.html.erb (Duration: 0.2ms | GC: 0.0ms)
Completed 200 OK in 7ms (Views: 2.5ms | ActiveRecord: 0.4ms (6 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments" for 127.0.0.1 at 2025-09-28 19:37:41 -0400
Processing by CommentsController#create as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"New Author", "author_email"=>"new@example.com", "body"=>"New comment body"}}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
[Invisible Captcha] Potential spam detected for IP 127.0.0.1. Timestamp not found in session.
Redirected to http://test-site.com/ref
Filter chain halted as #<Proc:0x000079b1922cc730 /home/micah/.rvm/gems/ruby-3.3.4/gems/invisible_captcha-2.3.0/lib/invisible_captcha/controller_ext.rb:12> rendered or redirected
Completed 302 Found in 3ms (ActiveRecord: 0.3ms (6 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (7.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "counters"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "counters" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "owner_type" varchar, "owner_id" integer, "name" varchar(25), "count" integer DEFAULT 0)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_counters_on_owner" ON "counters" ("owner_type", "owner_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.1ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:37:56.552531"], ["updated_at", "2025-09-28 23:37:56.552531"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:37:56.563959"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:37:56.564936"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:37:56.567516"], ["created_at", "2025-09-28 23:37:56.571937"], ["updated_at", "2025-09-28 23:37:56.571937"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:37:56.593176"], ["updated_at", "2025-09-28 23:37:56.593176"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:37:56.594908"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:37:56.641391"], ["updated_at", "2025-09-28 23:37:56.641391"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.0ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:37:56.666241"], ["id", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:37:56.666775"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.2ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.2ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.3ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started PUT "/admin/comments/1" for 127.0.0.1 at 2025-09-28 19:37:56 -0400
Processing by Admin::CommentsController#update as HTML
  Parameters: {"comment"=>{"body"=>"updated comment body"}, "id"=>"1"}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mComment Update (0.0ms)[0m  [1m[33mUPDATE "comments" SET "body" = ?, "updated_at" = ? WHERE "comments"."id" = ?[0m  [["body", "updated comment body"], ["updated_at", "2025-09-28 23:37:56.787195"], ["id", 1]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:37:56.787823"], ["id", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:37:56.788698"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/admin/comments
Completed 302 Found in 8ms (ActiveRecord: 0.5ms (10 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started DELETE "/admin/comments/1" for 127.0.0.1 at 2025-09-28 19:37:56 -0400
Processing by Admin::CommentsController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.3ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.1ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 3]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 2]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 4]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/admin/comments
Completed 302 Found in 17ms (ActiveRecord: 7.3ms (18 queries, 0 cached) | GC: 6.5ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments/preview" for 127.0.0.1 at 2025-09-28 19:37:56 -0400
Processing by CommentsController#preview as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"Previewer", "author_email"=>"preview@example.com", "body"=>"Hello preview"}}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
  Rendering /home/micah/work/adva_comments/app/views/comments/preview.html.erb
  Rendered /home/micah/work/adva_comments/app/views/comments/preview.html.erb (Duration: 0.2ms | GC: 0.0ms)
Completed 200 OK in 9ms (Views: 2.9ms | ActiveRecord: 0.5ms (6 queries, 0 cached) | GC: 0.2ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments" for 127.0.0.1 at 2025-09-28 19:37:56 -0400
Processing by CommentsController#create as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"New Author", "author_email"=>"new@example.com", "body"=>"New comment body"}}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
[Invisible Captcha] Potential spam detected for IP 127.0.0.1. Timestamp not found in session.
Redirected to http://test-site.com/ref
Filter chain halted as #<Proc:0x0000753efae4c6f0 /home/micah/.rvm/gems/ruby-3.3.4/gems/invisible_captcha-2.3.0/lib/invisible_captcha/controller_ext.rb:12> rendered or redirected
Completed 302 Found in 3ms (ActiveRecord: 0.3ms (6 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (5.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "counters"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "counters" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "owner_type" varchar, "owner_id" integer, "name" varchar(25), "count" integer DEFAULT 0)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_counters_on_owner" ON "counters" ("owner_type", "owner_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.1ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:38:25.575519"], ["updated_at", "2025-09-28 23:38:25.575519"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:38:25.586331"]]
  [1m[36mSite Update (0.1ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:38:25.587362"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:38:25.589966"], ["created_at", "2025-09-28 23:38:25.594954"], ["updated_at", "2025-09-28 23:38:25.594954"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:38:25.620095"], ["updated_at", "2025-09-28 23:38:25.620095"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:38:25.621933"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (1.4ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:38:25.673481"], ["updated_at", "2025-09-28 23:38:25.673481"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:38:25.693488"], ["id", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:38:25.694134"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started PUT "/admin/comments/1" for 127.0.0.1 at 2025-09-28 19:38:25 -0400
Processing by Admin::CommentsController#update as HTML
  Parameters: {"comment"=>{"body"=>"updated comment body"}, "id"=>"1"}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mContent Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 5ms (ActiveRecord: 0.5ms (6 queries, 0 cached) | GC: 0.0ms)
  
NoMethodError (undefined method `clone_attributes' for an instance of Comment):
  
activemodel (8.0.3) lib/active_model/attribute_methods.rb:512:in `method_missing'
activerecord (8.0.3) lib/active_record/attribute_methods.rb:495:in `method_missing'
/home/micah/work/adva_comments/app/observers/activities/comment_observer.rb:106:in `block in collect_activity_attributes'
<internal:kernel>:90:in `tap'
/home/micah/work/adva_comments/app/observers/activities/comment_observer.rb:104:in `collect_activity_attributes'
/home/micah/work/adva_comments/app/observers/activities/comment_observer.rb:65:in `initialize_activity'
/home/micah/work/adva_comments/app/observers/activities/comment_observer.rb:50:in `prepare_activity_logging'
/home/micah/work/adva_comments/app/observers/activities/comment_observer.rb:35:in `before_save'
rails-observers (0.1.5) lib/rails/observers/active_model/observing.rb:352:in `update'
rails-observers (0.1.5) lib/rails/observers/activerecord/observer.rb:118:in `block (2 levels) in define_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:361:in `block in make_lambda'
activesupport (8.0.3) lib/active_support/callbacks.rb:178:in `block in call'
activesupport (8.0.3) lib/active_support/callbacks.rb:668:in `block (2 levels) in default_terminator'
activesupport (8.0.3) lib/active_support/callbacks.rb:667:in `catch'
activesupport (8.0.3) lib/active_support/callbacks.rb:667:in `block in default_terminator'
activesupport (8.0.3) lib/active_support/callbacks.rb:179:in `call'
activesupport (8.0.3) lib/active_support/callbacks.rb:559:in `block in invoke_before'
activesupport (8.0.3) lib/active_support/callbacks.rb:559:in `each'
activesupport (8.0.3) lib/active_support/callbacks.rb:559:in `invoke_before'
activesupport (8.0.3) lib/active_support/callbacks.rb:118:in `block in run_callbacks'
activerecord (8.0.3) lib/active_record/autosave_association.rb:406:in `around_save_collection_association'
activesupport (8.0.3) lib/active_support/callbacks.rb:129:in `block in run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:140:in `run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:913:in `_run_save_callbacks'
activerecord (8.0.3) lib/active_record/callbacks.rb:441:in `create_or_update'
activerecord (8.0.3) lib/active_record/timestamp.rb:127:in `create_or_update'
activerecord (8.0.3) lib/active_record/persistence.rb:391:in `save'
activerecord (8.0.3) lib/active_record/validations.rb:48:in `save'
activerecord (8.0.3) lib/active_record/transactions.rb:361:in `block in save'
activerecord (8.0.3) lib/active_record/transactions.rb:417:in `block (2 levels) in with_transaction_returning_status'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/transaction.rb:626:in `block in within_new_transaction'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:23:in `handle_interrupt'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:23:in `block in synchronize'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:19:in `handle_interrupt'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:19:in `synchronize'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/transaction.rb:623:in `within_new_transaction'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/database_statements.rb:367:in `within_new_transaction'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/database_statements.rb:359:in `transaction'
activerecord (8.0.3) lib/active_record/transactions.rb:413:in `block in with_transaction_returning_status'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/connection_pool.rb:416:in `with_connection'
activerecord (8.0.3) lib/active_record/connection_handling.rb:310:in `with_connection'
activerecord (8.0.3) lib/active_record/transactions.rb:409:in `with_transaction_returning_status'
activerecord (8.0.3) lib/active_record/transactions.rb:361:in `save'
activerecord (8.0.3) lib/active_record/suppressor.rb:52:in `save'
/home/micah/work/adva_comments/app/controllers/admin/comments_controller.rb:24:in `update'
actionpack (8.0.3) lib/action_controller/metal/basic_implicit_render.rb:8:in `send_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:215:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:193:in `process_action'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:261:in `block in process_action'
activesupport (8.0.3) lib/active_support/callbacks.rb:120:in `block in run_callbacks'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/controller.rb:8:in `write_flash_to_cookie'
activesupport (8.0.3) lib/active_support/callbacks.rb:129:in `block in run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:140:in `run_callbacks'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:76:in `block in process_action'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:75:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:152:in `process'
actionview (8.0.3) lib/action_view/rendering.rb:40:in `process'
actionpack (8.0.3) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (8.0.3) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:908:in `call'
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:60:in `call'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/middleware.rb:8:in `call'
rack (3.2.1) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.2.1) lib/rack/etag.rb:29:in `call'
rack (3.2.1) lib/rack/conditional_get.rb:44:in `call'
rack (3.2.1) lib/rack/head.rb:15:in `call'
actionpack (8.0.3) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (8.0.3) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/cookies.rb:706:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (8.0.3) lib/active_support/callbacks.rb:100:in `run_callbacks'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (8.0.3) lib/rails/rack/logger.rb:41:in `call_app'
railties (8.0.3) lib/rails/rack/logger.rb:29:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/request_id.rb:34:in `call'
rack (3.2.1) lib/rack/method_override.rb:28:in `call'
rack (3.2.1) lib/rack/runtime.rb:24:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.2.1) lib/rack/sendfile.rb:114:in `call'
railties (8.0.3) lib/rails/engine.rb:535:in `call'
rack-test (2.2.0) lib/rack/test.rb:360:in `process_request'
rack-test (2.2.0) lib/rack/test.rb:153:in `request'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:297:in `process'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:37:in `put'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:388:in `put'
/home/micah/work/adva_comments/spec/requests/admin/comments_spec.rb:26:in `block (3 levels) in <top (required)>'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `block in run'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-rails (7.1.1) lib/rspec/rails/adapters.rb:75:in `block (2 levels) in <module:MinitestLifecycleAdapter>'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:390:in `execute_with'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `run'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:259:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:653:in `block in run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:614:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `map'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/configuration.rb:2097:in `with_suite_hooks'
rspec-core (3.13.5) lib/rspec/core/runner.rb:116:in `block in run_specs'
rspec-core (3.13.5) lib/rspec/core/reporter.rb:74:in `report'
rspec-core (3.13.5) lib/rspec/core/runner.rb:115:in `run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:89:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:71:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:45:in `invoke'
rspec-core (3.13.5) exe/rspec:4:in `<top (required)>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `load'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `<main>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `eval'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `<main>'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started DELETE "/admin/comments/1" for 127.0.0.1 at 2025-09-28 19:38:26 -0400
Processing by Admin::CommentsController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 3]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 2]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 4]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 10ms (ActiveRecord: 1.1ms (18 queries, 0 cached) | GC: 0.8ms)
  
NoMethodError (undefined method `clone_attributes' for an instance of Comment):
  
activemodel (8.0.3) lib/active_model/attribute_methods.rb:512:in `method_missing'
activerecord (8.0.3) lib/active_record/attribute_methods.rb:495:in `method_missing'
/home/micah/work/adva_comments/app/observers/activities/comment_observer.rb:106:in `block in collect_activity_attributes'
<internal:kernel>:90:in `tap'
/home/micah/work/adva_comments/app/observers/activities/comment_observer.rb:104:in `collect_activity_attributes'
/home/micah/work/adva_comments/app/observers/activities/comment_observer.rb:65:in `initialize_activity'
/home/micah/work/adva_comments/app/observers/activities/comment_observer.rb:50:in `prepare_activity_logging'
/home/micah/work/adva_comments/app/observers/activities/comment_observer.rb:43:in `after_destroy'
rails-observers (0.1.5) lib/rails/observers/active_model/observing.rb:352:in `update'
rails-observers (0.1.5) lib/rails/observers/activerecord/observer.rb:118:in `block (2 levels) in define_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:361:in `block in make_lambda'
activesupport (8.0.3) lib/active_support/callbacks.rb:207:in `call'
activesupport (8.0.3) lib/active_support/callbacks.rb:563:in `block in invoke_after'
activesupport (8.0.3) lib/active_support/callbacks.rb:563:in `each'
activesupport (8.0.3) lib/active_support/callbacks.rb:563:in `invoke_after'
activesupport (8.0.3) lib/active_support/callbacks.rb:110:in `run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:913:in `_run_destroy_callbacks'
activerecord (8.0.3) lib/active_record/callbacks.rb:423:in `destroy'
activerecord (8.0.3) lib/active_record/transactions.rb:357:in `block in destroy'
activerecord (8.0.3) lib/active_record/transactions.rb:417:in `block (2 levels) in with_transaction_returning_status'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/transaction.rb:626:in `block in within_new_transaction'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:23:in `handle_interrupt'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:23:in `block in synchronize'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:19:in `handle_interrupt'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:19:in `synchronize'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/transaction.rb:623:in `within_new_transaction'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/database_statements.rb:367:in `within_new_transaction'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/database_statements.rb:359:in `transaction'
activerecord (8.0.3) lib/active_record/transactions.rb:413:in `block in with_transaction_returning_status'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/connection_pool.rb:416:in `with_connection'
activerecord (8.0.3) lib/active_record/connection_handling.rb:310:in `with_connection'
activerecord (8.0.3) lib/active_record/transactions.rb:409:in `with_transaction_returning_status'
activerecord (8.0.3) lib/active_record/transactions.rb:357:in `destroy'
/home/micah/work/adva_comments/app/controllers/admin/comments_controller.rb:35:in `destroy'
actionpack (8.0.3) lib/action_controller/metal/basic_implicit_render.rb:8:in `send_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:215:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:193:in `process_action'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:261:in `block in process_action'
activesupport (8.0.3) lib/active_support/callbacks.rb:120:in `block in run_callbacks'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/controller.rb:8:in `write_flash_to_cookie'
activesupport (8.0.3) lib/active_support/callbacks.rb:129:in `block in run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:140:in `run_callbacks'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:76:in `block in process_action'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:75:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:152:in `process'
actionview (8.0.3) lib/action_view/rendering.rb:40:in `process'
actionpack (8.0.3) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (8.0.3) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:908:in `call'
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:60:in `call'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/middleware.rb:8:in `call'
rack (3.2.1) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.2.1) lib/rack/etag.rb:29:in `call'
rack (3.2.1) lib/rack/conditional_get.rb:44:in `call'
rack (3.2.1) lib/rack/head.rb:15:in `call'
actionpack (8.0.3) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (8.0.3) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/cookies.rb:706:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (8.0.3) lib/active_support/callbacks.rb:100:in `run_callbacks'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (8.0.3) lib/rails/rack/logger.rb:41:in `call_app'
railties (8.0.3) lib/rails/rack/logger.rb:29:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/request_id.rb:34:in `call'
rack (3.2.1) lib/rack/method_override.rb:28:in `call'
rack (3.2.1) lib/rack/runtime.rb:24:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.2.1) lib/rack/sendfile.rb:114:in `call'
railties (8.0.3) lib/rails/engine.rb:535:in `call'
rack-test (2.2.0) lib/rack/test.rb:360:in `process_request'
rack-test (2.2.0) lib/rack/test.rb:153:in `request'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:297:in `process'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:43:in `delete'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:388:in `delete'
/home/micah/work/adva_comments/spec/requests/admin/comments_spec.rb:33:in `block (3 levels) in <top (required)>'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `block in run'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-rails (7.1.1) lib/rspec/rails/adapters.rb:75:in `block (2 levels) in <module:MinitestLifecycleAdapter>'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:390:in `execute_with'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `run'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:259:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:653:in `block in run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:614:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `map'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/configuration.rb:2097:in `with_suite_hooks'
rspec-core (3.13.5) lib/rspec/core/runner.rb:116:in `block in run_specs'
rspec-core (3.13.5) lib/rspec/core/reporter.rb:74:in `report'
rspec-core (3.13.5) lib/rspec/core/runner.rb:115:in `run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:89:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:71:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:45:in `invoke'
rspec-core (3.13.5) exe/rspec:4:in `<top (required)>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `load'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `<main>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `eval'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `<main>'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments/preview" for 127.0.0.1 at 2025-09-28 19:38:26 -0400
Processing by CommentsController#preview as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"Previewer", "author_email"=>"preview@example.com", "body"=>"Hello preview"}}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
  Rendering /home/micah/work/adva_comments/app/views/comments/preview.html.erb
  Rendered /home/micah/work/adva_comments/app/views/comments/preview.html.erb (Duration: 0.2ms | GC: 0.0ms)
Completed 200 OK in 7ms (Views: 1.2ms | ActiveRecord: 0.6ms (6 queries, 0 cached) | GC: 0.4ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments" for 127.0.0.1 at 2025-09-28 19:38:26 -0400
Processing by CommentsController#create as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"New Author", "author_email"=>"new@example.com", "body"=>"New comment body"}}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
[Invisible Captcha] Potential spam detected for IP 127.0.0.1. Timestamp not found in session.
Redirected to http://test-site.com/ref
Filter chain halted as #<Proc:0x00007c3c811d5030 /home/micah/.rvm/gems/ruby-3.3.4/gems/invisible_captcha-2.3.0/lib/invisible_captcha/controller_ext.rb:12> rendered or redirected
Completed 302 Found in 3ms (ActiveRecord: 0.3ms (6 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (6.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "counters"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "counters" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "owner_type" varchar, "owner_id" integer, "name" varchar(25), "count" integer DEFAULT 0)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_counters_on_owner" ON "counters" ("owner_type", "owner_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.1ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:39:25.040686"], ["updated_at", "2025-09-28 23:39:25.040686"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:39:25.051782"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:39:25.052775"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:39:25.055354"], ["created_at", "2025-09-28 23:39:25.059927"], ["updated_at", "2025-09-28 23:39:25.059927"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:39:25.081053"], ["updated_at", "2025-09-28 23:39:25.081053"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:39:25.083134"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:39:25.119131"], ["updated_at", "2025-09-28 23:39:25.119131"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.0ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:39:25.127344"], ["id", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:39:25.127849"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.2ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started PUT "/admin/comments/1" for 127.0.0.1 at 2025-09-28 19:39:25 -0400
Processing by Admin::CommentsController#update as HTML
  Parameters: {"comment"=>{"body"=>"updated comment body"}, "id"=>"1"}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mContent Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 5ms (ActiveRecord: 0.5ms (6 queries, 0 cached) | GC: 0.1ms)
  
ArgumentError (wrong number of arguments (given 2, expected 0..1)):
  
activerecord (8.0.3) lib/active_record/inheritance.rb:56:in `new'
activerecord (8.0.3) lib/active_record/aggregations.rb:254:in `block in reader_method'
/home/micah/work/adva_comments/app/observers/activities/comment_observer.rb:68:in `block in initialize_activity'
<internal:kernel>:90:in `tap'
/home/micah/work/adva_comments/app/observers/activities/comment_observer.rb:65:in `initialize_activity'
/home/micah/work/adva_comments/app/observers/activities/comment_observer.rb:50:in `prepare_activity_logging'
/home/micah/work/adva_comments/app/observers/activities/comment_observer.rb:35:in `before_save'
rails-observers (0.1.5) lib/rails/observers/active_model/observing.rb:352:in `update'
rails-observers (0.1.5) lib/rails/observers/activerecord/observer.rb:118:in `block (2 levels) in define_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:361:in `block in make_lambda'
activesupport (8.0.3) lib/active_support/callbacks.rb:178:in `block in call'
activesupport (8.0.3) lib/active_support/callbacks.rb:668:in `block (2 levels) in default_terminator'
activesupport (8.0.3) lib/active_support/callbacks.rb:667:in `catch'
activesupport (8.0.3) lib/active_support/callbacks.rb:667:in `block in default_terminator'
activesupport (8.0.3) lib/active_support/callbacks.rb:179:in `call'
activesupport (8.0.3) lib/active_support/callbacks.rb:559:in `block in invoke_before'
activesupport (8.0.3) lib/active_support/callbacks.rb:559:in `each'
activesupport (8.0.3) lib/active_support/callbacks.rb:559:in `invoke_before'
activesupport (8.0.3) lib/active_support/callbacks.rb:118:in `block in run_callbacks'
activerecord (8.0.3) lib/active_record/autosave_association.rb:406:in `around_save_collection_association'
activesupport (8.0.3) lib/active_support/callbacks.rb:129:in `block in run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:140:in `run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:913:in `_run_save_callbacks'
activerecord (8.0.3) lib/active_record/callbacks.rb:441:in `create_or_update'
activerecord (8.0.3) lib/active_record/timestamp.rb:127:in `create_or_update'
activerecord (8.0.3) lib/active_record/persistence.rb:391:in `save'
activerecord (8.0.3) lib/active_record/validations.rb:48:in `save'
activerecord (8.0.3) lib/active_record/transactions.rb:361:in `block in save'
activerecord (8.0.3) lib/active_record/transactions.rb:417:in `block (2 levels) in with_transaction_returning_status'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/transaction.rb:626:in `block in within_new_transaction'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:23:in `handle_interrupt'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:23:in `block in synchronize'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:19:in `handle_interrupt'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:19:in `synchronize'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/transaction.rb:623:in `within_new_transaction'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/database_statements.rb:367:in `within_new_transaction'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/database_statements.rb:359:in `transaction'
activerecord (8.0.3) lib/active_record/transactions.rb:413:in `block in with_transaction_returning_status'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/connection_pool.rb:416:in `with_connection'
activerecord (8.0.3) lib/active_record/connection_handling.rb:310:in `with_connection'
activerecord (8.0.3) lib/active_record/transactions.rb:409:in `with_transaction_returning_status'
activerecord (8.0.3) lib/active_record/transactions.rb:361:in `save'
activerecord (8.0.3) lib/active_record/suppressor.rb:52:in `save'
/home/micah/work/adva_comments/app/controllers/admin/comments_controller.rb:24:in `update'
actionpack (8.0.3) lib/action_controller/metal/basic_implicit_render.rb:8:in `send_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:215:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:193:in `process_action'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:261:in `block in process_action'
activesupport (8.0.3) lib/active_support/callbacks.rb:120:in `block in run_callbacks'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/controller.rb:8:in `write_flash_to_cookie'
activesupport (8.0.3) lib/active_support/callbacks.rb:129:in `block in run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:140:in `run_callbacks'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:76:in `block in process_action'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:75:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:152:in `process'
actionview (8.0.3) lib/action_view/rendering.rb:40:in `process'
actionpack (8.0.3) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (8.0.3) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:908:in `call'
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:60:in `call'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/middleware.rb:8:in `call'
rack (3.2.1) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.2.1) lib/rack/etag.rb:29:in `call'
rack (3.2.1) lib/rack/conditional_get.rb:44:in `call'
rack (3.2.1) lib/rack/head.rb:15:in `call'
actionpack (8.0.3) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (8.0.3) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/cookies.rb:706:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (8.0.3) lib/active_support/callbacks.rb:100:in `run_callbacks'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (8.0.3) lib/rails/rack/logger.rb:41:in `call_app'
railties (8.0.3) lib/rails/rack/logger.rb:29:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/request_id.rb:34:in `call'
rack (3.2.1) lib/rack/method_override.rb:28:in `call'
rack (3.2.1) lib/rack/runtime.rb:24:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.2.1) lib/rack/sendfile.rb:114:in `call'
railties (8.0.3) lib/rails/engine.rb:535:in `call'
rack-test (2.2.0) lib/rack/test.rb:360:in `process_request'
rack-test (2.2.0) lib/rack/test.rb:153:in `request'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:297:in `process'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:37:in `put'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:388:in `put'
/home/micah/work/adva_comments/spec/requests/admin/comments_spec.rb:27:in `block (3 levels) in <top (required)>'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `block in run'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-rails (7.1.1) lib/rspec/rails/adapters.rb:75:in `block (2 levels) in <module:MinitestLifecycleAdapter>'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:390:in `execute_with'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `run'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:259:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:653:in `block in run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:614:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `map'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/configuration.rb:2097:in `with_suite_hooks'
rspec-core (3.13.5) lib/rspec/core/runner.rb:116:in `block in run_specs'
rspec-core (3.13.5) lib/rspec/core/reporter.rb:74:in `report'
rspec-core (3.13.5) lib/rspec/core/runner.rb:115:in `run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:89:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:71:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:45:in `invoke'
rspec-core (3.13.5) exe/rspec:4:in `<top (required)>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `load'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `<main>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `eval'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `<main>'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started DELETE "/admin/comments/1" for 127.0.0.1 at 2025-09-28 19:39:25 -0400
Processing by Admin::CommentsController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[36mContent Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 3]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 2]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 4]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 11ms (ActiveRecord: 0.9ms (20 queries, 0 cached) | GC: 1.9ms)
  
ArgumentError (wrong number of arguments (given 2, expected 0..1)):
  
activerecord (8.0.3) lib/active_record/inheritance.rb:56:in `new'
activerecord (8.0.3) lib/active_record/aggregations.rb:254:in `block in reader_method'
/home/micah/work/adva_comments/app/observers/activities/comment_observer.rb:68:in `block in initialize_activity'
<internal:kernel>:90:in `tap'
/home/micah/work/adva_comments/app/observers/activities/comment_observer.rb:65:in `initialize_activity'
/home/micah/work/adva_comments/app/observers/activities/comment_observer.rb:50:in `prepare_activity_logging'
/home/micah/work/adva_comments/app/observers/activities/comment_observer.rb:43:in `after_destroy'
rails-observers (0.1.5) lib/rails/observers/active_model/observing.rb:352:in `update'
rails-observers (0.1.5) lib/rails/observers/activerecord/observer.rb:118:in `block (2 levels) in define_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:361:in `block in make_lambda'
activesupport (8.0.3) lib/active_support/callbacks.rb:207:in `call'
activesupport (8.0.3) lib/active_support/callbacks.rb:563:in `block in invoke_after'
activesupport (8.0.3) lib/active_support/callbacks.rb:563:in `each'
activesupport (8.0.3) lib/active_support/callbacks.rb:563:in `invoke_after'
activesupport (8.0.3) lib/active_support/callbacks.rb:110:in `run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:913:in `_run_destroy_callbacks'
activerecord (8.0.3) lib/active_record/callbacks.rb:423:in `destroy'
activerecord (8.0.3) lib/active_record/transactions.rb:357:in `block in destroy'
activerecord (8.0.3) lib/active_record/transactions.rb:417:in `block (2 levels) in with_transaction_returning_status'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/transaction.rb:626:in `block in within_new_transaction'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:23:in `handle_interrupt'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:23:in `block in synchronize'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:19:in `handle_interrupt'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:19:in `synchronize'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/transaction.rb:623:in `within_new_transaction'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/database_statements.rb:367:in `within_new_transaction'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/database_statements.rb:359:in `transaction'
activerecord (8.0.3) lib/active_record/transactions.rb:413:in `block in with_transaction_returning_status'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/connection_pool.rb:416:in `with_connection'
activerecord (8.0.3) lib/active_record/connection_handling.rb:310:in `with_connection'
activerecord (8.0.3) lib/active_record/transactions.rb:409:in `with_transaction_returning_status'
activerecord (8.0.3) lib/active_record/transactions.rb:357:in `destroy'
/home/micah/work/adva_comments/app/controllers/admin/comments_controller.rb:35:in `destroy'
actionpack (8.0.3) lib/action_controller/metal/basic_implicit_render.rb:8:in `send_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:215:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:193:in `process_action'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:261:in `block in process_action'
activesupport (8.0.3) lib/active_support/callbacks.rb:120:in `block in run_callbacks'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/controller.rb:8:in `write_flash_to_cookie'
activesupport (8.0.3) lib/active_support/callbacks.rb:129:in `block in run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:140:in `run_callbacks'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:76:in `block in process_action'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:75:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:152:in `process'
actionview (8.0.3) lib/action_view/rendering.rb:40:in `process'
actionpack (8.0.3) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (8.0.3) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:908:in `call'
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:60:in `call'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/middleware.rb:8:in `call'
rack (3.2.1) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.2.1) lib/rack/etag.rb:29:in `call'
rack (3.2.1) lib/rack/conditional_get.rb:44:in `call'
rack (3.2.1) lib/rack/head.rb:15:in `call'
actionpack (8.0.3) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (8.0.3) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/cookies.rb:706:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (8.0.3) lib/active_support/callbacks.rb:100:in `run_callbacks'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (8.0.3) lib/rails/rack/logger.rb:41:in `call_app'
railties (8.0.3) lib/rails/rack/logger.rb:29:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/request_id.rb:34:in `call'
rack (3.2.1) lib/rack/method_override.rb:28:in `call'
rack (3.2.1) lib/rack/runtime.rb:24:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.2.1) lib/rack/sendfile.rb:114:in `call'
railties (8.0.3) lib/rails/engine.rb:535:in `call'
rack-test (2.2.0) lib/rack/test.rb:360:in `process_request'
rack-test (2.2.0) lib/rack/test.rb:153:in `request'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:297:in `process'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:43:in `delete'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:388:in `delete'
/home/micah/work/adva_comments/spec/requests/admin/comments_spec.rb:35:in `block (3 levels) in <top (required)>'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `block in run'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-rails (7.1.1) lib/rspec/rails/adapters.rb:75:in `block (2 levels) in <module:MinitestLifecycleAdapter>'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:390:in `execute_with'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `run'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:259:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:653:in `block in run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:614:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `map'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/configuration.rb:2097:in `with_suite_hooks'
rspec-core (3.13.5) lib/rspec/core/runner.rb:116:in `block in run_specs'
rspec-core (3.13.5) lib/rspec/core/reporter.rb:74:in `report'
rspec-core (3.13.5) lib/rspec/core/runner.rb:115:in `run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:89:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:71:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:45:in `invoke'
rspec-core (3.13.5) exe/rspec:4:in `<top (required)>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `load'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `<main>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `eval'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `<main>'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments/preview" for 127.0.0.1 at 2025-09-28 19:39:26 -0400
Processing by CommentsController#preview as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"Previewer", "author_email"=>"preview@example.com", "body"=>"Hello preview"}}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
  Rendering /home/micah/work/adva_comments/app/views/comments/preview.html.erb
  Rendered /home/micah/work/adva_comments/app/views/comments/preview.html.erb (Duration: 0.1ms | GC: 0.0ms)
Completed 200 OK in 5ms (Views: 0.9ms | ActiveRecord: 0.5ms (6 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments" for 127.0.0.1 at 2025-09-28 19:39:26 -0400
Processing by CommentsController#create as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"New Author", "author_email"=>"new@example.com", "body"=>"New comment body"}}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
[Invisible Captcha] Potential spam detected for IP 127.0.0.1. Timestamp not found in session.
Redirected to http://test-site.com/ref
Filter chain halted as #<Proc:0x00007d479f902888 /home/micah/.rvm/gems/ruby-3.3.4/gems/invisible_captcha-2.3.0/lib/invisible_captcha/controller_ext.rb:12> rendered or redirected
Completed 302 Found in 3ms (ActiveRecord: 0.3ms (6 queries, 0 cached) | GC: 0.2ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (6.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "counters"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "counters" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "owner_type" varchar, "owner_id" integer, "name" varchar(25), "count" integer DEFAULT 0)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_counters_on_owner" ON "counters" ("owner_type", "owner_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.1ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:40:07.906434"], ["updated_at", "2025-09-28 23:40:07.906434"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:40:07.916697"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:40:07.917665"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:40:07.920102"], ["created_at", "2025-09-28 23:40:07.924378"], ["updated_at", "2025-09-28 23:40:07.924378"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:40:07.944974"], ["updated_at", "2025-09-28 23:40:07.944974"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:40:07.946894"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:40:07.979854"], ["updated_at", "2025-09-28 23:40:07.979854"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.0ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:40:07.988057"], ["id", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:40:07.988580"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started PUT "/admin/comments/1" for 127.0.0.1 at 2025-09-28 19:40:08 -0400
Processing by Admin::CommentsController#update as HTML
  Parameters: {"comment"=>{"body"=>"updated comment body"}, "id"=>"1"}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mContent Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 17ms (ActiveRecord: 0.8ms (6 queries, 0 cached) | GC: 7.3ms)
  
ArgumentError (wrong number of arguments (given 2, expected 0..1)):
  
activerecord (8.0.3) lib/active_record/inheritance.rb:56:in `new'
activerecord (8.0.3) lib/active_record/aggregations.rb:254:in `block in reader_method'
/home/micah/work/adva_comments/app/observers/activities/comment_observer.rb:68:in `block in initialize_activity'
<internal:kernel>:90:in `tap'
/home/micah/work/adva_comments/app/observers/activities/comment_observer.rb:65:in `initialize_activity'
/home/micah/work/adva_comments/app/observers/activities/comment_observer.rb:50:in `prepare_activity_logging'
/home/micah/work/adva_comments/app/observers/activities/comment_observer.rb:35:in `before_save'
rails-observers (0.1.5) lib/rails/observers/active_model/observing.rb:352:in `update'
rails-observers (0.1.5) lib/rails/observers/activerecord/observer.rb:118:in `block (2 levels) in define_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:361:in `block in make_lambda'
activesupport (8.0.3) lib/active_support/callbacks.rb:178:in `block in call'
activesupport (8.0.3) lib/active_support/callbacks.rb:668:in `block (2 levels) in default_terminator'
activesupport (8.0.3) lib/active_support/callbacks.rb:667:in `catch'
activesupport (8.0.3) lib/active_support/callbacks.rb:667:in `block in default_terminator'
activesupport (8.0.3) lib/active_support/callbacks.rb:179:in `call'
activesupport (8.0.3) lib/active_support/callbacks.rb:559:in `block in invoke_before'
activesupport (8.0.3) lib/active_support/callbacks.rb:559:in `each'
activesupport (8.0.3) lib/active_support/callbacks.rb:559:in `invoke_before'
activesupport (8.0.3) lib/active_support/callbacks.rb:118:in `block in run_callbacks'
activerecord (8.0.3) lib/active_record/autosave_association.rb:406:in `around_save_collection_association'
activesupport (8.0.3) lib/active_support/callbacks.rb:129:in `block in run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:140:in `run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:913:in `_run_save_callbacks'
activerecord (8.0.3) lib/active_record/callbacks.rb:441:in `create_or_update'
activerecord (8.0.3) lib/active_record/timestamp.rb:127:in `create_or_update'
activerecord (8.0.3) lib/active_record/persistence.rb:391:in `save'
activerecord (8.0.3) lib/active_record/validations.rb:48:in `save'
activerecord (8.0.3) lib/active_record/transactions.rb:361:in `block in save'
activerecord (8.0.3) lib/active_record/transactions.rb:417:in `block (2 levels) in with_transaction_returning_status'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/transaction.rb:626:in `block in within_new_transaction'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:23:in `handle_interrupt'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:23:in `block in synchronize'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:19:in `handle_interrupt'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:19:in `synchronize'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/transaction.rb:623:in `within_new_transaction'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/database_statements.rb:367:in `within_new_transaction'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/database_statements.rb:359:in `transaction'
activerecord (8.0.3) lib/active_record/transactions.rb:413:in `block in with_transaction_returning_status'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/connection_pool.rb:416:in `with_connection'
activerecord (8.0.3) lib/active_record/connection_handling.rb:310:in `with_connection'
activerecord (8.0.3) lib/active_record/transactions.rb:409:in `with_transaction_returning_status'
activerecord (8.0.3) lib/active_record/transactions.rb:361:in `save'
activerecord (8.0.3) lib/active_record/suppressor.rb:52:in `save'
/home/micah/work/adva_comments/app/controllers/admin/comments_controller.rb:24:in `update'
actionpack (8.0.3) lib/action_controller/metal/basic_implicit_render.rb:8:in `send_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:215:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:193:in `process_action'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:261:in `block in process_action'
activesupport (8.0.3) lib/active_support/callbacks.rb:120:in `block in run_callbacks'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/controller.rb:8:in `write_flash_to_cookie'
activesupport (8.0.3) lib/active_support/callbacks.rb:129:in `block in run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:140:in `run_callbacks'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:76:in `block in process_action'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:75:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:152:in `process'
actionview (8.0.3) lib/action_view/rendering.rb:40:in `process'
actionpack (8.0.3) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (8.0.3) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:908:in `call'
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:60:in `call'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/middleware.rb:8:in `call'
rack (3.2.1) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.2.1) lib/rack/etag.rb:29:in `call'
rack (3.2.1) lib/rack/conditional_get.rb:44:in `call'
rack (3.2.1) lib/rack/head.rb:15:in `call'
actionpack (8.0.3) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (8.0.3) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/cookies.rb:706:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (8.0.3) lib/active_support/callbacks.rb:100:in `run_callbacks'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (8.0.3) lib/rails/rack/logger.rb:41:in `call_app'
railties (8.0.3) lib/rails/rack/logger.rb:29:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/request_id.rb:34:in `call'
rack (3.2.1) lib/rack/method_override.rb:28:in `call'
rack (3.2.1) lib/rack/runtime.rb:24:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.2.1) lib/rack/sendfile.rb:114:in `call'
railties (8.0.3) lib/rails/engine.rb:535:in `call'
rack-test (2.2.0) lib/rack/test.rb:360:in `process_request'
rack-test (2.2.0) lib/rack/test.rb:153:in `request'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:297:in `process'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:37:in `put'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:388:in `put'
/home/micah/work/adva_comments/spec/requests/admin/comments_spec.rb:28:in `block (3 levels) in <top (required)>'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `block in run'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-rails (7.1.1) lib/rspec/rails/adapters.rb:75:in `block (2 levels) in <module:MinitestLifecycleAdapter>'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:390:in `execute_with'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `run'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:259:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:653:in `block in run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:614:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `map'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/configuration.rb:2097:in `with_suite_hooks'
rspec-core (3.13.5) lib/rspec/core/runner.rb:116:in `block in run_specs'
rspec-core (3.13.5) lib/rspec/core/reporter.rb:74:in `report'
rspec-core (3.13.5) lib/rspec/core/runner.rb:115:in `run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:89:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:71:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:45:in `invoke'
rspec-core (3.13.5) exe/rspec:4:in `<top (required)>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `load'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `<main>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `eval'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `<main>'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started DELETE "/admin/comments/1" for 127.0.0.1 at 2025-09-28 19:40:08 -0400
Processing by Admin::CommentsController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[36mContent Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 3]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 2]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.0ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 4]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 9ms (ActiveRecord: 0.9ms (20 queries, 0 cached) | GC: 0.2ms)
  
ArgumentError (wrong number of arguments (given 2, expected 0..1)):
  
activerecord (8.0.3) lib/active_record/inheritance.rb:56:in `new'
activerecord (8.0.3) lib/active_record/aggregations.rb:254:in `block in reader_method'
/home/micah/work/adva_comments/app/observers/activities/comment_observer.rb:68:in `block in initialize_activity'
<internal:kernel>:90:in `tap'
/home/micah/work/adva_comments/app/observers/activities/comment_observer.rb:65:in `initialize_activity'
/home/micah/work/adva_comments/app/observers/activities/comment_observer.rb:50:in `prepare_activity_logging'
/home/micah/work/adva_comments/app/observers/activities/comment_observer.rb:43:in `after_destroy'
rails-observers (0.1.5) lib/rails/observers/active_model/observing.rb:352:in `update'
rails-observers (0.1.5) lib/rails/observers/activerecord/observer.rb:118:in `block (2 levels) in define_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:361:in `block in make_lambda'
activesupport (8.0.3) lib/active_support/callbacks.rb:207:in `call'
activesupport (8.0.3) lib/active_support/callbacks.rb:563:in `block in invoke_after'
activesupport (8.0.3) lib/active_support/callbacks.rb:563:in `each'
activesupport (8.0.3) lib/active_support/callbacks.rb:563:in `invoke_after'
activesupport (8.0.3) lib/active_support/callbacks.rb:110:in `run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:913:in `_run_destroy_callbacks'
activerecord (8.0.3) lib/active_record/callbacks.rb:423:in `destroy'
activerecord (8.0.3) lib/active_record/transactions.rb:357:in `block in destroy'
activerecord (8.0.3) lib/active_record/transactions.rb:417:in `block (2 levels) in with_transaction_returning_status'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/transaction.rb:626:in `block in within_new_transaction'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:23:in `handle_interrupt'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:23:in `block in synchronize'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:19:in `handle_interrupt'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:19:in `synchronize'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/transaction.rb:623:in `within_new_transaction'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/database_statements.rb:367:in `within_new_transaction'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/database_statements.rb:359:in `transaction'
activerecord (8.0.3) lib/active_record/transactions.rb:413:in `block in with_transaction_returning_status'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/connection_pool.rb:416:in `with_connection'
activerecord (8.0.3) lib/active_record/connection_handling.rb:310:in `with_connection'
activerecord (8.0.3) lib/active_record/transactions.rb:409:in `with_transaction_returning_status'
activerecord (8.0.3) lib/active_record/transactions.rb:357:in `destroy'
/home/micah/work/adva_comments/app/controllers/admin/comments_controller.rb:35:in `destroy'
actionpack (8.0.3) lib/action_controller/metal/basic_implicit_render.rb:8:in `send_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:215:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:193:in `process_action'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:261:in `block in process_action'
activesupport (8.0.3) lib/active_support/callbacks.rb:120:in `block in run_callbacks'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/controller.rb:8:in `write_flash_to_cookie'
activesupport (8.0.3) lib/active_support/callbacks.rb:129:in `block in run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:140:in `run_callbacks'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:76:in `block in process_action'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:75:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:152:in `process'
actionview (8.0.3) lib/action_view/rendering.rb:40:in `process'
actionpack (8.0.3) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (8.0.3) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:908:in `call'
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:60:in `call'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/middleware.rb:8:in `call'
rack (3.2.1) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.2.1) lib/rack/etag.rb:29:in `call'
rack (3.2.1) lib/rack/conditional_get.rb:44:in `call'
rack (3.2.1) lib/rack/head.rb:15:in `call'
actionpack (8.0.3) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (8.0.3) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/cookies.rb:706:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (8.0.3) lib/active_support/callbacks.rb:100:in `run_callbacks'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (8.0.3) lib/rails/rack/logger.rb:41:in `call_app'
railties (8.0.3) lib/rails/rack/logger.rb:29:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/request_id.rb:34:in `call'
rack (3.2.1) lib/rack/method_override.rb:28:in `call'
rack (3.2.1) lib/rack/runtime.rb:24:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.2.1) lib/rack/sendfile.rb:114:in `call'
railties (8.0.3) lib/rails/engine.rb:535:in `call'
rack-test (2.2.0) lib/rack/test.rb:360:in `process_request'
rack-test (2.2.0) lib/rack/test.rb:153:in `request'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:297:in `process'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:43:in `delete'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:388:in `delete'
/home/micah/work/adva_comments/spec/requests/admin/comments_spec.rb:37:in `block (3 levels) in <top (required)>'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `block in run'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-rails (7.1.1) lib/rspec/rails/adapters.rb:75:in `block (2 levels) in <module:MinitestLifecycleAdapter>'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:390:in `execute_with'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `run'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:259:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:653:in `block in run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:614:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `map'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/configuration.rb:2097:in `with_suite_hooks'
rspec-core (3.13.5) lib/rspec/core/runner.rb:116:in `block in run_specs'
rspec-core (3.13.5) lib/rspec/core/reporter.rb:74:in `report'
rspec-core (3.13.5) lib/rspec/core/runner.rb:115:in `run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:89:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:71:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:45:in `invoke'
rspec-core (3.13.5) exe/rspec:4:in `<top (required)>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `load'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `<main>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `eval'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `<main>'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments/preview" for 127.0.0.1 at 2025-09-28 19:40:08 -0400
Processing by CommentsController#preview as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"Previewer", "author_email"=>"preview@example.com", "body"=>"Hello preview"}}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
  Rendering /home/micah/work/adva_comments/app/views/comments/preview.html.erb
  Rendered /home/micah/work/adva_comments/app/views/comments/preview.html.erb (Duration: 0.1ms | GC: 0.0ms)
Completed 200 OK in 5ms (Views: 0.9ms | ActiveRecord: 0.4ms (6 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments" for 127.0.0.1 at 2025-09-28 19:40:08 -0400
Processing by CommentsController#create as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"New Author", "author_email"=>"new@example.com", "body"=>"New comment body"}}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
[Invisible Captcha] Potential spam detected for IP 127.0.0.1. Timestamp not found in session.
Redirected to http://test-site.com/ref
Filter chain halted as #<Proc:0x00007e36689324d0 /home/micah/.rvm/gems/ruby-3.3.4/gems/invisible_captcha-2.3.0/lib/invisible_captcha/controller_ext.rb:12> rendered or redirected
Completed 302 Found in 3ms (ActiveRecord: 0.4ms (6 queries, 0 cached) | GC: 0.3ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (9.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "counters"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "counters" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "owner_type" varchar, "owner_id" integer, "name" varchar(25), "count" integer DEFAULT 0)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_counters_on_owner" ON "counters" ("owner_type", "owner_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.1ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:40:43.969055"], ["updated_at", "2025-09-28 23:40:43.969055"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:40:43.979986"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:40:43.980729"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:40:43.983369"], ["created_at", "2025-09-28 23:40:43.987325"], ["updated_at", "2025-09-28 23:40:43.987325"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:40:44.009895"], ["updated_at", "2025-09-28 23:40:44.009895"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:40:44.011694"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:40:44.039454"], ["updated_at", "2025-09-28 23:40:44.039454"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.2ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 2]]
  [1m[36mArticle Update (0.2ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:40:44.054218"], ["id", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:40:44.054997"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started PUT "/admin/comments/1" for 127.0.0.1 at 2025-09-28 19:40:44 -0400
Processing by Admin::CommentsController#update as HTML
  Parameters: {"comment"=>{"body"=>"updated comment body"}, "id"=>"1"}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 20ms (ActiveRecord: 0.7ms (6 queries, 0 cached) | GC: 8.1ms)
  
ArgumentError (wrong number of arguments (given 2, expected 0..1)):
  
activerecord (8.0.3) lib/active_record/inheritance.rb:56:in `new'
activerecord (8.0.3) lib/active_record/aggregations.rb:254:in `block in reader_method'
/home/micah/work/adva_comments/app/observers/activities/comment_observer.rb:68:in `block in initialize_activity'
<internal:kernel>:90:in `tap'
/home/micah/work/adva_comments/app/observers/activities/comment_observer.rb:65:in `initialize_activity'
/home/micah/work/adva_comments/app/observers/activities/comment_observer.rb:50:in `prepare_activity_logging'
/home/micah/work/adva_comments/app/observers/activities/comment_observer.rb:35:in `before_save'
rails-observers (0.1.5) lib/rails/observers/active_model/observing.rb:352:in `update'
rails-observers (0.1.5) lib/rails/observers/activerecord/observer.rb:118:in `block (2 levels) in define_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:361:in `block in make_lambda'
activesupport (8.0.3) lib/active_support/callbacks.rb:178:in `block in call'
activesupport (8.0.3) lib/active_support/callbacks.rb:668:in `block (2 levels) in default_terminator'
activesupport (8.0.3) lib/active_support/callbacks.rb:667:in `catch'
activesupport (8.0.3) lib/active_support/callbacks.rb:667:in `block in default_terminator'
activesupport (8.0.3) lib/active_support/callbacks.rb:179:in `call'
activesupport (8.0.3) lib/active_support/callbacks.rb:559:in `block in invoke_before'
activesupport (8.0.3) lib/active_support/callbacks.rb:559:in `each'
activesupport (8.0.3) lib/active_support/callbacks.rb:559:in `invoke_before'
activesupport (8.0.3) lib/active_support/callbacks.rb:118:in `block in run_callbacks'
activerecord (8.0.3) lib/active_record/autosave_association.rb:406:in `around_save_collection_association'
activesupport (8.0.3) lib/active_support/callbacks.rb:129:in `block in run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:140:in `run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:913:in `_run_save_callbacks'
activerecord (8.0.3) lib/active_record/callbacks.rb:441:in `create_or_update'
activerecord (8.0.3) lib/active_record/timestamp.rb:127:in `create_or_update'
activerecord (8.0.3) lib/active_record/persistence.rb:391:in `save'
activerecord (8.0.3) lib/active_record/validations.rb:48:in `save'
activerecord (8.0.3) lib/active_record/transactions.rb:361:in `block in save'
activerecord (8.0.3) lib/active_record/transactions.rb:417:in `block (2 levels) in with_transaction_returning_status'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/transaction.rb:626:in `block in within_new_transaction'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:23:in `handle_interrupt'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:23:in `block in synchronize'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:19:in `handle_interrupt'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:19:in `synchronize'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/transaction.rb:623:in `within_new_transaction'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/database_statements.rb:367:in `within_new_transaction'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/database_statements.rb:359:in `transaction'
activerecord (8.0.3) lib/active_record/transactions.rb:413:in `block in with_transaction_returning_status'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/connection_pool.rb:416:in `with_connection'
activerecord (8.0.3) lib/active_record/connection_handling.rb:310:in `with_connection'
activerecord (8.0.3) lib/active_record/transactions.rb:409:in `with_transaction_returning_status'
activerecord (8.0.3) lib/active_record/transactions.rb:361:in `save'
activerecord (8.0.3) lib/active_record/suppressor.rb:52:in `save'
/home/micah/work/adva_comments/app/controllers/admin/comments_controller.rb:24:in `update'
actionpack (8.0.3) lib/action_controller/metal/basic_implicit_render.rb:8:in `send_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:215:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:193:in `process_action'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:261:in `block in process_action'
activesupport (8.0.3) lib/active_support/callbacks.rb:120:in `block in run_callbacks'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/controller.rb:8:in `write_flash_to_cookie'
activesupport (8.0.3) lib/active_support/callbacks.rb:129:in `block in run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:140:in `run_callbacks'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:76:in `block in process_action'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:75:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:152:in `process'
actionview (8.0.3) lib/action_view/rendering.rb:40:in `process'
actionpack (8.0.3) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (8.0.3) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:908:in `call'
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:60:in `call'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/middleware.rb:8:in `call'
rack (3.2.1) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.2.1) lib/rack/etag.rb:29:in `call'
rack (3.2.1) lib/rack/conditional_get.rb:44:in `call'
rack (3.2.1) lib/rack/head.rb:15:in `call'
actionpack (8.0.3) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (8.0.3) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/cookies.rb:706:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (8.0.3) lib/active_support/callbacks.rb:100:in `run_callbacks'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (8.0.3) lib/rails/rack/logger.rb:41:in `call_app'
railties (8.0.3) lib/rails/rack/logger.rb:29:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/request_id.rb:34:in `call'
rack (3.2.1) lib/rack/method_override.rb:28:in `call'
rack (3.2.1) lib/rack/runtime.rb:24:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.2.1) lib/rack/sendfile.rb:114:in `call'
railties (8.0.3) lib/rails/engine.rb:535:in `call'
rack-test (2.2.0) lib/rack/test.rb:360:in `process_request'
rack-test (2.2.0) lib/rack/test.rb:153:in `request'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:297:in `process'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:37:in `put'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:388:in `put'
/home/micah/work/adva_comments/spec/requests/admin/comments_spec.rb:27:in `block (3 levels) in <top (required)>'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `block in run'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-rails (7.1.1) lib/rspec/rails/adapters.rb:75:in `block (2 levels) in <module:MinitestLifecycleAdapter>'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:390:in `execute_with'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `run'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:259:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:653:in `block in run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:614:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `map'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/configuration.rb:2097:in `with_suite_hooks'
rspec-core (3.13.5) lib/rspec/core/runner.rb:116:in `block in run_specs'
rspec-core (3.13.5) lib/rspec/core/reporter.rb:74:in `report'
rspec-core (3.13.5) lib/rspec/core/runner.rb:115:in `run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:89:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:71:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:45:in `invoke'
rspec-core (3.13.5) exe/rspec:4:in `<top (required)>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `load'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `<main>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `eval'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `<main>'
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started DELETE "/admin/comments/1" for 127.0.0.1 at 2025-09-28 19:40:44 -0400
Processing by Admin::CommentsController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 3]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 2]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.1ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 4]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 12ms (ActiveRecord: 1.2ms (20 queries, 0 cached) | GC: 0.1ms)
  
ArgumentError (wrong number of arguments (given 2, expected 0..1)):
  
activerecord (8.0.3) lib/active_record/inheritance.rb:56:in `new'
activerecord (8.0.3) lib/active_record/aggregations.rb:254:in `block in reader_method'
/home/micah/work/adva_comments/app/observers/activities/comment_observer.rb:68:in `block in initialize_activity'
<internal:kernel>:90:in `tap'
/home/micah/work/adva_comments/app/observers/activities/comment_observer.rb:65:in `initialize_activity'
/home/micah/work/adva_comments/app/observers/activities/comment_observer.rb:50:in `prepare_activity_logging'
/home/micah/work/adva_comments/app/observers/activities/comment_observer.rb:43:in `after_destroy'
rails-observers (0.1.5) lib/rails/observers/active_model/observing.rb:352:in `update'
rails-observers (0.1.5) lib/rails/observers/activerecord/observer.rb:118:in `block (2 levels) in define_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:361:in `block in make_lambda'
activesupport (8.0.3) lib/active_support/callbacks.rb:207:in `call'
activesupport (8.0.3) lib/active_support/callbacks.rb:563:in `block in invoke_after'
activesupport (8.0.3) lib/active_support/callbacks.rb:563:in `each'
activesupport (8.0.3) lib/active_support/callbacks.rb:563:in `invoke_after'
activesupport (8.0.3) lib/active_support/callbacks.rb:110:in `run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:913:in `_run_destroy_callbacks'
activerecord (8.0.3) lib/active_record/callbacks.rb:423:in `destroy'
activerecord (8.0.3) lib/active_record/transactions.rb:357:in `block in destroy'
activerecord (8.0.3) lib/active_record/transactions.rb:417:in `block (2 levels) in with_transaction_returning_status'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/transaction.rb:626:in `block in within_new_transaction'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:23:in `handle_interrupt'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:23:in `block in synchronize'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:19:in `handle_interrupt'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:19:in `synchronize'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/transaction.rb:623:in `within_new_transaction'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/database_statements.rb:367:in `within_new_transaction'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/database_statements.rb:359:in `transaction'
activerecord (8.0.3) lib/active_record/transactions.rb:413:in `block in with_transaction_returning_status'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/connection_pool.rb:416:in `with_connection'
activerecord (8.0.3) lib/active_record/connection_handling.rb:310:in `with_connection'
activerecord (8.0.3) lib/active_record/transactions.rb:409:in `with_transaction_returning_status'
activerecord (8.0.3) lib/active_record/transactions.rb:357:in `destroy'
/home/micah/work/adva_comments/app/controllers/admin/comments_controller.rb:35:in `destroy'
actionpack (8.0.3) lib/action_controller/metal/basic_implicit_render.rb:8:in `send_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:215:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:193:in `process_action'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:261:in `block in process_action'
activesupport (8.0.3) lib/active_support/callbacks.rb:120:in `block in run_callbacks'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/controller.rb:8:in `write_flash_to_cookie'
activesupport (8.0.3) lib/active_support/callbacks.rb:129:in `block in run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:140:in `run_callbacks'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:76:in `block in process_action'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:75:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:152:in `process'
actionview (8.0.3) lib/action_view/rendering.rb:40:in `process'
actionpack (8.0.3) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (8.0.3) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:908:in `call'
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:60:in `call'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/middleware.rb:8:in `call'
rack (3.2.1) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.2.1) lib/rack/etag.rb:29:in `call'
rack (3.2.1) lib/rack/conditional_get.rb:44:in `call'
rack (3.2.1) lib/rack/head.rb:15:in `call'
actionpack (8.0.3) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (8.0.3) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/cookies.rb:706:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (8.0.3) lib/active_support/callbacks.rb:100:in `run_callbacks'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (8.0.3) lib/rails/rack/logger.rb:41:in `call_app'
railties (8.0.3) lib/rails/rack/logger.rb:29:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/request_id.rb:34:in `call'
rack (3.2.1) lib/rack/method_override.rb:28:in `call'
rack (3.2.1) lib/rack/runtime.rb:24:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.2.1) lib/rack/sendfile.rb:114:in `call'
railties (8.0.3) lib/rails/engine.rb:535:in `call'
rack-test (2.2.0) lib/rack/test.rb:360:in `process_request'
rack-test (2.2.0) lib/rack/test.rb:153:in `request'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:297:in `process'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:43:in `delete'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:388:in `delete'
/home/micah/work/adva_comments/spec/requests/admin/comments_spec.rb:35:in `block (3 levels) in <top (required)>'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `block in run'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-rails (7.1.1) lib/rspec/rails/adapters.rb:75:in `block (2 levels) in <module:MinitestLifecycleAdapter>'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:390:in `execute_with'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `run'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:259:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:653:in `block in run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:614:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `map'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/configuration.rb:2097:in `with_suite_hooks'
rspec-core (3.13.5) lib/rspec/core/runner.rb:116:in `block in run_specs'
rspec-core (3.13.5) lib/rspec/core/reporter.rb:74:in `report'
rspec-core (3.13.5) lib/rspec/core/runner.rb:115:in `run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:89:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:71:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:45:in `invoke'
rspec-core (3.13.5) exe/rspec:4:in `<top (required)>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `load'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `<main>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `eval'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `<main>'
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments/preview" for 127.0.0.1 at 2025-09-28 19:40:45 -0400
Processing by CommentsController#preview as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"Previewer", "author_email"=>"preview@example.com", "body"=>"Hello preview"}}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
  Rendering /home/micah/work/adva_comments/app/views/comments/preview.html.erb
  Rendered /home/micah/work/adva_comments/app/views/comments/preview.html.erb (Duration: 0.2ms | GC: 0.0ms)
Completed 200 OK in 8ms (Views: 1.4ms | ActiveRecord: 0.7ms (6 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments" for 127.0.0.1 at 2025-09-28 19:40:45 -0400
Processing by CommentsController#create as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"New Author", "author_email"=>"new@example.com", "body"=>"New comment body"}}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
[Invisible Captcha] Potential spam detected for IP 127.0.0.1. Timestamp not found in session.
Redirected to http://test-site.com/ref
Filter chain halted as #<Proc:0x00007ea06ef260d8 /home/micah/.rvm/gems/ruby-3.3.4/gems/invisible_captcha-2.3.0/lib/invisible_captcha/controller_ext.rb:12> rendered or redirected
Completed 302 Found in 3ms (ActiveRecord: 0.4ms (6 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (7.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "counters"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "counters" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "owner_type" varchar, "owner_id" integer, "name" varchar(25), "count" integer DEFAULT 0)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_counters_on_owner" ON "counters" ("owner_type", "owner_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.1ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:41:36.949131"], ["updated_at", "2025-09-28 23:41:36.949131"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:41:36.960593"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:41:36.961423"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:41:36.963801"], ["created_at", "2025-09-28 23:41:36.968017"], ["updated_at", "2025-09-28 23:41:36.968017"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:41:36.991048"], ["updated_at", "2025-09-28 23:41:36.991048"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:41:36.992733"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:41:37.033672"], ["updated_at", "2025-09-28 23:41:37.033672"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:41:37.043555"], ["id", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:41:37.044138"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started PUT "/admin/comments/1" for 127.0.0.1 at 2025-09-28 19:41:37 -0400
Processing by Admin::CommentsController#update as HTML
  Parameters: {"comment"=>{"body"=>"updated comment body"}, "id"=>"1"}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mContent Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 10ms (ActiveRecord: 0.7ms (6 queries, 0 cached) | GC: 0.0ms)
  
ArgumentError (wrong number of arguments (given 2, expected 0..1)):
  
activerecord (8.0.3) lib/active_record/inheritance.rb:56:in `new'
activerecord (8.0.3) lib/active_record/aggregations.rb:254:in `block in reader_method'
/home/micah/work/adva_comments/app/observers/activities/comment_observer.rb:68:in `block in initialize_activity'
<internal:kernel>:90:in `tap'
/home/micah/work/adva_comments/app/observers/activities/comment_observer.rb:65:in `initialize_activity'
/home/micah/work/adva_comments/app/observers/activities/comment_observer.rb:50:in `prepare_activity_logging'
/home/micah/work/adva_comments/app/observers/activities/comment_observer.rb:35:in `before_save'
rails-observers (0.1.5) lib/rails/observers/active_model/observing.rb:352:in `update'
rails-observers (0.1.5) lib/rails/observers/activerecord/observer.rb:118:in `block (2 levels) in define_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:361:in `block in make_lambda'
activesupport (8.0.3) lib/active_support/callbacks.rb:178:in `block in call'
activesupport (8.0.3) lib/active_support/callbacks.rb:668:in `block (2 levels) in default_terminator'
activesupport (8.0.3) lib/active_support/callbacks.rb:667:in `catch'
activesupport (8.0.3) lib/active_support/callbacks.rb:667:in `block in default_terminator'
activesupport (8.0.3) lib/active_support/callbacks.rb:179:in `call'
activesupport (8.0.3) lib/active_support/callbacks.rb:559:in `block in invoke_before'
activesupport (8.0.3) lib/active_support/callbacks.rb:559:in `each'
activesupport (8.0.3) lib/active_support/callbacks.rb:559:in `invoke_before'
activesupport (8.0.3) lib/active_support/callbacks.rb:118:in `block in run_callbacks'
activerecord (8.0.3) lib/active_record/autosave_association.rb:406:in `around_save_collection_association'
activesupport (8.0.3) lib/active_support/callbacks.rb:129:in `block in run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:140:in `run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:913:in `_run_save_callbacks'
activerecord (8.0.3) lib/active_record/callbacks.rb:441:in `create_or_update'
activerecord (8.0.3) lib/active_record/timestamp.rb:127:in `create_or_update'
activerecord (8.0.3) lib/active_record/persistence.rb:391:in `save'
activerecord (8.0.3) lib/active_record/validations.rb:48:in `save'
activerecord (8.0.3) lib/active_record/transactions.rb:361:in `block in save'
activerecord (8.0.3) lib/active_record/transactions.rb:417:in `block (2 levels) in with_transaction_returning_status'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/transaction.rb:626:in `block in within_new_transaction'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:23:in `handle_interrupt'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:23:in `block in synchronize'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:19:in `handle_interrupt'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:19:in `synchronize'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/transaction.rb:623:in `within_new_transaction'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/database_statements.rb:367:in `within_new_transaction'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/database_statements.rb:359:in `transaction'
activerecord (8.0.3) lib/active_record/transactions.rb:413:in `block in with_transaction_returning_status'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/connection_pool.rb:416:in `with_connection'
activerecord (8.0.3) lib/active_record/connection_handling.rb:310:in `with_connection'
activerecord (8.0.3) lib/active_record/transactions.rb:409:in `with_transaction_returning_status'
activerecord (8.0.3) lib/active_record/transactions.rb:361:in `save'
activerecord (8.0.3) lib/active_record/suppressor.rb:52:in `save'
/home/micah/work/adva_comments/app/controllers/admin/comments_controller.rb:24:in `update'
actionpack (8.0.3) lib/action_controller/metal/basic_implicit_render.rb:8:in `send_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:215:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:193:in `process_action'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:261:in `block in process_action'
activesupport (8.0.3) lib/active_support/callbacks.rb:120:in `block in run_callbacks'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/controller.rb:8:in `write_flash_to_cookie'
activesupport (8.0.3) lib/active_support/callbacks.rb:129:in `block in run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:140:in `run_callbacks'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:76:in `block in process_action'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:75:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:152:in `process'
actionview (8.0.3) lib/action_view/rendering.rb:40:in `process'
actionpack (8.0.3) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (8.0.3) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:908:in `call'
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:60:in `call'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/middleware.rb:8:in `call'
rack (3.2.1) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.2.1) lib/rack/etag.rb:29:in `call'
rack (3.2.1) lib/rack/conditional_get.rb:44:in `call'
rack (3.2.1) lib/rack/head.rb:15:in `call'
actionpack (8.0.3) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (8.0.3) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/cookies.rb:706:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (8.0.3) lib/active_support/callbacks.rb:100:in `run_callbacks'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (8.0.3) lib/rails/rack/logger.rb:41:in `call_app'
railties (8.0.3) lib/rails/rack/logger.rb:29:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/request_id.rb:34:in `call'
rack (3.2.1) lib/rack/method_override.rb:28:in `call'
rack (3.2.1) lib/rack/runtime.rb:24:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.2.1) lib/rack/sendfile.rb:114:in `call'
railties (8.0.3) lib/rails/engine.rb:535:in `call'
rack-test (2.2.0) lib/rack/test.rb:360:in `process_request'
rack-test (2.2.0) lib/rack/test.rb:153:in `request'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:297:in `process'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:37:in `put'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:388:in `put'
/home/micah/work/adva_comments/spec/requests/admin/comments_spec.rb:27:in `block (3 levels) in <top (required)>'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `block in run'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-rails (7.1.1) lib/rspec/rails/adapters.rb:75:in `block (2 levels) in <module:MinitestLifecycleAdapter>'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:390:in `execute_with'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `run'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:259:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:653:in `block in run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:614:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `map'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/configuration.rb:2097:in `with_suite_hooks'
rspec-core (3.13.5) lib/rspec/core/runner.rb:116:in `block in run_specs'
rspec-core (3.13.5) lib/rspec/core/reporter.rb:74:in `report'
rspec-core (3.13.5) lib/rspec/core/runner.rb:115:in `run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:89:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:71:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:45:in `invoke'
rspec-core (3.13.5) exe/rspec:4:in `<top (required)>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `load'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `<main>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `eval'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `<main>'
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started DELETE "/admin/comments/1" for 127.0.0.1 at 2025-09-28 19:41:37 -0400
Processing by Admin::CommentsController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.1ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 3]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 2]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 4]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 12ms (ActiveRecord: 1.1ms (20 queries, 0 cached) | GC: 0.0ms)
  
ArgumentError (wrong number of arguments (given 2, expected 0..1)):
  
activerecord (8.0.3) lib/active_record/inheritance.rb:56:in `new'
activerecord (8.0.3) lib/active_record/aggregations.rb:254:in `block in reader_method'
/home/micah/work/adva_comments/app/observers/activities/comment_observer.rb:68:in `block in initialize_activity'
<internal:kernel>:90:in `tap'
/home/micah/work/adva_comments/app/observers/activities/comment_observer.rb:65:in `initialize_activity'
/home/micah/work/adva_comments/app/observers/activities/comment_observer.rb:50:in `prepare_activity_logging'
/home/micah/work/adva_comments/app/observers/activities/comment_observer.rb:43:in `after_destroy'
rails-observers (0.1.5) lib/rails/observers/active_model/observing.rb:352:in `update'
rails-observers (0.1.5) lib/rails/observers/activerecord/observer.rb:118:in `block (2 levels) in define_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:361:in `block in make_lambda'
activesupport (8.0.3) lib/active_support/callbacks.rb:207:in `call'
activesupport (8.0.3) lib/active_support/callbacks.rb:563:in `block in invoke_after'
activesupport (8.0.3) lib/active_support/callbacks.rb:563:in `each'
activesupport (8.0.3) lib/active_support/callbacks.rb:563:in `invoke_after'
activesupport (8.0.3) lib/active_support/callbacks.rb:110:in `run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:913:in `_run_destroy_callbacks'
activerecord (8.0.3) lib/active_record/callbacks.rb:423:in `destroy'
activerecord (8.0.3) lib/active_record/transactions.rb:357:in `block in destroy'
activerecord (8.0.3) lib/active_record/transactions.rb:417:in `block (2 levels) in with_transaction_returning_status'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/transaction.rb:626:in `block in within_new_transaction'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:23:in `handle_interrupt'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:23:in `block in synchronize'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:19:in `handle_interrupt'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:19:in `synchronize'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/transaction.rb:623:in `within_new_transaction'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/database_statements.rb:367:in `within_new_transaction'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/database_statements.rb:359:in `transaction'
activerecord (8.0.3) lib/active_record/transactions.rb:413:in `block in with_transaction_returning_status'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/connection_pool.rb:416:in `with_connection'
activerecord (8.0.3) lib/active_record/connection_handling.rb:310:in `with_connection'
activerecord (8.0.3) lib/active_record/transactions.rb:409:in `with_transaction_returning_status'
activerecord (8.0.3) lib/active_record/transactions.rb:357:in `destroy'
/home/micah/work/adva_comments/app/controllers/admin/comments_controller.rb:35:in `destroy'
actionpack (8.0.3) lib/action_controller/metal/basic_implicit_render.rb:8:in `send_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:215:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:193:in `process_action'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:261:in `block in process_action'
activesupport (8.0.3) lib/active_support/callbacks.rb:120:in `block in run_callbacks'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/controller.rb:8:in `write_flash_to_cookie'
activesupport (8.0.3) lib/active_support/callbacks.rb:129:in `block in run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:140:in `run_callbacks'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:76:in `block in process_action'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:75:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:152:in `process'
actionview (8.0.3) lib/action_view/rendering.rb:40:in `process'
actionpack (8.0.3) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (8.0.3) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:908:in `call'
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:60:in `call'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/middleware.rb:8:in `call'
rack (3.2.1) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.2.1) lib/rack/etag.rb:29:in `call'
rack (3.2.1) lib/rack/conditional_get.rb:44:in `call'
rack (3.2.1) lib/rack/head.rb:15:in `call'
actionpack (8.0.3) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (8.0.3) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/cookies.rb:706:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (8.0.3) lib/active_support/callbacks.rb:100:in `run_callbacks'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (8.0.3) lib/rails/rack/logger.rb:41:in `call_app'
railties (8.0.3) lib/rails/rack/logger.rb:29:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/request_id.rb:34:in `call'
rack (3.2.1) lib/rack/method_override.rb:28:in `call'
rack (3.2.1) lib/rack/runtime.rb:24:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.2.1) lib/rack/sendfile.rb:114:in `call'
railties (8.0.3) lib/rails/engine.rb:535:in `call'
rack-test (2.2.0) lib/rack/test.rb:360:in `process_request'
rack-test (2.2.0) lib/rack/test.rb:153:in `request'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:297:in `process'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:43:in `delete'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:388:in `delete'
/home/micah/work/adva_comments/spec/requests/admin/comments_spec.rb:35:in `block (3 levels) in <top (required)>'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `block in run'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-rails (7.1.1) lib/rspec/rails/adapters.rb:75:in `block (2 levels) in <module:MinitestLifecycleAdapter>'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:390:in `execute_with'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `run'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:259:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:653:in `block in run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:614:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `map'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/configuration.rb:2097:in `with_suite_hooks'
rspec-core (3.13.5) lib/rspec/core/runner.rb:116:in `block in run_specs'
rspec-core (3.13.5) lib/rspec/core/reporter.rb:74:in `report'
rspec-core (3.13.5) lib/rspec/core/runner.rb:115:in `run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:89:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:71:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:45:in `invoke'
rspec-core (3.13.5) exe/rspec:4:in `<top (required)>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `load'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `<main>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `eval'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `<main>'
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments/preview" for 127.0.0.1 at 2025-09-28 19:41:38 -0400
Processing by CommentsController#preview as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"Previewer", "author_email"=>"preview@example.com", "body"=>"Hello preview"}}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
  Rendering /home/micah/work/adva_comments/app/views/comments/preview.html.erb
  Rendered /home/micah/work/adva_comments/app/views/comments/preview.html.erb (Duration: 1.1ms | GC: 0.9ms)
Completed 200 OK in 12ms (Views: 2.7ms | ActiveRecord: 0.5ms (6 queries, 0 cached) | GC: 6.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments" for 127.0.0.1 at 2025-09-28 19:41:38 -0400
Processing by CommentsController#create as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"New Author", "author_email"=>"new@example.com", "body"=>"New comment body"}}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.5ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
[Invisible Captcha] Potential spam detected for IP 127.0.0.1. Timestamp not found in session.
Redirected to http://test-site.com/ref
Filter chain halted as #<Proc:0x000074ed93ea3850 /home/micah/.rvm/gems/ruby-3.3.4/gems/invisible_captcha-2.3.0/lib/invisible_captcha/controller_ext.rb:12> rendered or redirected
Completed 302 Found in 6ms (ActiveRecord: 0.8ms (6 queries, 0 cached) | GC: 2.2ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (6.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "counters"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "counters" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "owner_type" varchar, "owner_id" integer, "name" varchar(25), "count" integer DEFAULT 0)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_counters_on_owner" ON "counters" ("owner_type", "owner_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.1ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:41:53.622658"], ["updated_at", "2025-09-28 23:41:53.622658"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:41:53.634486"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:41:53.635523"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:41:53.638119"], ["created_at", "2025-09-28 23:41:53.642669"], ["updated_at", "2025-09-28 23:41:53.642669"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:41:53.665806"], ["updated_at", "2025-09-28 23:41:53.665806"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:41:53.668023"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:41:53.717678"], ["updated_at", "2025-09-28 23:41:53.717678"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:41:53.746400"], ["id", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:41:53.746957"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments/preview" for 127.0.0.1 at 2025-09-28 19:41:53 -0400
Processing by CommentsController#preview as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"Previewer", "author_email"=>"preview@example.com", "body"=>"Hello preview"}}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
  Rendering /home/micah/work/adva_comments/app/views/comments/preview.html.erb
  Rendered /home/micah/work/adva_comments/app/views/comments/preview.html.erb (Duration: 0.2ms | GC: 0.0ms)
Completed 200 OK in 9ms (Views: 2.8ms | ActiveRecord: 0.5ms (6 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.3ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments" for 127.0.0.1 at 2025-09-28 19:41:53 -0400
Processing by CommentsController#create as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"New Author", "author_email"=>"new@example.com", "body"=>"New comment body"}}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
[Invisible Captcha] Potential spam detected for IP 127.0.0.1. Timestamp not found in session.
Redirected to http://test-site.com/ref
Filter chain halted as #<Proc:0x000075d99a8166d8 /home/micah/.rvm/gems/ruby-3.3.4/gems/invisible_captcha-2.3.0/lib/invisible_captcha/controller_ext.rb:12> rendered or redirected
Completed 302 Found in 4ms (ActiveRecord: 0.4ms (6 queries, 0 cached) | GC: 0.3ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (7.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "counters"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "counters" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "owner_type" varchar, "owner_id" integer, "name" varchar(25), "count" integer DEFAULT 0)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_counters_on_owner" ON "counters" ("owner_type", "owner_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.1ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:43:30.626637"], ["updated_at", "2025-09-28 23:43:30.626637"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.8ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:43:30.663562"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:43:30.664621"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:43:30.667509"], ["created_at", "2025-09-28 23:43:30.672603"], ["updated_at", "2025-09-28 23:43:30.672603"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:43:30.687736"], ["updated_at", "2025-09-28 23:43:30.687736"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:43:30.689570"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:43:30.723412"], ["updated_at", "2025-09-28 23:43:30.723412"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.0ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:43:30.731841"], ["id", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:43:30.732534"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments/preview" for 127.0.0.1 at 2025-09-28 19:43:30 -0400
Processing by CommentsController#preview as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"Previewer", "author_email"=>"preview@example.com", "body"=>"Hello preview"}}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
  Rendering /home/micah/work/adva_comments/app/views/comments/preview.html.erb
  Rendered /home/micah/work/adva_comments/app/views/comments/preview.html.erb (Duration: 0.2ms | GC: 0.0ms)
Completed 200 OK in 10ms (Views: 3.4ms | ActiveRecord: 0.5ms (6 queries, 0 cached) | GC: 0.7ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments" for 127.0.0.1 at 2025-09-28 19:43:30 -0400
Processing by CommentsController#create as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"New Author", "author_email"=>"new@example.com", "body"=>"New comment body"}}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
[Invisible Captcha] Potential spam detected for IP 127.0.0.1. Timestamp not found in session.
Redirected to http://test-site.com/ref
Filter chain halted as #<Proc:0x00007db3e9d76cf0 /home/micah/.rvm/gems/ruby-3.3.4/gems/invisible_captcha-2.3.0/lib/invisible_captcha/controller_ext.rb:12> rendered or redirected
Completed 302 Found in 10ms (ActiveRecord: 0.5ms (6 queries, 0 cached) | GC: 5.1ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (6.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "type" varchar, "object_attributes" text, "actions" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_author" ON "activities" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "counters"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "counters" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "owner_type" varchar, "owner_id" integer, "name" varchar(25), "count" integer DEFAULT 0)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_counters_on_owner" ON "counters" ("owner_type", "owner_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.1ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:49:24.222506"], ["updated_at", "2025-09-28 23:49:24.222506"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:49:24.234671"]]
  [1m[36mSite Update (0.1ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:49:24.235517"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:49:24.238082"], ["created_at", "2025-09-28 23:49:24.242834"], ["updated_at", "2025-09-28 23:49:24.242834"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:49:24.262297"], ["updated_at", "2025-09-28 23:49:24.262297"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:49:24.264677"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:49:24.306099"], ["updated_at", "2025-09-28 23:49:24.306099"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:49:24.315925"], ["id", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:49:24.316560"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Processing by Admin::CommentsController#update as HTML
  Parameters: {"comment"=>{"body"=>"updated comment body"}, "id"=>"1"}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mContent Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mComment Update (0.0ms)[0m  [1m[33mUPDATE "comments" SET "body" = ?, "updated_at" = ? WHERE "comments"."id" = ?[0m  [["body", "updated comment body"], ["updated_at", "2025-09-28 23:49:24.398177"], ["id", 1]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:49:24.398857"], ["id", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:49:24.399751"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/admin/comments
Completed 302 Found in 8ms (ActiveRecord: 0.8ms (10 queries, 0 cached) | GC: 0.1ms)
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Processing by Admin::CommentsController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 3]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 2]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.0ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 4]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/admin/comments
Completed 302 Found in 9ms (ActiveRecord: 0.9ms (18 queries, 0 cached) | GC: 0.1ms)
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mComment Create (0.1ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Observer Test"], ["author_email", "observer@example.com"], ["author_homepage", nil], ["body", "hello"], ["body_html", nil], ["approved", 0], ["created_at", "2025-09-28 23:49:24.481517"], ["updated_at", "2025-09-28 23:49:24.481517"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 2], ["id", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 2], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:49:24.484468"], ["id", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:49:24.485368"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mActivity Load (0.1ms)[0m  [1m[34mSELECT "activities".* FROM "activities" WHERE "activities"."object_id" = ? AND "activities"."object_type" = ? ORDER BY "activities"."id" ASC LIMIT ?[0m  [["object_id", 2], ["object_type", "Comment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments/preview" for 127.0.0.1 at 2025-09-28 19:49:24 -0400
Processing by CommentsController#preview as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"Previewer", "author_email"=>"preview@example.com", "body"=>"Hello preview"}}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.2ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
  Rendering /home/micah/work/adva_comments/app/views/comments/preview.html.erb
  Rendered /home/micah/work/adva_comments/app/views/comments/preview.html.erb (Duration: 0.2ms | GC: 0.0ms)
Completed 200 OK in 9ms (Views: 2.9ms | ActiveRecord: 0.6ms (6 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments" for 127.0.0.1 at 2025-09-28 19:49:24 -0400
Processing by CommentsController#create as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"New Author", "author_email"=>"new@example.com", "body"=>"New comment body"}}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.2ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
[Invisible Captcha] Potential spam detected for IP 127.0.0.1. Timestamp not found in session.
Redirected to http://test-site.com/ref
Filter chain halted as #<Proc:0x0000750682a8e758 /home/micah/.rvm/gems/ruby-3.3.4/gems/invisible_captcha-2.3.0/lib/invisible_captcha/controller_ext.rb:12> rendered or redirected
Completed 302 Found in 4ms (ActiveRecord: 0.5ms (6 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (7.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "type" varchar, "object_attributes" text, "actions" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_author" ON "activities" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "counters"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "counters" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "owner_type" varchar, "owner_id" integer, "name" varchar(25), "count" integer DEFAULT 0)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_counters_on_owner" ON "counters" ("owner_type", "owner_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.1ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:49:51.400839"], ["updated_at", "2025-09-28 23:49:51.400839"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.2ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:49:51.411408"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:49:51.412455"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:49:51.414904"], ["created_at", "2025-09-28 23:49:51.419164"], ["updated_at", "2025-09-28 23:49:51.419164"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:49:51.433306"], ["updated_at", "2025-09-28 23:49:51.433306"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:49:51.434894"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:49:51.472084"], ["updated_at", "2025-09-28 23:49:51.472084"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.0ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.0ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:49:51.480280"], ["id", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:49:51.480829"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSite Load (0.2ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mComment Create (0.1ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Observer Test"], ["author_email", "observer@example.com"], ["author_homepage", nil], ["body", "hello"], ["body_html", nil], ["approved", 0], ["created_at", "2025-09-28 23:49:51.495377"], ["updated_at", "2025-09-28 23:49:51.495377"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 2], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 2], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:49:51.497731"], ["id", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:49:51.498510"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mActivity Load (0.1ms)[0m  [1m[34mSELECT "activities".* FROM "activities" WHERE "activities"."object_id" = ? AND "activities"."object_type" = ? ORDER BY "activities"."id" ASC LIMIT ?[0m  [["object_id", 2], ["object_type", "Comment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (7.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "type" varchar, "object_attributes" text, "actions" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_author" ON "activities" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "counters"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "counters" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "owner_type" varchar, "owner_id" integer, "name" varchar(25), "count" integer DEFAULT 0)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_counters_on_owner" ON "counters" ("owner_type", "owner_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.1ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:50:06.748338"], ["updated_at", "2025-09-28 23:50:06.748338"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:50:06.763381"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:50:06.764656"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:50:06.767655"], ["created_at", "2025-09-28 23:50:06.773058"], ["updated_at", "2025-09-28 23:50:06.773058"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:50:06.790486"], ["updated_at", "2025-09-28 23:50:06.790486"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:50:06.793334"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (0.4ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:50:06.834145"], ["updated_at", "2025-09-28 23:50:06.834145"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:50:06.844461"], ["id", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:50:06.845079"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (7.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "type" varchar, "object_attributes" text, "actions" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_author" ON "activities" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "counters"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "counters" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "owner_type" varchar, "owner_id" integer, "name" varchar(25), "count" integer DEFAULT 0)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_counters_on_owner" ON "counters" ("owner_type", "owner_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.1ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:50:24.717946"], ["updated_at", "2025-09-28 23:50:24.717946"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:50:24.727615"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:50:24.728360"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:50:24.730524"], ["created_at", "2025-09-28 23:50:24.734349"], ["updated_at", "2025-09-28 23:50:24.734349"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:50:24.755989"], ["updated_at", "2025-09-28 23:50:24.755989"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:50:24.757697"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:50:24.784769"], ["updated_at", "2025-09-28 23:50:24.784769"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:50:24.799244"], ["id", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:50:24.799788"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSite Load (0.2ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (6.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "type" varchar, "object_attributes" text, "actions" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_author" ON "activities" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "counters"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "counters" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "owner_type" varchar, "owner_id" integer, "name" varchar(25), "count" integer DEFAULT 0)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_counters_on_owner" ON "counters" ("owner_type", "owner_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.1ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:50:47.038601"], ["updated_at", "2025-09-28 23:50:47.038601"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:50:47.077083"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:50:47.078673"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:50:47.081896"], ["created_at", "2025-09-28 23:50:47.087962"], ["updated_at", "2025-09-28 23:50:47.087962"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:50:47.106490"], ["updated_at", "2025-09-28 23:50:47.106490"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:50:47.108622"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:50:47.149679"], ["updated_at", "2025-09-28 23:50:47.149679"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:50:47.159831"], ["id", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:50:47.160497"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Processing by Admin::CommentsController#update as HTML
  Parameters: {"comment"=>{"body"=>"updated comment body"}, "id"=>"1"}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mContent Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mComment Update (0.1ms)[0m  [1m[33mUPDATE "comments" SET "body" = ?, "updated_at" = ? WHERE "comments"."id" = ?[0m  [["body", "updated comment body"], ["updated_at", "2025-09-28 23:50:47.232641"], ["id", 1]]
  [1m[36mArticle Update (0.1ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:50:47.233543"], ["id", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:50:47.234737"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/admin/comments
Completed 302 Found in 10ms (ActiveRecord: 1.0ms (10 queries, 0 cached) | GC: 0.0ms)
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Processing by Admin::CommentsController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 3]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 2]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 4]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/admin/comments
Completed 302 Found in 11ms (ActiveRecord: 1.0ms (18 queries, 0 cached) | GC: 0.0ms)
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.4ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSite Load (1.2ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments/preview" for 127.0.0.1 at 2025-09-28 19:50:47 -0400
Processing by CommentsController#preview as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"Previewer", "author_email"=>"preview@example.com", "body"=>"Hello preview"}}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.2ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
  Rendering /home/micah/work/adva_comments/app/views/comments/preview.html.erb
  Rendered /home/micah/work/adva_comments/app/views/comments/preview.html.erb (Duration: 0.4ms | GC: 0.0ms)
Completed 200 OK in 12ms (Views: 4.3ms | ActiveRecord: 0.7ms (6 queries, 0 cached) | GC: 0.3ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments" for 127.0.0.1 at 2025-09-28 19:50:47 -0400
Processing by CommentsController#create as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"New Author", "author_email"=>"new@example.com", "body"=>"New comment body"}}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
[Invisible Captcha] Potential spam detected for IP 127.0.0.1. Timestamp not found in session.
Redirected to http://test-site.com/ref
Filter chain halted as #<Proc:0x00007d8226e696c0 /home/micah/.rvm/gems/ruby-3.3.4/gems/invisible_captcha-2.3.0/lib/invisible_captcha/controller_ext.rb:12> rendered or redirected
Completed 302 Found in 4ms (ActiveRecord: 0.5ms (6 queries, 0 cached) | GC: 0.1ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (6.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "type" varchar, "object_attributes" text, "actions" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_author" ON "activities" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "counters"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "counters" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "owner_type" varchar, "owner_id" integer, "name" varchar(25), "count" integer DEFAULT 0)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_counters_on_owner" ON "counters" ("owner_type", "owner_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.1ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:51:04.933901"], ["updated_at", "2025-09-28 23:51:04.933901"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:51:04.945316"]]
  [1m[36mSite Update (0.1ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:51:04.946256"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:51:04.949158"], ["created_at", "2025-09-28 23:51:04.953939"], ["updated_at", "2025-09-28 23:51:04.953939"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:51:04.978686"], ["updated_at", "2025-09-28 23:51:04.978686"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:51:04.980571"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:51:05.019903"], ["updated_at", "2025-09-28 23:51:05.019903"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:51:05.030513"], ["id", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:51:05.031134"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSite Load (0.2ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.2ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Observer Test"], ["author_email", "observer@example.com"], ["author_homepage", nil], ["body", "hello"], ["body_html", nil], ["approved", 0], ["created_at", "2025-09-28 23:51:05.079966"], ["updated_at", "2025-09-28 23:51:05.079966"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 2], ["id", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 2], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:51:05.086036"], ["id", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (7.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "type" varchar, "object_attributes" text, "actions" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_author" ON "activities" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "counters"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "counters" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "owner_type" varchar, "owner_id" integer, "name" varchar(25), "count" integer DEFAULT 0)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_counters_on_owner" ON "counters" ("owner_type", "owner_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.3ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:51:22.661530"], ["updated_at", "2025-09-28 23:51:22.661530"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.2ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:51:22.681444"]]
  [1m[36mSite Update (0.1ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:51:22.682317"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:51:22.685150"], ["created_at", "2025-09-28 23:51:22.690043"], ["updated_at", "2025-09-28 23:51:22.690043"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:51:22.706565"], ["updated_at", "2025-09-28 23:51:22.706565"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:51:22.708380"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:51:22.746794"], ["updated_at", "2025-09-28 23:51:22.746794"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:51:22.755986"], ["id", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:51:22.756555"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSite Load (0.2ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.2ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mComment Create (0.1ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Observer Test"], ["author_email", "observer@example.com"], ["author_homepage", nil], ["body", "hello"], ["body_html", nil], ["approved", 0], ["created_at", "2025-09-28 23:51:22.780542"], ["updated_at", "2025-09-28 23:51:22.780542"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 2], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 2], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:51:22.783609"], ["id", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (7.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "type" varchar, "object_attributes" text, "actions" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_author" ON "activities" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "counters"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "counters" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "owner_type" varchar, "owner_id" integer, "name" varchar(25), "count" integer DEFAULT 0)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_counters_on_owner" ON "counters" ("owner_type", "owner_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.1ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:51:46.413898"], ["updated_at", "2025-09-28 23:51:46.413898"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:51:46.425684"]]
  [1m[36mSite Update (0.1ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:51:46.426576"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:51:46.429066"], ["created_at", "2025-09-28 23:51:46.433210"], ["updated_at", "2025-09-28 23:51:46.433210"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:51:46.455089"], ["updated_at", "2025-09-28 23:51:46.455089"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:51:46.456853"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:51:46.485482"], ["updated_at", "2025-09-28 23:51:46.485482"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.2ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 2]]
  [1m[36mArticle Update (0.1ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:51:46.502886"], ["id", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:51:46.503793"], ["id", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSite Load (0.2ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Observer Test"], ["author_email", "observer@example.com"], ["author_homepage", nil], ["body", "hello"], ["body_html", nil], ["approved", 0], ["created_at", "2025-09-28 23:51:46.530227"], ["updated_at", "2025-09-28 23:51:46.530227"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 2], ["id", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 2], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:51:46.533749"], ["id", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mActivity Create (0.3ms)[0m  [1m[32mINSERT INTO "activities" ("site_id", "section_id", "object_type", "object_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "type", "object_attributes", "actions", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["object_type", "Comment"], ["object_id", 2], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["type", nil], ["object_attributes", "---\ncommentable_id: 1\nbody: hello\nauthor_name: Observer Test\nauthor_email: observer@example.com\ncommentable_type: Article\ncommentable_title: Test Article\n"], ["actions", "---\n- created\n"], ["created_at", "2025-09-28 23:51:46.537364"], ["updated_at", "2025-09-28 23:51:46.537364"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (6.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "type" varchar, "object_attributes" text, "actions" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_author" ON "activities" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "counters"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "counters" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "owner_type" varchar, "owner_id" integer, "name" varchar(25), "count" integer DEFAULT 0)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_counters_on_owner" ON "counters" ("owner_type", "owner_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.1ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:52:06.032124"], ["updated_at", "2025-09-28 23:52:06.032124"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:52:06.048240"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:52:06.049305"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:52:06.051751"], ["created_at", "2025-09-28 23:52:06.056463"], ["updated_at", "2025-09-28 23:52:06.056463"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:52:06.071105"], ["updated_at", "2025-09-28 23:52:06.071105"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:52:06.072731"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:52:06.100638"], ["updated_at", "2025-09-28 23:52:06.100638"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.5ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:52:06.117470"], ["id", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:52:06.118048"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Processing by Admin::CommentsController#update as HTML
  Parameters: {"comment"=>{"body"=>"updated comment body"}, "id"=>"1"}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mContent Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mComment Update (0.1ms)[0m  [1m[33mUPDATE "comments" SET "body" = ?, "updated_at" = ? WHERE "comments"."id" = ?[0m  [["body", "updated comment body"], ["updated_at", "2025-09-28 23:52:06.182781"], ["id", 1]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:52:06.183453"], ["id", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:52:06.184364"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/admin/comments
Completed 302 Found in 8ms (ActiveRecord: 0.8ms (10 queries, 0 cached) | GC: 0.3ms)
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Processing by Admin::CommentsController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 3]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 2]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.0ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 4]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/admin/comments
Completed 302 Found in 9ms (ActiveRecord: 0.9ms (18 queries, 0 cached) | GC: 0.2ms)
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments/preview" for 127.0.0.1 at 2025-09-28 19:52:06 -0400
Processing by CommentsController#preview as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"Previewer", "author_email"=>"preview@example.com", "body"=>"Hello preview"}}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
  Rendering /home/micah/work/adva_comments/app/views/comments/preview.html.erb
  Rendered /home/micah/work/adva_comments/app/views/comments/preview.html.erb (Duration: 0.2ms | GC: 0.0ms)
Completed 200 OK in 8ms (Views: 2.5ms | ActiveRecord: 0.4ms (6 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments" for 127.0.0.1 at 2025-09-28 19:52:06 -0400
Processing by CommentsController#create as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"New Author", "author_email"=>"new@example.com", "body"=>"New comment body"}}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
[Invisible Captcha] Potential spam detected for IP 127.0.0.1. Timestamp not found in session.
Redirected to http://test-site.com/ref
Filter chain halted as #<Proc:0x00007aa6c8d4c1c0 /home/micah/.rvm/gems/ruby-3.3.4/gems/invisible_captcha-2.3.0/lib/invisible_captcha/controller_ext.rb:12> rendered or redirected
Completed 302 Found in 3ms (ActiveRecord: 0.3ms (6 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (7.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "type" varchar, "object_attributes" text, "actions" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_author" ON "activities" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "counters"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "counters" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "owner_type" varchar, "owner_id" integer, "name" varchar(25), "count" integer DEFAULT 0)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_counters_on_owner" ON "counters" ("owner_type", "owner_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.1ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:53:30.991622"], ["updated_at", "2025-09-28 23:53:30.991622"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:53:31.002090"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:53:31.002744"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:53:31.004911"], ["created_at", "2025-09-28 23:53:31.009072"], ["updated_at", "2025-09-28 23:53:31.009072"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:53:31.025244"], ["updated_at", "2025-09-28 23:53:31.025244"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:53:31.026968"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:53:31.064349"], ["updated_at", "2025-09-28 23:53:31.064349"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.0ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:53:31.073322"], ["id", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:53:31.073838"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSite Load (0.3ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mComment Create (0.1ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Observer Test"], ["author_email", "observer@example.com"], ["author_homepage", nil], ["body", "hello"], ["body_html", nil], ["approved", 0], ["created_at", "2025-09-28 23:53:31.097987"], ["updated_at", "2025-09-28 23:53:31.097987"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 2], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 2], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:53:31.101042"], ["id", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mActivity Create (0.2ms)[0m  [1m[32mINSERT INTO "activities" ("site_id", "section_id", "object_type", "object_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "type", "object_attributes", "actions", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["object_type", "Comment"], ["object_id", 2], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["type", nil], ["object_attributes", "---\ncommentable_id: 1\nbody: hello\nauthor_name: Observer Test\nauthor_email: observer@example.com\ncommentable_type: Article\ncommentable_title: Test Article\n"], ["actions", "---\n- created\n"], ["created_at", "2025-09-28 23:53:31.104127"], ["updated_at", "2025-09-28 23:53:31.104127"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (6.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "type" varchar, "object_attributes" text, "actions" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_author" ON "activities" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "counters"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "counters" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "owner_type" varchar, "owner_id" integer, "name" varchar(25), "count" integer DEFAULT 0)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_counters_on_owner" ON "counters" ("owner_type", "owner_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.2ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:53:54.968384"], ["updated_at", "2025-09-28 23:53:54.968384"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:53:54.978651"]]
  [1m[36mSite Update (0.1ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:53:54.979481"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:53:54.981801"], ["created_at", "2025-09-28 23:53:54.985849"], ["updated_at", "2025-09-28 23:53:54.985849"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:53:55.010909"], ["updated_at", "2025-09-28 23:53:55.010909"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:53:55.012720"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:53:55.044404"], ["updated_at", "2025-09-28 23:53:55.044404"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:53:55.052715"], ["id", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:53:55.053295"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.2ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSite Load (0.2ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mComment Create (0.1ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Observer Test"], ["author_email", "observer@example.com"], ["author_homepage", nil], ["body", "hello"], ["body_html", nil], ["approved", 0], ["created_at", "2025-09-28 23:53:55.084898"], ["updated_at", "2025-09-28 23:53:55.084898"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.1ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 2], ["id", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 2], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:53:55.088396"], ["id", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mActivity Create (0.3ms)[0m  [1m[32mINSERT INTO "activities" ("site_id", "section_id", "object_type", "object_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "type", "object_attributes", "actions", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["object_type", "Comment"], ["object_id", 2], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["type", nil], ["object_attributes", "---\ncommentable_id: 1\nbody: hello\nauthor_name: Observer Test\nauthor_email: observer@example.com\ncommentable_type: Article\ncommentable_title: Test Article\n"], ["actions", "---\n- created\n"], ["created_at", "2025-09-28 23:53:55.091585"], ["updated_at", "2025-09-28 23:53:55.091585"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (7.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "type" varchar, "object_attributes" text, "actions" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_author" ON "activities" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "counters"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "counters" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "owner_type" varchar, "owner_id" integer, "name" varchar(25), "count" integer DEFAULT 0)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_counters_on_owner" ON "counters" ("owner_type", "owner_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.2ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:54:06.128486"], ["updated_at", "2025-09-28 23:54:06.128486"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.2ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:54:06.144137"]]
  [1m[36mSite Update (0.1ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:54:06.145561"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:54:06.148750"], ["created_at", "2025-09-28 23:54:06.154208"], ["updated_at", "2025-09-28 23:54:06.154208"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:54:06.171876"], ["updated_at", "2025-09-28 23:54:06.171876"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.1ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:54:06.173637"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:54:06.212497"], ["updated_at", "2025-09-28 23:54:06.212497"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.0ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:54:06.221388"], ["id", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:54:06.221924"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mComment Load (0.3ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Processing by Admin::CommentsController#update as HTML
  Parameters: {"comment"=>{"body"=>"updated comment body"}, "id"=>"1"}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mContent Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mComment Update (0.1ms)[0m  [1m[33mUPDATE "comments" SET "body" = ?, "updated_at" = ? WHERE "comments"."id" = ?[0m  [["body", "updated comment body"], ["updated_at", "2025-09-28 23:54:06.282500"], ["id", 1]]
  [1m[36mArticle Update (0.1ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:54:06.283243"], ["id", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:54:06.284329"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/admin/comments
Completed 302 Found in 8ms (ActiveRecord: 0.9ms (10 queries, 0 cached) | GC: 0.0ms)
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Processing by Admin::CommentsController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 3]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 2]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.0ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 4]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/admin/comments
Completed 302 Found in 9ms (ActiveRecord: 0.9ms (18 queries, 0 cached) | GC: 0.3ms)
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.2ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Observer Test"], ["author_email", "observer@example.com"], ["author_homepage", nil], ["body", "hello"], ["body_html", nil], ["approved", 0], ["created_at", "2025-09-28 23:54:06.379099"], ["updated_at", "2025-09-28 23:54:06.379099"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 2], ["id", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 2], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:54:06.382071"], ["id", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mActivity Create (0.2ms)[0m  [1m[32mINSERT INTO "activities" ("site_id", "section_id", "object_type", "object_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "type", "object_attributes", "actions", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["object_type", "Comment"], ["object_id", 2], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["type", nil], ["object_attributes", "---\ncommentable_id: 1\nbody: hello\nauthor_name: Observer Test\nauthor_email: observer@example.com\ncommentable_type: Article\ncommentable_title: Test Article\n"], ["actions", "---\n- created\n"], ["created_at", "2025-09-28 23:54:06.384896"], ["updated_at", "2025-09-28 23:54:06.384896"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.3ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments/preview" for 127.0.0.1 at 2025-09-28 19:54:06 -0400
Processing by CommentsController#preview as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"Previewer", "author_email"=>"preview@example.com", "body"=>"Hello preview"}}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
  Rendering /home/micah/work/adva_comments/app/views/comments/preview.html.erb
  Rendered /home/micah/work/adva_comments/app/views/comments/preview.html.erb (Duration: 0.2ms | GC: 0.0ms)
Completed 200 OK in 9ms (Views: 2.7ms | ActiveRecord: 0.5ms (6 queries, 0 cached) | GC: 0.2ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments" for 127.0.0.1 at 2025-09-28 19:54:06 -0400
Processing by CommentsController#create as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"New Author", "author_email"=>"new@example.com", "body"=>"New comment body"}}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.2ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
[Invisible Captcha] Potential spam detected for IP 127.0.0.1. Timestamp not found in session.
Redirected to http://test-site.com/ref
Filter chain halted as #<Proc:0x000076e38a2ce658 /home/micah/.rvm/gems/ruby-3.3.4/gems/invisible_captcha-2.3.0/lib/invisible_captcha/controller_ext.rb:12> rendered or redirected
Completed 302 Found in 4ms (ActiveRecord: 0.6ms (6 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (7.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "type" varchar, "object_attributes" text, "actions" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_author" ON "activities" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "counters"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "counters" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "owner_type" varchar, "owner_id" integer, "name" varchar(25), "count" integer DEFAULT 0)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_counters_on_owner" ON "counters" ("owner_type", "owner_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.1ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:54:35.853573"], ["updated_at", "2025-09-28 23:54:35.853573"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:54:35.865150"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:54:35.865903"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:54:35.868350"], ["created_at", "2025-09-28 23:54:35.872551"], ["updated_at", "2025-09-28 23:54:35.872551"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:54:35.886676"], ["updated_at", "2025-09-28 23:54:35.886676"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:54:35.888312"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:54:35.925157"], ["updated_at", "2025-09-28 23:54:35.925157"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.0ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:54:35.933860"], ["id", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:54:35.934411"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Processing by Admin::CommentsController#update as HTML
  Parameters: {"comment"=>{"body"=>"updated comment body"}, "id"=>"1"}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mContent Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mComment Update (0.0ms)[0m  [1m[33mUPDATE "comments" SET "body" = ?, "updated_at" = ? WHERE "comments"."id" = ?[0m  [["body", "updated comment body"], ["updated_at", "2025-09-28 23:54:36.011354"], ["id", 1]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:54:36.012006"], ["id", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:54:36.012837"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/admin/comments
Completed 302 Found in 8ms (ActiveRecord: 0.8ms (10 queries, 0 cached) | GC: 0.2ms)
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Processing by Admin::CommentsController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[36mContent Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 3]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 2]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.0ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 4]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/admin/comments
Completed 302 Found in 8ms (ActiveRecord: 0.8ms (18 queries, 0 cached) | GC: 0.0ms)
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mComment Create (0.1ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Observer Test"], ["author_email", "observer@example.com"], ["author_homepage", nil], ["body", "hello"], ["body_html", nil], ["approved", 0], ["created_at", "2025-09-28 23:54:36.089104"], ["updated_at", "2025-09-28 23:54:36.089104"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 2], ["id", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 2], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:54:36.091751"], ["id", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:54:36.092551"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (6.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments/preview" for 127.0.0.1 at 2025-09-28 19:54:36 -0400
Processing by CommentsController#preview as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"Previewer", "author_email"=>"preview@example.com", "body"=>"Hello preview"}}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
  Rendering /home/micah/work/adva_comments/app/views/comments/preview.html.erb
  Rendered /home/micah/work/adva_comments/app/views/comments/preview.html.erb (Duration: 0.2ms | GC: 0.0ms)
Completed 200 OK in 9ms (Views: 2.6ms | ActiveRecord: 0.5ms (6 queries, 0 cached) | GC: 0.2ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments" for 127.0.0.1 at 2025-09-28 19:54:36 -0400
Processing by CommentsController#create as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"New Author", "author_email"=>"new@example.com", "body"=>"New comment body"}}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.9ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
[Invisible Captcha] Potential spam detected for IP 127.0.0.1. Timestamp not found in session.
Redirected to http://test-site.com/ref
Filter chain halted as #<Proc:0x00007e175575fec8 /home/micah/.rvm/gems/ruby-3.3.4/gems/invisible_captcha-2.3.0/lib/invisible_captcha/controller_ext.rb:12> rendered or redirected
Completed 302 Found in 9ms (ActiveRecord: 1.7ms (6 queries, 0 cached) | GC: 6.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (7.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "type" varchar, "object_attributes" text, "actions" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_author" ON "activities" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "counters"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "counters" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "owner_type" varchar, "owner_id" integer, "name" varchar(25), "count" integer DEFAULT 0)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_counters_on_owner" ON "counters" ("owner_type", "owner_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.1ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:55:20.730484"], ["updated_at", "2025-09-28 23:55:20.730484"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:55:20.764925"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:55:20.766000"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:55:20.768722"], ["created_at", "2025-09-28 23:55:20.773533"], ["updated_at", "2025-09-28 23:55:20.773533"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:55:20.788277"], ["updated_at", "2025-09-28 23:55:20.788277"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:55:20.790090"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:55:20.823450"], ["updated_at", "2025-09-28 23:55:20.823450"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.0ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:55:20.832319"], ["id", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:55:20.832840"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Processing by Admin::CommentsController#update as HTML
  Parameters: {"comment"=>{"body"=>"updated comment body"}, "id"=>"1"}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mContent Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mComment Update (0.1ms)[0m  [1m[33mUPDATE "comments" SET "body" = ?, "updated_at" = ? WHERE "comments"."id" = ?[0m  [["body", "updated comment body"], ["updated_at", "2025-09-28 23:55:20.900679"], ["id", 1]]
  [1m[36mArticle Update (0.1ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:55:20.901441"], ["id", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:55:20.902463"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/admin/comments
Completed 302 Found in 8ms (ActiveRecord: 0.8ms (10 queries, 0 cached) | GC: 0.0ms)
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Processing by Admin::CommentsController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.1ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 3]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 2]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.0ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 4]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/admin/comments
Completed 302 Found in 9ms (ActiveRecord: 0.8ms (18 queries, 0 cached) | GC: 0.0ms)
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSite Load (0.8ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Observer Test"], ["author_email", "observer@example.com"], ["author_homepage", nil], ["body", "hello"], ["body_html", nil], ["approved", 0], ["created_at", "2025-09-28 23:55:21.034749"], ["updated_at", "2025-09-28 23:55:21.034749"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 2], ["id", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 2], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:55:21.039054"], ["id", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:55:21.039962"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments/preview" for 127.0.0.1 at 2025-09-28 19:55:21 -0400
Processing by CommentsController#preview as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"Previewer", "author_email"=>"preview@example.com", "body"=>"Hello preview"}}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
  Rendering /home/micah/work/adva_comments/app/views/comments/preview.html.erb
  Rendered /home/micah/work/adva_comments/app/views/comments/preview.html.erb (Duration: 0.2ms | GC: 0.0ms)
Completed 200 OK in 10ms (Views: 2.8ms | ActiveRecord: 0.6ms (6 queries, 0 cached) | GC: 0.1ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments" for 127.0.0.1 at 2025-09-28 19:55:21 -0400
Processing by CommentsController#create as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"New Author", "author_email"=>"new@example.com", "body"=>"New comment body"}}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
[Invisible Captcha] Potential spam detected for IP 127.0.0.1. Timestamp not found in session.
Redirected to http://test-site.com/ref
Filter chain halted as #<Proc:0x000077c30145d850 /home/micah/.rvm/gems/ruby-3.3.4/gems/invisible_captcha-2.3.0/lib/invisible_captcha/controller_ext.rb:12> rendered or redirected
Completed 302 Found in 4ms (ActiveRecord: 0.5ms (6 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (7.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "type" varchar, "object_attributes" text, "actions" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_author" ON "activities" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "counters"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "counters" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "owner_type" varchar, "owner_id" integer, "name" varchar(25), "count" integer DEFAULT 0)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_counters_on_owner" ON "counters" ("owner_type", "owner_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.1ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:56:29.890912"], ["updated_at", "2025-09-28 23:56:29.890912"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:56:29.903215"]]
  [1m[36mSite Update (0.1ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:56:29.904314"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:56:29.906883"], ["created_at", "2025-09-28 23:56:29.911495"], ["updated_at", "2025-09-28 23:56:29.911495"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:56:29.937881"], ["updated_at", "2025-09-28 23:56:29.937881"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:56:29.940055"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:56:29.976495"], ["updated_at", "2025-09-28 23:56:29.976495"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.0ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:56:29.985298"], ["id", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:56:29.985839"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Processing by Admin::CommentsController#update as HTML
  Parameters: {"comment"=>{"body"=>"updated comment body"}, "id"=>"1"}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mContent Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.2ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mComment Update (0.0ms)[0m  [1m[33mUPDATE "comments" SET "body" = ?, "updated_at" = ? WHERE "comments"."id" = ?[0m  [["body", "updated comment body"], ["updated_at", "2025-09-28 23:56:30.060029"], ["id", 1]]
  [1m[36mArticle Update (0.1ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:56:30.060694"], ["id", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Update (0.1ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:56:30.061606"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/admin/comments
Completed 302 Found in 8ms (ActiveRecord: 1.1ms (10 queries, 0 cached) | GC: 0.2ms)
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Processing by Admin::CommentsController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 3]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.1ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 2]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 4]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/admin/comments
Completed 302 Found in 10ms (ActiveRecord: 1.0ms (18 queries, 0 cached) | GC: 0.0ms)
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mComment Create (0.1ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Observer Test"], ["author_email", "observer@example.com"], ["author_homepage", nil], ["body", "hello"], ["body_html", nil], ["approved", 0], ["created_at", "2025-09-28 23:56:30.144775"], ["updated_at", "2025-09-28 23:56:30.144775"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 2], ["id", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 2], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:56:30.147726"], ["id", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:56:30.148709"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started PUT "/admin/comments/1" for 127.0.0.1 at 2025-09-28 19:56:30 -0400
Processing by Admin::CommentsController#update as HTML
  Parameters: {"comment"=>{"body"=>"updated comment body"}, "id"=>"1"}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mComment Update (0.1ms)[0m  [1m[33mUPDATE "comments" SET "body" = ?, "updated_at" = ? WHERE "comments"."id" = ?[0m  [["body", "updated comment body"], ["updated_at", "2025-09-28 23:56:30.167430"], ["id", 1]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:56:30.168984"], ["id", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (1.7ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mActivity Create (0.1ms)[0m  [1m[32mINSERT INTO "activities" ("site_id", "section_id", "object_type", "object_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "type", "object_attributes", "actions", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["object_type", "Comment"], ["object_id", 1], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["type", nil], ["object_attributes", "---\ncommentable_id: 1\nbody: updated comment body\nauthor_name: Test Commenter\nauthor_email: commenter@example.com\ncommentable_type: Article\ncommentable_title: Test Article\n"], ["actions", "---\n- edited\n"], ["created_at", "2025-09-28 23:56:30.178147"], ["updated_at", "2025-09-28 23:56:30.178147"]]
  [1m[36mSite Update (0.1ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:56:30.170862"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/admin/comments
Completed 302 Found in 24ms (ActiveRecord: 2.7ms (13 queries, 0 cached) | GC: 10.3ms)
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started DELETE "/admin/comments/1" for 127.0.0.1 at 2025-09-28 19:56:30 -0400
Processing by Admin::CommentsController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.2ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 3]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.9ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 2]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.2ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 4]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mActivity Create (0.3ms)[0m  [1m[32mINSERT INTO "activities" ("site_id", "section_id", "object_type", "object_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "type", "object_attributes", "actions", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["object_type", "Comment"], ["object_id", 1], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["type", nil], ["object_attributes", "---\ncommentable_id: 1\nbody: Test comment body\nauthor_name: Test Commenter\nauthor_email: commenter@example.com\ncommentable_type: Article\ncommentable_title: Test Article\n"], ["actions", "---\n- deleted\n"], ["created_at", "2025-09-28 23:56:30.230189"], ["updated_at", "2025-09-28 23:56:30.230189"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 21ms (ActiveRecord: 2.6ms (23 queries, 0 cached) | GC: 6.1ms)
  
ActiveRecord::StatementInvalid (SQLite3::CantOpenException: unable to open database file)
Caused by: SQLite3::CantOpenException (unable to open database file)

Information for: ActiveRecord::StatementInvalid (SQLite3::CantOpenException: unable to open database file):
  

Information for cause: SQLite3::CantOpenException (unable to open database file):
  
sqlite3-2.7.4-x86_64-linux (gnu) lib/sqlite3/statement.rb:125:in `step'
sqlite3-2.7.4-x86_64-linux (gnu) lib/sqlite3/statement.rb:125:in `block in each'
<internal:kernel>:187:in `loop'
sqlite3-2.7.4-x86_64-linux (gnu) lib/sqlite3/statement.rb:124:in `each'
activerecord (8.0.3) lib/active_record/connection_adapters/sqlite3/database_statements.rb:103:in `to_a'
activerecord (8.0.3) lib/active_record/connection_adapters/sqlite3/database_statements.rb:103:in `perform_query'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/database_statements.rb:556:in `block (2 levels) in raw_execute'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract_adapter.rb:1017:in `block in with_raw_connection'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:23:in `handle_interrupt'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:23:in `block in synchronize'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:19:in `handle_interrupt'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:19:in `synchronize'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract_adapter.rb:986:in `with_raw_connection'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/database_statements.rb:555:in `block in raw_execute'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract_adapter.rb:1137:in `log'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/database_statements.rb:554:in `raw_execute'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/database_statements.rb:591:in `internal_execute'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/database_statements.rb:547:in `internal_exec_query'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/database_statements.rb:159:in `exec_insert'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/database_statements.rb:197:in `insert'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/query_cache.rb:27:in `insert'
activerecord (8.0.3) lib/active_record/persistence.rb:257:in `_insert_record'
activerecord (8.0.3) lib/active_record/persistence.rb:926:in `block in _create_record'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/connection_pool.rb:416:in `with_connection'
activerecord (8.0.3) lib/active_record/connection_handling.rb:310:in `with_connection'
activerecord (8.0.3) lib/active_record/persistence.rb:923:in `_create_record'
activerecord (8.0.3) lib/active_record/counter_cache.rb:201:in `_create_record'
activerecord (8.0.3) lib/active_record/locking/optimistic.rb:84:in `_create_record'
activerecord (8.0.3) lib/active_record/encryption/encryptable_record.rb:184:in `_create_record'
activerecord (8.0.3) lib/active_record/attribute_methods/dirty.rb:240:in `_create_record'
activerecord (8.0.3) lib/active_record/callbacks.rb:445:in `block in _create_record'
activesupport (8.0.3) lib/active_support/callbacks.rb:100:in `run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:913:in `_run_create_callbacks'
activerecord (8.0.3) lib/active_record/callbacks.rb:445:in `_create_record'
activerecord (8.0.3) lib/active_record/timestamp.rb:116:in `_create_record'
activerecord (8.0.3) lib/active_record/persistence.rb:894:in `create_or_update'
activerecord (8.0.3) lib/active_record/callbacks.rb:441:in `block in create_or_update'
activesupport (8.0.3) lib/active_support/callbacks.rb:109:in `run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:913:in `_run_save_callbacks'
activerecord (8.0.3) lib/active_record/callbacks.rb:441:in `create_or_update'
activerecord (8.0.3) lib/active_record/timestamp.rb:127:in `create_or_update'
activerecord (8.0.3) lib/active_record/persistence.rb:424:in `save!'
activerecord (8.0.3) lib/active_record/validations.rb:54:in `save!'
activerecord (8.0.3) lib/active_record/transactions.rb:365:in `block in save!'
activerecord (8.0.3) lib/active_record/transactions.rb:417:in `block (2 levels) in with_transaction_returning_status'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/database_statements.rb:357:in `transaction'
activerecord (8.0.3) lib/active_record/transactions.rb:413:in `block in with_transaction_returning_status'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/connection_pool.rb:416:in `with_connection'
activerecord (8.0.3) lib/active_record/connection_handling.rb:310:in `with_connection'
activerecord (8.0.3) lib/active_record/transactions.rb:409:in `with_transaction_returning_status'
activerecord (8.0.3) lib/active_record/transactions.rb:365:in `save!'
activerecord (8.0.3) lib/active_record/suppressor.rb:56:in `save!'
/home/micah/work/adva_comments/app/observers/activities/comment_observer.rb:69:in `log_activity'
/home/micah/work/adva_comments/app/observers/activities/comment_observer.rb:44:in `after_destroy'
rails-observers (0.1.5) lib/rails/observers/active_model/observing.rb:352:in `update'
rails-observers (0.1.5) lib/rails/observers/activerecord/observer.rb:118:in `block (2 levels) in define_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:361:in `block in make_lambda'
activesupport (8.0.3) lib/active_support/callbacks.rb:207:in `call'
activesupport (8.0.3) lib/active_support/callbacks.rb:563:in `block in invoke_after'
activesupport (8.0.3) lib/active_support/callbacks.rb:563:in `each'
activesupport (8.0.3) lib/active_support/callbacks.rb:563:in `invoke_after'
activesupport (8.0.3) lib/active_support/callbacks.rb:110:in `run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:913:in `_run_destroy_callbacks'
activerecord (8.0.3) lib/active_record/callbacks.rb:423:in `destroy'
activerecord (8.0.3) lib/active_record/transactions.rb:357:in `block in destroy'
activerecord (8.0.3) lib/active_record/transactions.rb:417:in `block (2 levels) in with_transaction_returning_status'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/transaction.rb:626:in `block in within_new_transaction'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:23:in `handle_interrupt'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:23:in `block in synchronize'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:19:in `handle_interrupt'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:19:in `synchronize'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/transaction.rb:623:in `within_new_transaction'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/database_statements.rb:367:in `within_new_transaction'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/database_statements.rb:359:in `transaction'
activerecord (8.0.3) lib/active_record/transactions.rb:413:in `block in with_transaction_returning_status'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/connection_pool.rb:416:in `with_connection'
activerecord (8.0.3) lib/active_record/connection_handling.rb:310:in `with_connection'
activerecord (8.0.3) lib/active_record/transactions.rb:409:in `with_transaction_returning_status'
activerecord (8.0.3) lib/active_record/transactions.rb:357:in `destroy'
/home/micah/work/adva_comments/app/controllers/admin/comments_controller.rb:35:in `destroy'
actionpack (8.0.3) lib/action_controller/metal/basic_implicit_render.rb:8:in `send_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:215:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:193:in `process_action'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:261:in `block in process_action'
activesupport (8.0.3) lib/active_support/callbacks.rb:120:in `block in run_callbacks'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/controller.rb:8:in `write_flash_to_cookie'
activesupport (8.0.3) lib/active_support/callbacks.rb:129:in `block in run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:140:in `run_callbacks'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:76:in `block in process_action'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:75:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:152:in `process'
actionview (8.0.3) lib/action_view/rendering.rb:40:in `process'
actionpack (8.0.3) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (8.0.3) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:908:in `call'
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:60:in `call'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/middleware.rb:8:in `call'
rack (3.2.1) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.2.1) lib/rack/etag.rb:29:in `call'
rack (3.2.1) lib/rack/conditional_get.rb:44:in `call'
rack (3.2.1) lib/rack/head.rb:15:in `call'
actionpack (8.0.3) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (8.0.3) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/cookies.rb:706:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (8.0.3) lib/active_support/callbacks.rb:100:in `run_callbacks'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (8.0.3) lib/rails/rack/logger.rb:41:in `call_app'
railties (8.0.3) lib/rails/rack/logger.rb:29:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/request_id.rb:34:in `call'
rack (3.2.1) lib/rack/method_override.rb:28:in `call'
rack (3.2.1) lib/rack/runtime.rb:24:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.2.1) lib/rack/sendfile.rb:114:in `call'
railties (8.0.3) lib/rails/engine.rb:535:in `call'
rack-test (2.2.0) lib/rack/test.rb:360:in `process_request'
rack-test (2.2.0) lib/rack/test.rb:153:in `request'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:297:in `process'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:43:in `delete'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:388:in `delete'
/home/micah/work/adva_comments/spec/requests/admin/comments_spec.rb:44:in `block (3 levels) in <top (required)>'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `block in run'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-rails (7.1.1) lib/rspec/rails/adapters.rb:75:in `block (2 levels) in <module:MinitestLifecycleAdapter>'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:390:in `execute_with'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `run'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:259:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:653:in `block in run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:614:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `map'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/configuration.rb:2097:in `with_suite_hooks'
rspec-core (3.13.5) lib/rspec/core/runner.rb:116:in `block in run_specs'
rspec-core (3.13.5) lib/rspec/core/reporter.rb:74:in `report'
rspec-core (3.13.5) lib/rspec/core/runner.rb:115:in `run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:89:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:71:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:45:in `invoke'
rspec-core (3.13.5) exe/rspec:4:in `<top (required)>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `load'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `<main>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `eval'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `<main>'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments/preview" for 127.0.0.1 at 2025-09-28 19:56:30 -0400
Processing by CommentsController#preview as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"Previewer", "author_email"=>"preview@example.com", "body"=>"Hello preview"}}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
  Rendering /home/micah/work/adva_comments/app/views/comments/preview.html.erb
  Rendered /home/micah/work/adva_comments/app/views/comments/preview.html.erb (Duration: 0.1ms | GC: 0.0ms)
Completed 200 OK in 6ms (Views: 1.0ms | ActiveRecord: 0.4ms (6 queries, 0 cached) | GC: 0.1ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments" for 127.0.0.1 at 2025-09-28 19:56:30 -0400
Processing by CommentsController#create as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"New Author", "author_email"=>"new@example.com", "body"=>"New comment body"}}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
[Invisible Captcha] Potential spam detected for IP 127.0.0.1. Timestamp not found in session.
Redirected to http://test-site.com/ref
Filter chain halted as #<Proc:0x00007b633fa5f9d8 /home/micah/.rvm/gems/ruby-3.3.4/gems/invisible_captcha-2.3.0/lib/invisible_captcha/controller_ext.rb:12> rendered or redirected
Completed 302 Found in 4ms (ActiveRecord: 0.4ms (6 queries, 0 cached) | GC: 0.1ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (7.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "type" varchar, "object_attributes" text, "actions" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_author" ON "activities" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "counters"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "counters" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "owner_type" varchar, "owner_id" integer, "name" varchar(25), "count" integer DEFAULT 0)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_counters_on_owner" ON "counters" ("owner_type", "owner_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.1ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:57:08.240132"], ["updated_at", "2025-09-28 23:57:08.240132"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:57:08.254357"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:57:08.255348"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:57:08.257820"], ["created_at", "2025-09-28 23:57:08.262287"], ["updated_at", "2025-09-28 23:57:08.262287"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:57:08.283152"], ["updated_at", "2025-09-28 23:57:08.283152"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:57:08.285171"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:57:08.318232"], ["updated_at", "2025-09-28 23:57:08.318232"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.2ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.1ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 2]]
  [1m[36mArticle Update (0.1ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:57:08.332483"], ["id", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:57:08.334722"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Processing by Admin::CommentsController#update as HTML
  Parameters: {"comment"=>{"body"=>"updated comment body"}, "id"=>"1"}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mContent Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mComment Update (0.0ms)[0m  [1m[33mUPDATE "comments" SET "body" = ?, "updated_at" = ? WHERE "comments"."id" = ?[0m  [["body", "updated comment body"], ["updated_at", "2025-09-28 23:57:08.418298"], ["id", 1]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:57:08.418937"], ["id", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:57:08.419812"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/admin/comments
Completed 302 Found in 8ms (ActiveRecord: 0.8ms (10 queries, 0 cached) | GC: 0.0ms)
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Processing by Admin::CommentsController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 3]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 2]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 4]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/admin/comments
Completed 302 Found in 8ms (ActiveRecord: 0.8ms (18 queries, 0 cached) | GC: 0.0ms)
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.2ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mComment Create (0.1ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Observer Test"], ["author_email", "observer@example.com"], ["author_homepage", nil], ["body", "hello"], ["body_html", nil], ["approved", 0], ["created_at", "2025-09-28 23:57:08.496955"], ["updated_at", "2025-09-28 23:57:08.496955"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 2], ["id", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 2], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:57:08.499504"], ["id", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:57:08.500369"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started PUT "/admin/comments/1" for 127.0.0.1 at 2025-09-28 19:57:08 -0400
Processing by Admin::CommentsController#update as HTML
  Parameters: {"comment"=>{"body"=>"updated comment body"}, "id"=>"1"}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mComment Update (0.0ms)[0m  [1m[33mUPDATE "comments" SET "body" = ?, "updated_at" = ? WHERE "comments"."id" = ?[0m  [["body", "updated comment body"], ["updated_at", "2025-09-28 23:57:08.515390"], ["id", 1]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:57:08.515922"], ["id", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mActivity Create (0.1ms)[0m  [1m[32mINSERT INTO "activities" ("site_id", "section_id", "object_type", "object_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "type", "object_attributes", "actions", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["object_type", "Comment"], ["object_id", 1], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["type", nil], ["object_attributes", "---\ncommentable_id: 1\nbody: updated comment body\nauthor_name: Test Commenter\nauthor_email: commenter@example.com\ncommentable_type: Article\ncommentable_title: Test Article\n"], ["actions", "---\n- edited\n"], ["created_at", "2025-09-28 23:57:08.518528"], ["updated_at", "2025-09-28 23:57:08.518528"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:57:08.516713"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/admin/comments
Completed 302 Found in 10ms (ActiveRecord: 0.8ms (13 queries, 0 cached) | GC: 0.0ms)
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.2ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.3ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started DELETE "/admin/comments/1" for 127.0.0.1 at 2025-09-28 19:57:08 -0400
Processing by Admin::CommentsController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 3]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 2]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.0ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 4]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mActivity Create (0.3ms)[0m  [1m[32mINSERT INTO "activities" ("site_id", "section_id", "object_type", "object_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "type", "object_attributes", "actions", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["object_type", "Comment"], ["object_id", 1], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["type", nil], ["object_attributes", "---\ncommentable_id: 1\nbody: Test comment body\nauthor_name: Test Commenter\nauthor_email: commenter@example.com\ncommentable_type: Article\ncommentable_title: Test Article\n"], ["actions", "---\n- deleted\n"], ["created_at", "2025-09-28 23:57:08.547070"], ["updated_at", "2025-09-28 23:57:08.547070"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 13ms (ActiveRecord: 1.5ms (23 queries, 0 cached) | GC: 0.4ms)
  
ActiveRecord::StatementInvalid (SQLite3::CantOpenException: unable to open database file)
Caused by: SQLite3::CantOpenException (unable to open database file)

Information for: ActiveRecord::StatementInvalid (SQLite3::CantOpenException: unable to open database file):
  

Information for cause: SQLite3::CantOpenException (unable to open database file):
  
sqlite3-2.7.4-x86_64-linux (gnu) lib/sqlite3/statement.rb:125:in `step'
sqlite3-2.7.4-x86_64-linux (gnu) lib/sqlite3/statement.rb:125:in `block in each'
<internal:kernel>:187:in `loop'
sqlite3-2.7.4-x86_64-linux (gnu) lib/sqlite3/statement.rb:124:in `each'
activerecord (8.0.3) lib/active_record/connection_adapters/sqlite3/database_statements.rb:103:in `to_a'
activerecord (8.0.3) lib/active_record/connection_adapters/sqlite3/database_statements.rb:103:in `perform_query'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/database_statements.rb:556:in `block (2 levels) in raw_execute'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract_adapter.rb:1017:in `block in with_raw_connection'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:23:in `handle_interrupt'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:23:in `block in synchronize'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:19:in `handle_interrupt'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:19:in `synchronize'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract_adapter.rb:986:in `with_raw_connection'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/database_statements.rb:555:in `block in raw_execute'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract_adapter.rb:1137:in `log'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/database_statements.rb:554:in `raw_execute'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/database_statements.rb:591:in `internal_execute'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/database_statements.rb:547:in `internal_exec_query'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/database_statements.rb:159:in `exec_insert'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/database_statements.rb:197:in `insert'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/query_cache.rb:27:in `insert'
activerecord (8.0.3) lib/active_record/persistence.rb:257:in `_insert_record'
activerecord (8.0.3) lib/active_record/persistence.rb:926:in `block in _create_record'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/connection_pool.rb:416:in `with_connection'
activerecord (8.0.3) lib/active_record/connection_handling.rb:310:in `with_connection'
activerecord (8.0.3) lib/active_record/persistence.rb:923:in `_create_record'
activerecord (8.0.3) lib/active_record/counter_cache.rb:201:in `_create_record'
activerecord (8.0.3) lib/active_record/locking/optimistic.rb:84:in `_create_record'
activerecord (8.0.3) lib/active_record/encryption/encryptable_record.rb:184:in `_create_record'
activerecord (8.0.3) lib/active_record/attribute_methods/dirty.rb:240:in `_create_record'
activerecord (8.0.3) lib/active_record/callbacks.rb:445:in `block in _create_record'
activesupport (8.0.3) lib/active_support/callbacks.rb:100:in `run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:913:in `_run_create_callbacks'
activerecord (8.0.3) lib/active_record/callbacks.rb:445:in `_create_record'
activerecord (8.0.3) lib/active_record/timestamp.rb:116:in `_create_record'
activerecord (8.0.3) lib/active_record/persistence.rb:894:in `create_or_update'
activerecord (8.0.3) lib/active_record/callbacks.rb:441:in `block in create_or_update'
activesupport (8.0.3) lib/active_support/callbacks.rb:109:in `run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:913:in `_run_save_callbacks'
activerecord (8.0.3) lib/active_record/callbacks.rb:441:in `create_or_update'
activerecord (8.0.3) lib/active_record/timestamp.rb:127:in `create_or_update'
activerecord (8.0.3) lib/active_record/persistence.rb:424:in `save!'
activerecord (8.0.3) lib/active_record/validations.rb:54:in `save!'
activerecord (8.0.3) lib/active_record/transactions.rb:365:in `block in save!'
activerecord (8.0.3) lib/active_record/transactions.rb:417:in `block (2 levels) in with_transaction_returning_status'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/database_statements.rb:357:in `transaction'
activerecord (8.0.3) lib/active_record/transactions.rb:413:in `block in with_transaction_returning_status'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/connection_pool.rb:416:in `with_connection'
activerecord (8.0.3) lib/active_record/connection_handling.rb:310:in `with_connection'
activerecord (8.0.3) lib/active_record/transactions.rb:409:in `with_transaction_returning_status'
activerecord (8.0.3) lib/active_record/transactions.rb:365:in `save!'
activerecord (8.0.3) lib/active_record/suppressor.rb:56:in `save!'
/home/micah/work/adva_comments/app/observers/activities/comment_observer.rb:69:in `log_activity'
/home/micah/work/adva_comments/app/observers/activities/comment_observer.rb:44:in `after_destroy'
rails-observers (0.1.5) lib/rails/observers/active_model/observing.rb:352:in `update'
rails-observers (0.1.5) lib/rails/observers/activerecord/observer.rb:118:in `block (2 levels) in define_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:361:in `block in make_lambda'
activesupport (8.0.3) lib/active_support/callbacks.rb:207:in `call'
activesupport (8.0.3) lib/active_support/callbacks.rb:563:in `block in invoke_after'
activesupport (8.0.3) lib/active_support/callbacks.rb:563:in `each'
activesupport (8.0.3) lib/active_support/callbacks.rb:563:in `invoke_after'
activesupport (8.0.3) lib/active_support/callbacks.rb:110:in `run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:913:in `_run_destroy_callbacks'
activerecord (8.0.3) lib/active_record/callbacks.rb:423:in `destroy'
activerecord (8.0.3) lib/active_record/transactions.rb:357:in `block in destroy'
activerecord (8.0.3) lib/active_record/transactions.rb:417:in `block (2 levels) in with_transaction_returning_status'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/transaction.rb:626:in `block in within_new_transaction'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:23:in `handle_interrupt'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:23:in `block in synchronize'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:19:in `handle_interrupt'
activesupport (8.0.3) lib/active_support/concurrency/load_interlock_aware_monitor.rb:19:in `synchronize'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/transaction.rb:623:in `within_new_transaction'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/database_statements.rb:367:in `within_new_transaction'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/database_statements.rb:359:in `transaction'
activerecord (8.0.3) lib/active_record/transactions.rb:413:in `block in with_transaction_returning_status'
activerecord (8.0.3) lib/active_record/connection_adapters/abstract/connection_pool.rb:416:in `with_connection'
activerecord (8.0.3) lib/active_record/connection_handling.rb:310:in `with_connection'
activerecord (8.0.3) lib/active_record/transactions.rb:409:in `with_transaction_returning_status'
activerecord (8.0.3) lib/active_record/transactions.rb:357:in `destroy'
/home/micah/work/adva_comments/app/controllers/admin/comments_controller.rb:35:in `destroy'
actionpack (8.0.3) lib/action_controller/metal/basic_implicit_render.rb:8:in `send_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:215:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rendering.rb:193:in `process_action'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:261:in `block in process_action'
activesupport (8.0.3) lib/active_support/callbacks.rb:120:in `block in run_callbacks'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/controller.rb:8:in `write_flash_to_cookie'
activesupport (8.0.3) lib/active_support/callbacks.rb:129:in `block in run_callbacks'
activesupport (8.0.3) lib/active_support/callbacks.rb:140:in `run_callbacks'
actionpack (8.0.3) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:76:in `block in process_action'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (8.0.3) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (8.0.3) lib/active_support/notifications.rb:210:in `instrument'
actionpack (8.0.3) lib/action_controller/metal/instrumentation.rb:75:in `process_action'
actionpack (8.0.3) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (8.0.3) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (8.0.3) lib/abstract_controller/base.rb:152:in `process'
actionview (8.0.3) lib/action_view/rendering.rb:40:in `process'
actionpack (8.0.3) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (8.0.3) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (8.0.3) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (8.0.3) lib/action_dispatch/routing/route_set.rb:908:in `call'
railties (8.0.3) lib/rails/engine/lazy_route_set.rb:60:in `call'
/home/micah/work/adva/vendor/gems/cacheable_flash/lib/cacheable_flash/middleware.rb:8:in `call'
rack (3.2.1) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.2.1) lib/rack/etag.rb:29:in `call'
rack (3.2.1) lib/rack/conditional_get.rb:44:in `call'
rack (3.2.1) lib/rack/head.rb:15:in `call'
actionpack (8.0.3) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (8.0.3) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.1) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/cookies.rb:706:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (8.0.3) lib/active_support/callbacks.rb:100:in `run_callbacks'
actionpack (8.0.3) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (8.0.3) lib/rails/rack/logger.rb:41:in `call_app'
railties (8.0.3) lib/rails/rack/logger.rb:29:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/request_id.rb:34:in `call'
rack (3.2.1) lib/rack/method_override.rb:28:in `call'
rack (3.2.1) lib/rack/runtime.rb:24:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (8.0.3) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.2.1) lib/rack/sendfile.rb:114:in `call'
railties (8.0.3) lib/rails/engine.rb:535:in `call'
rack-test (2.2.0) lib/rack/test.rb:360:in `process_request'
rack-test (2.2.0) lib/rack/test.rb:153:in `request'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:297:in `process'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:43:in `delete'
actionpack (8.0.3) lib/action_dispatch/testing/integration.rb:388:in `delete'
/home/micah/work/adva_comments/spec/requests/admin/comments_spec.rb:45:in `block (3 levels) in <top (required)>'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:263:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `block in run'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-rails (7.1.1) lib/rspec/rails/adapters.rb:75:in `block (2 levels) in <module:MinitestLifecycleAdapter>'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/example.rb:457:in `instance_exec'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:390:in `execute_with'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/example.rb:352:in `call'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
rspec-core (3.13.5) lib/rspec/core/hooks.rb:486:in `run'
rspec-core (3.13.5) lib/rspec/core/example.rb:468:in `with_around_example_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
rspec-core (3.13.5) lib/rspec/core/example.rb:259:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:653:in `block in run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:649:in `run_examples'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:614:in `run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `block in run'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `map'
rspec-core (3.13.5) lib/rspec/core/example_group.rb:615:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `map'
rspec-core (3.13.5) lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
rspec-core (3.13.5) lib/rspec/core/configuration.rb:2097:in `with_suite_hooks'
rspec-core (3.13.5) lib/rspec/core/runner.rb:116:in `block in run_specs'
rspec-core (3.13.5) lib/rspec/core/reporter.rb:74:in `report'
rspec-core (3.13.5) lib/rspec/core/runner.rb:115:in `run_specs'
rspec-core (3.13.5) lib/rspec/core/runner.rb:89:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:71:in `run'
rspec-core (3.13.5) lib/rspec/core/runner.rb:45:in `invoke'
rspec-core (3.13.5) exe/rspec:4:in `<top (required)>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `load'
/home/micah/.rvm/gems/ruby-3.3.4/bin/rspec:25:in `<main>'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `eval'
/home/micah/.rvm/gems/ruby-3.3.4/bin/ruby_executable_hooks:22:in `<main>'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments/preview" for 127.0.0.1 at 2025-09-28 19:57:08 -0400
Processing by CommentsController#preview as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"Previewer", "author_email"=>"preview@example.com", "body"=>"Hello preview"}}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
  Rendering /home/micah/work/adva_comments/app/views/comments/preview.html.erb
  Rendered /home/micah/work/adva_comments/app/views/comments/preview.html.erb (Duration: 0.2ms | GC: 0.0ms)
Completed 200 OK in 5ms (Views: 1.0ms | ActiveRecord: 0.4ms (6 queries, 0 cached) | GC: 0.1ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments" for 127.0.0.1 at 2025-09-28 19:57:08 -0400
Processing by CommentsController#create as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"New Author", "author_email"=>"new@example.com", "body"=>"New comment body"}}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
[Invisible Captcha] Potential spam detected for IP 127.0.0.1. Timestamp not found in session.
Redirected to http://test-site.com/ref
Filter chain halted as #<Proc:0x00007ba4e3470b18 /home/micah/.rvm/gems/ruby-3.3.4/gems/invisible_captcha-2.3.0/lib/invisible_captcha/controller_ext.rb:12> rendered or redirected
Completed 302 Found in 3ms (ActiveRecord: 0.3ms (6 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (7.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "type" varchar, "object_attributes" text, "actions" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_author" ON "activities" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "counters"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "counters" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "owner_type" varchar, "owner_id" integer, "name" varchar(25), "count" integer DEFAULT 0)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_counters_on_owner" ON "counters" ("owner_type", "owner_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.1ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:58:05.215954"], ["updated_at", "2025-09-28 23:58:05.215954"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:58:05.225819"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:58:05.226558"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:58:05.228835"], ["created_at", "2025-09-28 23:58:05.232666"], ["updated_at", "2025-09-28 23:58:05.232666"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:58:05.255447"], ["updated_at", "2025-09-28 23:58:05.255447"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:58:05.257078"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:58:05.285171"], ["updated_at", "2025-09-28 23:58:05.285171"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:58:05.293435"], ["id", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:58:05.293941"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Processing by Admin::CommentsController#update as HTML
  Parameters: {"comment"=>{"body"=>"updated comment body"}, "id"=>"1"}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mContent Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mComment Update (0.0ms)[0m  [1m[33mUPDATE "comments" SET "body" = ?, "updated_at" = ? WHERE "comments"."id" = ?[0m  [["body", "updated comment body"], ["updated_at", "2025-09-28 23:58:05.368092"], ["id", 1]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:58:05.368703"], ["id", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:58:05.369771"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/admin/comments
Completed 302 Found in 8ms (ActiveRecord: 0.7ms (10 queries, 0 cached) | GC: 0.5ms)
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Processing by Admin::CommentsController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 3]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 2]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.0ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 4]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/admin/comments
Completed 302 Found in 8ms (ActiveRecord: 0.8ms (18 queries, 0 cached) | GC: 0.2ms)
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSite Load (0.5ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mComment Create (0.1ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Observer Test"], ["author_email", "observer@example.com"], ["author_homepage", nil], ["body", "hello"], ["body_html", nil], ["approved", 0], ["created_at", "2025-09-28 23:58:05.445238"], ["updated_at", "2025-09-28 23:58:05.445238"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 2], ["id", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 2], ["id", 2]]
  [1m[36mArticle Update (0.1ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:58:05.447751"], ["id", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:58:05.448558"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started PUT "/admin/comments/1" for 127.0.0.1 at 2025-09-28 19:58:05 -0400
Processing by Admin::CommentsController#update as HTML
  Parameters: {"comment"=>{"body"=>"updated comment body"}, "id"=>"1"}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mComment Update (0.0ms)[0m  [1m[33mUPDATE "comments" SET "body" = ?, "updated_at" = ? WHERE "comments"."id" = ?[0m  [["body", "updated comment body"], ["updated_at", "2025-09-28 23:58:05.463972"], ["id", 1]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:58:05.464482"], ["id", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mActivity Create (0.1ms)[0m  [1m[32mINSERT INTO "activities" ("site_id", "section_id", "object_type", "object_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "type", "object_attributes", "actions", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["object_type", "Comment"], ["object_id", 1], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["type", nil], ["object_attributes", "---\ncommentable_id: 1\nbody: updated comment body\nauthor_name: Test Commenter\nauthor_email: commenter@example.com\ncommentable_type: Article\ncommentable_title: Test Article\n"], ["actions", "---\n- edited\n"], ["created_at", "2025-09-28 23:58:05.467000"], ["updated_at", "2025-09-28 23:58:05.467000"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:58:05.465246"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/admin/comments
Completed 302 Found in 10ms (ActiveRecord: 0.7ms (13 queries, 0 cached) | GC: 0.1ms)
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started DELETE "/admin/comments/1" for 127.0.0.1 at 2025-09-28 19:58:05 -0400
Processing by Admin::CommentsController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[36mContent Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 3]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 2]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 4]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/admin/comments
Completed 302 Found in 7ms (ActiveRecord: 0.8ms (18 queries, 0 cached) | GC: 0.0ms)
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments/preview" for 127.0.0.1 at 2025-09-28 19:58:05 -0400
Processing by CommentsController#preview as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"Previewer", "author_email"=>"preview@example.com", "body"=>"Hello preview"}}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
  Rendering /home/micah/work/adva_comments/app/views/comments/preview.html.erb
  Rendered /home/micah/work/adva_comments/app/views/comments/preview.html.erb (Duration: 0.2ms | GC: 0.0ms)
Completed 200 OK in 10ms (Views: 3.9ms | ActiveRecord: 0.5ms (6 queries, 0 cached) | GC: 0.5ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments" for 127.0.0.1 at 2025-09-28 19:58:05 -0400
Processing by CommentsController#create as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"New Author", "author_email"=>"new@example.com", "body"=>"New comment body"}}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.3ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
[Invisible Captcha] Potential spam detected for IP 127.0.0.1. Timestamp not found in session.
Redirected to http://test-site.com/ref
Filter chain halted as #<Proc:0x000076637aecbce8 /home/micah/.rvm/gems/ruby-3.3.4/gems/invisible_captcha-2.3.0/lib/invisible_captcha/controller_ext.rb:12> rendered or redirected
Completed 302 Found in 3ms (ActiveRecord: 0.5ms (6 queries, 0 cached) | GC: 0.2ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (6.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "sites"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "host" varchar, "title" varchar, "timezone" varchar, "comment_age" integer, "comment_filter" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sites_on_host" ON "sites" ("host")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "sections"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "sections" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "type" varchar, "site_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "path" varchar, "permalink" varchar, "title" varchar, "comment_age" integer DEFAULT 0, "content_filter" varchar, "permissions" text, "published_at" datetime(6))[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id" ON "sections" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_sections_on_site_id_and_permalink" ON "sections" ("site_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "first_name" varchar(40), "last_name" varchar(40), "email" varchar(100), "password_hash" varchar(40), "password_salt" varchar(40), "anonymous" boolean DEFAULT 0, "verified_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "contents"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "contents" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "type" varchar(20), "title" varchar, "permalink" varchar, "body" text, "excerpt" text, "excerpt_html" text, "body_html" text, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "version" integer, "filter" varchar, "comment_age" integer DEFAULT 0, "cached_tag_list" varchar, "assets_count" integer DEFAULT 0, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "published_at" datetime(6), "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_site_id" ON "contents" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id" ON "contents" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_author" ON "contents" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_contents_on_section_id_and_permalink" ON "contents" ("section_id", "permalink")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categories"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categories" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "section_id" integer, "parent_id" integer, "lft" integer DEFAULT 0 NOT NULL, "rgt" integer DEFAULT 0 NOT NULL, "title" varchar, "path" varchar, "permalink" varchar)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_categories_on_section_id" ON "categories" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "categorizations"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "categorizations" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "categorizable_type" varchar, "categorizable_id" integer, "category_id" integer)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_categorizations_on_category_id" ON "categorizations" ("category_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer NOT NULL, "section_id" integer NOT NULL, "commentable_type" varchar NOT NULL, "commentable_id" integer NOT NULL, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "body" text, "body_html" text, "approved" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id" ON "comments" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_section_id" ON "comments" ("section_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_author" ON "comments" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable_type_and_commentable_id" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_comments_on_site_id_and_approved" ON "comments" ("site_id", "approved")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "activities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "activities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "site_id" integer, "section_id" integer, "object_type" varchar, "object_id" integer, "author_type" varchar, "author_id" integer, "author_name" varchar(40), "author_email" varchar(40), "author_homepage" varchar, "type" varchar, "object_attributes" text, "actions" text, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_site_id" ON "activities" ("site_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_activities_on_section_id" ON "activities" ("section_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_object" ON "activities" ("object_type", "object_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_activities_on_author" ON "activities" ("author_type", "author_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "counters"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "counters" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "owner_type" varchar, "owner_id" integer, "name" varchar(25), "count" integer DEFAULT 0)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_counters_on_owner" ON "counters" ("owner_type", "owner_id")[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSite Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "sites" WHERE "sites"."host" = ? LIMIT ?[0m  [["host", "test-site.com"], ["LIMIT", 1]]
  [1m[36mSite Create (0.1ms)[0m  [1m[32mINSERT INTO "sites" ("name", "host", "title", "timezone", "comment_age", "comment_filter", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "Test Site"], ["host", "test-site.com"], ["title", "Test Site Title"], ["timezone", nil], ["comment_age", nil], ["comment_filter", "textile_filter"], ["created_at", "2025-09-28 23:59:38.699971"], ["updated_at", "2025-09-28 23:59:38.699971"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mSection Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "sections" WHERE "sections"."permalink" = ? AND "sections"."site_id" = ? LIMIT ?[0m  [["permalink", "test-section"], ["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."lft" <= 0 AND "sections"."rgt" >= 0 ORDER BY "sections"."lft" ASC, lft[0m  [["site_id", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."rgt" DESC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Create (0.1ms)[0m  [1m[32mINSERT INTO "sections" ("type", "site_id", "parent_id", "lft", "rgt", "path", "permalink", "title", "comment_age", "content_filter", "permissions", "published_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["type", nil], ["site_id", 1], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["path", ""], ["permalink", "test-section"], ["title", "Test Section"], ["comment_age", 0], ["content_filter", nil], ["permissions", nil], ["published_at", "2025-09-28 23:59:38.728682"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:59:38.730026"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "email", "password_hash", "password_salt", "anonymous", "verified_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["first_name", "Test"], ["last_name", "User"], ["email", "test@example.com"], ["password_hash", "hash"], ["password_salt", "salt"], ["anonymous", 0], ["verified_at", "2025-09-28 23:59:38.732713"], ["created_at", "2025-09-28 23:59:38.737395"], ["updated_at", "2025-09-28 23:59:38.737395"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mContent Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."section_id" = ? AND "contents"."id" IS NOT NULL AND "contents"."permalink" = ? LIMIT ?[0m  [["section_id", 1], ["permalink", "test-article"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mArticle Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? AND "contents"."section_id" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "test-article"], ["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mContent Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."section_id" = ? ORDER BY "contents"."rgt" DESC LIMIT ?[0m  [["section_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Create (0.1ms)[0m  [1m[32mINSERT INTO "contents" ("site_id", "section_id", "type", "title", "permalink", "body", "excerpt", "excerpt_html", "body_html", "author_type", "author_id", "author_name", "author_email", "author_homepage", "version", "filter", "comment_age", "cached_tag_list", "assets_count", "parent_id", "lft", "rgt", "published_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["type", "Article"], ["title", "Test Article"], ["permalink", "test-article"], ["body", "Test article body"], ["excerpt", nil], ["excerpt_html", nil], ["body_html", nil], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["version", nil], ["filter", nil], ["comment_age", 0], ["cached_tag_list", nil], ["assets_count", 0], ["parent_id", nil], ["lft", 1], ["rgt", 2], ["published_at", "2008-01-01 17:00:00"], ["created_at", "2025-09-28 23:59:38.752542"], ["updated_at", "2025-09-28 23:59:38.752542"]]
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."categorizable_id" = ? AND "categorizations"."categorizable_type" = ?[0m  [["categorizable_id", 1], ["categorizable_type", "Content"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:59:38.754366"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Test Commenter"], ["author_email", "commenter@example.com"], ["author_homepage", nil], ["body", "Test comment body"], ["body_html", nil], ["approved", 1], ["created_at", "2025-09-28 23:59:38.788851"], ["updated_at", "2025-09-28 23:59:38.788851"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.0ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.0ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 1], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:59:38.797231"], ["id", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:59:38.797747"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Processing by Admin::CommentsController#update as HTML
  Parameters: {"comment"=>{"body"=>"updated comment body"}, "id"=>"1"}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mContent Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mComment Update (0.1ms)[0m  [1m[33mUPDATE "comments" SET "body" = ?, "updated_at" = ? WHERE "comments"."id" = ?[0m  [["body", "updated comment body"], ["updated_at", "2025-09-28 23:59:38.864581"], ["id", 1]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:59:38.865417"], ["id", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:59:38.866382"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/admin/comments
Completed 302 Found in 9ms (ActiveRecord: 1.0ms (10 queries, 0 cached) | GC: 0.0ms)
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Processing by Admin::CommentsController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.2ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 3]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 2]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.0ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 4]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/admin/comments
Completed 302 Found in 10ms (ActiveRecord: 1.0ms (18 queries, 0 cached) | GC: 0.0ms)
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ? ORDER BY "comments"."created_at" ASC, "comments"."id" ASC LIMIT ?[0m  [["commentable_id", 1], ["commentable_type", "Content"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mSite Load (0.8ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSite Load (0.8ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("site_id", "section_id", "commentable_type", "commentable_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "body", "body_html", "approved", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["commentable_type", "Content"], ["commentable_id", 1], ["author_type", nil], ["author_id", nil], ["author_name", "Observer Test"], ["author_email", "observer@example.com"], ["author_homepage", nil], ["body", "hello"], ["body_html", nil], ["approved", 0], ["created_at", "2025-09-28 23:59:38.995863"], ["updated_at", "2025-09-28 23:59:38.995863"]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.1ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 2], ["id", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 2], ["id", 2]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:59:38.999663"], ["id", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:59:39.001141"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started PUT "/admin/comments/1" for 127.0.0.1 at 2025-09-28 19:59:39 -0400
Processing by Admin::CommentsController#update as HTML
  Parameters: {"comment"=>{"body"=>"updated comment body"}, "id"=>"1"}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mContent Load (0.2ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.0ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mComment Update (0.1ms)[0m  [1m[33mUPDATE "comments" SET "body" = ?, "updated_at" = ? WHERE "comments"."id" = ?[0m  [["body", "updated comment body"], ["updated_at", "2025-09-28 23:59:39.019695"], ["id", 1]]
  [1m[36mArticle Update (0.0ms)[0m  [1m[33mUPDATE "contents" SET "updated_at" = ? WHERE "contents"."id" = ?[0m  [["updated_at", "2025-09-28 23:59:39.020374"], ["id", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) AND "users"."id" != ? LIMIT ?[0m  [["email", "test@example.com"], ["id", 1], ["LIMIT", 1]]
  [1m[36mActivity Create (0.1ms)[0m  [1m[32mINSERT INTO "activities" ("site_id", "section_id", "object_type", "object_id", "author_type", "author_id", "author_name", "author_email", "author_homepage", "type", "object_attributes", "actions", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["site_id", 1], ["section_id", 1], ["object_type", "Comment"], ["object_id", 1], ["author_type", "User"], ["author_id", 1], ["author_name", "Test User"], ["author_email", "test@example.com"], ["author_homepage", nil], ["type", nil], ["object_attributes", "---\ncommentable_id: 1\nbody: updated comment body\nauthor_name: Test Commenter\nauthor_email: commenter@example.com\ncommentable_type: Article\ncommentable_title: Test Article\n"], ["actions", "---\n- edited\n"], ["created_at", "2025-09-28 23:59:39.023554"], ["updated_at", "2025-09-28 23:59:39.023554"]]
  [1m[36mSite Update (0.0ms)[0m  [1m[33mUPDATE "sites" SET "updated_at" = ? WHERE "sites"."id" = ?[0m  [["updated_at", "2025-09-28 23:59:39.021286"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/admin/comments
Completed 302 Found in 13ms (ActiveRecord: 0.9ms (13 queries, 0 cached) | GC: 0.1ms)
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" ORDER BY "comments"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started DELETE "/admin/comments/1" for 127.0.0.1 at 2025-09-28 19:59:39 -0400
Processing by Admin::CommentsController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[36mContent Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.2ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Content"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Content"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 3]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" WHERE "sites"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.0ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", 0], ["id", 2]]
  [1m[36mCounter Load (0.0ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Create (0.1ms)[0m  [1m[32mINSERT INTO "counters" ("owner_type", "owner_id", "name", "count") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["owner_type", "Site"], ["owner_id", 1], ["name", "approved_comments"], ["count", 0]]
  [1m[36mCounter Load (0.1ms)[0m  [1m[34mSELECT "counters".* FROM "counters" WHERE "counters"."owner_id" = ? AND "counters"."owner_type" = ? AND "counters"."name" = ? LIMIT ?[0m  [["owner_id", 1], ["owner_type", "Site"], ["name", "approved_comments"], ["LIMIT", 1]]
  [1m[36mCounter Update (0.1ms)[0m  [1m[33mUPDATE "counters" SET "count" = ? WHERE "counters"."id" = ?[0m  [["count", -1], ["id", 4]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test-site.com/admin/comments
Completed 302 Found in 9ms (ActiveRecord: 1.1ms (18 queries, 0 cached) | GC: 0.0ms)
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments/preview" for 127.0.0.1 at 2025-09-28 19:59:39 -0400
Processing by CommentsController#preview as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"Previewer", "author_email"=>"preview@example.com", "body"=>"Hello preview"}}
  [1m[36mSite Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.1ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
  Rendering /home/micah/work/adva_comments/app/views/comments/preview.html.erb
  Rendered /home/micah/work/adva_comments/app/views/comments/preview.html.erb (Duration: 0.2ms | GC: 0.0ms)
Completed 200 OK in 8ms (Views: 3.0ms | ActiveRecord: 0.5ms (6 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? ORDER BY "contents"."id" ASC LIMIT ?[0m  [["type", "Article"], ["LIMIT", 1]]
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/comments" for 127.0.0.1 at 2025-09-28 19:59:39 -0400
Processing by CommentsController#create as HTML
  Parameters: {"comment"=>{"commentable_type"=>"Article", "commentable_id"=>"1", "author_name"=>"New Author", "author_email"=>"new@example.com", "body"=>"New comment body"}}
  [1m[36mSite Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sites"[0m
  [1m[36mSite Load (0.0ms)[0m  [1m[34mSELECT "sites".* FROM "sites" ORDER BY "sites"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? ORDER BY "sections"."lft" ASC LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mSection Load (0.1ms)[0m  [1m[34mSELECT "sections".* FROM "sections" WHERE "sections"."site_id" = ? AND "sections"."parent_id" IS NULL ORDER BY "sections"."lft" ASC, lft LIMIT ?[0m  [["site_id", 1], ["LIMIT", 1]]
  [1m[36mArticle Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."permalink" = ? LIMIT ?[0m  [["type", "Article"], ["permalink", "1"], ["LIMIT", 1]]
  [1m[36mArticle Load (0.0ms)[0m  [1m[34mSELECT "contents".* FROM "contents" WHERE "contents"."type" = ? AND "contents"."id" = ? LIMIT ?[0m  [["type", "Article"], ["id", 1], ["LIMIT", 1]]
[Invisible Captcha] Potential spam detected for IP 127.0.0.1. Timestamp not found in session.
Redirected to http://test-site.com/ref
Filter chain halted as #<Proc:0x00007c7d7e824d08 /home/micah/.rvm/gems/ruby-3.3.4/gems/invisible_captcha-2.3.0/lib/invisible_captcha/controller_ext.rb:12> rendered or redirected
Completed 302 Found in 3ms (ActiveRecord: 0.3ms (6 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
